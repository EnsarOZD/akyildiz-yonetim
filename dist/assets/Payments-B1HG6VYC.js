import{c as e,b as a,j as t,m as l,e as s,p as n,t as r,K as o,q as d,L as i,r as u,M as c,w as m,o as b,a as v,n as p,g,F as y,i as x,G as k,I as f,H as h,s as w,u as A,E as D,d as M,f as C,z as j}from"./vue-vendor-CVTqRqMI.js";import{t as I,b as N,c as B,e as T,u as S,R as V}from"./index-ChpY04z8.js";import{p as z}from"./paymentsService-CP8J_m2z.js";import{o as P}from"./ownersService-C04ToyJa.js";import{u as E}from"./utilityDebtsService-Cmr5Tqws.js";import{u as F}from"./useErrorHandler-Cmflx4-E.js";import{u as L}from"./useDirtyGuard-D7sCbjD1.js";import{_ as U}from"./CustomFilterBar-CK_Xywuc.js";import{_ as H,L as R}from"./AdvanceAccountManager-CmCLB87k.js";import{t as K}from"./tenantsService-C1bOp5xB.js";import{p as Y,i as O,e as _}from"./utils-vendor-Cy2sLATb.js";import{a as G,e as $,g as W,b as J,p as q,c as Z}from"./enums-CeMB0k1K.js";import{u as Q,f as X,g as ee,a as ae}from"./uiHelpers-C1OB11b5.js";import"./tenantsService-D36krPUn.js";const te={class:"flex-shrink-0 flex items-center justify-between px-5 py-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 rounded-t-2xl"},le={class:"text-lg font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2"},se={key:0,class:"text-xl"},ne={class:"flex-grow overflow-y-auto overscroll-contain px-5 py-5 bg-gray-50 dark:bg-gray-900/30"},re={key:0,class:"flex-shrink-0 flex items-center justify-end gap-3 px-5 py-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 rounded-b-2xl"},oe={__name:"BaseModal",props:{modelValue:{type:Boolean,default:!1},title:{type:String,required:!0},icon:{type:String,default:""},size:{type:String,default:"md"},isDirty:{type:Boolean,default:!1}},emits:["update:modelValue","close"],setup(u,{emit:c}){const m=u,b=c,v=e(()=>({"sm:max-w-sm":"sm"===m.size,"sm:max-w-lg":"md"===m.size,"sm:max-w-2xl":"lg"===m.size,"sm:max-w-4xl":"xl"===m.size}));function p(){if(m.isDirty){if(!window.confirm("Kaydedilmemi≈ü deƒüi≈üiklikler var. √áƒ±kmak istediƒüinizden emin misiniz?"))return}b("update:modelValue",!1),b("close")}return(e,c)=>u.modelValue?(l(),a("dialog",{key:0,class:"modal",open:"",onKeydown:i(p,["esc"])},[s("div",{class:d(["modal-box flex flex-col p-0 w-full max-w-[95vw] sm:max-w-lg md:max-w-2xl lg:max-w-4xl",v.value]),style:{maxHeight:"min(90dvh, 800px)"}},[s("div",te,[s("h3",le,[u.icon?(l(),a("span",se,r(u.icon),1)):t("",!0),n(" "+r(u.title),1)]),s("button",{onClick:p,type:"button",class:"btn btn-sm btn-ghost btn-circle text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 active:scale-95","aria-label":"Kapat"},c[0]||(c[0]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),s("div",ne,[o(e.$slots,"default")]),e.$slots.footer?(l(),a("div",re,[o(e.$slots,"footer")])):t("",!0)],2),s("div",{class:"modal-backdrop bg-black/50",onClick:p})],32)):t("",!0)}},de={class:"flex items-center justify-between mb-6 select-none"},ie={class:"flex flex-col items-center gap-1"},ue={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ce={key:1},me={key:0,class:"space-y-5"},be={class:"form-control"},ve={class:"flex gap-3"},pe={class:"form-control"},ge={class:"label"},ye={class:"label-text font-semibold text-gray-700 dark:text-gray-300"},xe=["value"],ke=["value"],fe={key:2,class:"text-red-500 text-xs mt-1"},he={key:3,class:"text-red-500 text-xs mt-1"},we={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ae={class:"form-control"},De={key:0,class:"text-red-500 text-xs mt-1"},Me={class:"form-control"},Ce={key:0,class:"text-red-500 text-xs mt-1"},je={class:"form-control"},Ie={key:0,class:"text-red-500 text-xs mt-1"},Ne={class:"form-control"},Be=["value"],Te={key:0,class:"text-red-500 text-xs mt-1"},Se={key:1,class:"space-y-4"},Ve={key:0,class:"flex items-center justify-center py-10 gap-3 text-gray-500"},ze={key:1,class:"bg-green-50 dark:bg-green-900/20 rounded-xl p-5 border border-green-200 dark:border-green-800 flex items-start gap-3"},Pe={class:"text-sm text-green-600 dark:text-green-400 mt-1"},Ee={class:"flex gap-2"},Fe={key:0,class:"text-sm text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 border border-blue-200 dark:border-blue-800"},Le={key:1,class:"space-y-2 max-h-64 overflow-y-auto overscroll-contain"},Ue=["onClick"],He=["checked","onChange"],Re={class:"flex-1 min-w-0"},Ke={class:"flex items-start justify-between gap-2"},Ye={class:"font-semibold text-gray-800 dark:text-gray-100 text-sm"},Oe={class:"text-xs text-gray-500 dark:text-gray-400"},_e={key:0,class:"text-blue-500 ml-1"},Ge={class:"text-right flex-shrink-0"},$e={class:"font-bold text-red-600 dark:text-red-400 text-sm"},We={class:"text-xs text-gray-400"},Je=["onUpdate:modelValue","max"],qe={class:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 space-y-2"},Ze={class:"flex justify-between text-sm"},Qe={class:"font-semibold"},Xe={class:"flex justify-between text-sm"},ea={class:"font-semibold"},aa={class:"flex justify-between text-sm border-t dark:border-gray-700 pt-2"},ta={class:"font-semibold text-blue-600"},la={key:2,class:"space-y-4"},sa={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 divide-y dark:divide-gray-700"},na={class:"px-4 py-3 flex justify-between items-center"},ra={class:"font-semibold text-gray-800 dark:text-gray-100"},oa={class:"px-4 py-3 flex justify-between items-center"},da={class:"text-sm text-gray-500"},ia={class:"font-semibold text-gray-800 dark:text-gray-100"},ua={class:"px-4 py-3 flex justify-between items-center"},ca={class:"font-semibold text-gray-800 dark:text-gray-100"},ma={class:"px-4 py-3 flex justify-between items-center"},ba={class:"text-xl font-bold text-green-600 dark:text-green-400"},va={class:"px-4 py-3 flex justify-between items-center"},pa={class:"font-semibold text-gray-800 dark:text-gray-100"},ga={class:"px-4 py-3 flex justify-between items-center"},ya={class:"font-semibold text-gray-800 dark:text-gray-100"},xa={key:0,class:"bg-red-50 dark:bg-red-900/20 rounded-xl p-4 border border-red-200 dark:border-red-800 flex items-center gap-3"},ka={class:"text-red-700 dark:text-red-300 text-sm font-semibold"},fa=["disabled"],ha=["disabled"],wa={key:0,class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Aa={key:1,class:"w-4 h-4 mr-1 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Da={__name:"PaymentModal",props:{visible:{type:Boolean,default:!1},payment:{type:Object,default:()=>({tenantId:null,ownerId:null,amount:null,date:"",type:"",bank:"",description:""})},tenants:{type:Array,default:()=>[]},banks:{type:Array,default:()=>[]},editMode:{type:Boolean,default:!1}},emits:["save","cancel","close"],setup(o,{emit:i}){const D=o,M=i,{handleNetworkError:C}=F(),{notifyError:j}=N(),I=u(1),B=["Temel Bilgiler","Bor√ß E≈üle≈ütirme","√ñzet & Onay"],T=u(!1),S=c({tenantId:null,ownerId:null,amount:null,date:"",type:"",bank:"",description:""});m(()=>D.payment,e=>{Object.assign(S,e||{})},{immediate:!0,deep:!0});const{isDirty:V,resetDirty:U}=L(()=>({...S})),H=u([]),R=e(()=>D.tenants||[]),K=e(()=>D.banks||[]),Y=e=>(null==e?void 0:e.companyName)||(null==e?void 0:e.company)||(null==e?void 0:e.contactPersonName)||(null==e?void 0:e.fullName)||[null==e?void 0:e.firstName,null==e?void 0:e.lastName].filter(Boolean).join(" ")||(null==e?void 0:e.email)||`#${null==e?void 0:e.id}`,O=u("tenant");m(()=>D.payment,e=>{(null==e?void 0:e.ownerId)?O.value="owner":O.value="tenant"},{immediate:!0});const _=u([]),G=u(!1),$=u([]),W=u(!0),J=u({}),q=e=>{W.value=e,e&&($.value=[],J.value={})},Z=e=>{const a=$.value.indexOf(e);-1===a?$.value.push(e):$.value.splice(a,1)},Q=e(()=>$.value.reduce((e,a)=>e+(Number(J.value[a])||0),0)),X=e(()=>{if("tenant"===O.value){const e=R.value.find(e=>e.id===S.tenantId);return e?Y(e):"‚Äî"}const e=H.value.find(e=>e.id===S.ownerId);return e&&(e.company||e.fullName||e.name)||"‚Äî"}),ee=e(()=>!!S.date&&Number(S.amount)>0&&""!==S.type&&!!S.bank&&("tenant"===O.value&&!!S.tenantId||"owner"===O.value&&!!S.ownerId)),ae=async()=>{if(1===I.value){if(T.value=!0,!ee.value)return;await(async()=>{G.value=!0,_.value=[];try{"tenant"===O.value&&S.tenantId?_.value=await E.getUtilityDebts({tenantId:S.tenantId,status:"Unpaid"})||[]:"owner"===O.value&&S.ownerId&&(_.value=await E.getUtilityDebts({ownerId:S.ownerId,status:"Unpaid"})||[])}catch(e){C(e,{component:"PaymentModal",action:"fetchDebts"})}finally{G.value=!1}})()}I.value++},te=()=>{I.value>1&&I.value--},le=u(!1),se=u(""),ne=e=>Number(e||0).toLocaleString("tr-TR",{style:"currency",currency:"TRY"}),re=e=>{if(!e)return 0;const a=Math.ceil((Date.now()-new Date(e))/864e5);return a>0?a:0},Da=async()=>{le.value=!0,se.value="";try{const e={tenantId:"tenant"===O.value?S.tenantId:null,ownerId:"owner"===O.value?S.ownerId:null,amount:Number(S.amount),paymentDate:S.date,type:parseInt(S.type)||0,bank:S.bank,description:S.description||"",autoAllocate:W.value,debtAllocations:W.value?[]:$.value.map(e=>({debtId:e,amount:Number(J.value[e]||0)}))},a=await z.createPaymentWithAllocation(e);U(),M("save",a)}catch(e){try{C(e,{component:"PaymentModal",action:"savePayment"})}catch{se.value="√ñdeme kaydedilirken bir hata olu≈ütu.",j("√ñdeme kaydedilirken bir hata olu≈ütu.")}}finally{le.value=!1}},Ma=()=>{Ca(),M("cancel")},Ca=()=>{I.value=1,T.value=!1,_.value=[],$.value=[],J.value={},le.value=!1,se.value="",U()},ja=e=>{D.visible&&"Escape"===e.key&&Ma()};return b(async()=>{window.addEventListener("keydown",ja);try{H.value=await P.getOwners()||[]}catch{H.value=[]}}),v(()=>window.removeEventListener("keydown",ja)),m(()=>D.visible,e=>{e||Ca()}),(e,i)=>(l(),p(oe,{"model-value":o.visible,title:"Akƒ±llƒ± √ñdeme Sistemi",icon:"üí≥",size:"xl","is-dirty":A(V),onClose:Ma},{footer:g(()=>[I.value>1?(l(),a("button",{key:0,type:"button",onClick:te,disabled:le.value,class:"btn btn-outline border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 active:scale-95"}," ‚Üê Geri ",8,fa)):t("",!0),I.value<3?(l(),a("button",{key:1,type:"button",onClick:ae,class:"btn btn-primary active:scale-95"}," ƒ∞leri ‚Üí ")):t("",!0),3===I.value?(l(),a("button",{key:2,type:"button",onClick:Da,disabled:le.value,class:"btn btn-success bg-gradient-to-r from-green-600 to-green-700 border-0 text-white active:scale-95"},[le.value?(l(),a("svg",Aa,i[38]||(i[38]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))):(l(),a("svg",wa,i[37]||(i[37]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))),n(" "+r(le.value?"Kaydediliyor...":"√ñdemeyi Kaydet"),1)],8,ha)):t("",!0)]),default:g(()=>[s("div",de,[(l(),a(y,null,x(B,(e,n)=>s("div",{key:n,class:d(["flex items-center gap-2",n<B.length-1?"flex-1":""])},[s("div",ie,[s("div",{class:d(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-200",I.value>n+1?"bg-green-500 text-white":I.value===n+1?"bg-blue-600 text-white shadow-lg shadow-blue-200 dark:shadow-none":"bg-gray-200 dark:bg-gray-700 text-gray-400"])},[I.value>n+1?(l(),a("svg",ue,i[12]||(i[12]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)]))):(l(),a("span",ce,r(n+1),1))],2),s("span",{class:d(["text-[10px] sm:text-xs font-medium text-center leading-tight",I.value===n+1?"text-blue-600 dark:text-blue-400":"text-gray-400"])},r(e),3)]),n<B.length-1?(l(),a("div",{key:0,class:d(["flex-1 h-0.5 mx-2 mb-4 transition-all duration-300",I.value>n+1?"bg-green-400":"bg-gray-200 dark:bg-gray-700"])},null,2)):t("",!0)],2)),64))]),1===I.value?(l(),a("div",me,[s("div",be,[i[15]||(i[15]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"√ñdeme T√ºr√º")],-1)),s("div",ve,[s("button",{type:"button",onClick:i[0]||(i[0]=e=>O.value="tenant"),class:d(["flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl border-2 font-semibold transition-all active:scale-95","tenant"===O.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"border-gray-200 dark:border-gray-700 text-gray-500 hover:border-gray-300"])},i[13]||(i[13]=[s("span",null,"üë§",-1),n(" Kiracƒ± ")]),2),s("button",{type:"button",onClick:i[1]||(i[1]=e=>O.value="owner"),class:d(["flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl border-2 font-semibold transition-all active:scale-95","owner"===O.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"border-gray-200 dark:border-gray-700 text-gray-500 hover:border-gray-300"])},i[14]||(i[14]=[s("span",null,"üè†",-1),n(" Mal Sahibi ")]),2)])]),s("div",pe,[s("label",ge,[s("span",ye,r("tenant"===O.value?"Kiracƒ±":"Mal Sahibi"),1)]),"tenant"===O.value?k((l(),a("select",{key:0,"onUpdate:modelValue":i[2]||(i[2]=e=>S.tenantId=e),class:d(["select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600",{"border-red-400":T.value&&!S.tenantId}])},[i[16]||(i[16]=s("option",{disabled:"",value:""},"Kiracƒ± se√ßin",-1)),(l(!0),a(y,null,x(R.value,e=>(l(),a("option",{key:e.id,value:e.id},r(Y(e)),9,xe))),128))],2)),[[f,S.tenantId]]):k((l(),a("select",{key:1,"onUpdate:modelValue":i[3]||(i[3]=e=>S.ownerId=e),class:d(["select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600",{"border-red-400":T.value&&!S.ownerId}])},[i[17]||(i[17]=s("option",{disabled:"",value:""},"Mal sahibi se√ßin",-1)),(l(!0),a(y,null,x(H.value,e=>(l(),a("option",{key:e.id,value:e.id},r(e.company||e.fullName||e.name||e.email),9,ke))),128))],2)),[[f,S.ownerId]]),T.value&&"tenant"===O.value&&!S.tenantId?(l(),a("p",fe,"L√ºtfen kiracƒ± se√ßin.")):t("",!0),T.value&&"owner"===O.value&&!S.ownerId?(l(),a("p",he,"L√ºtfen mal sahibi se√ßin.")):t("",!0)]),s("div",we,[s("div",Ae,[i[18]||(i[18]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Hareket Tarihi *")],-1)),k(s("input",{"onUpdate:modelValue":i[4]||(i[4]=e=>S.date=e),type:"date",class:d(["input input-bordered w-full bg-white dark:bg-gray-700",{"border-red-400":T.value&&!S.date}])},null,2),[[h,S.date]]),T.value&&!S.date?(l(),a("p",De,"Tarih zorunludur.")):t("",!0)]),s("div",Me,[i[19]||(i[19]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Gelen Tutar (‚Ç∫) *")],-1)),k(s("input",{"onUpdate:modelValue":i[5]||(i[5]=e=>S.amount=e),type:"number",step:"0.01",placeholder:"0.00",class:d(["input input-bordered w-full bg-white dark:bg-gray-700",{"border-red-400":T.value&&!(Number(S.amount)>0)}])},null,2),[[h,S.amount,void 0,{number:!0}]]),!T.value||Number(S.amount)>0?t("",!0):(l(),a("p",Ce,"Ge√ßerli bir tutar girin."))]),s("div",je,[i[21]||(i[21]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"√ñdeme Tipi *")],-1)),k(s("select",{"onUpdate:modelValue":i[6]||(i[6]=e=>S.type=e),class:d(["select select-bordered w-full bg-white dark:bg-gray-700",{"border-red-400":T.value&&""===S.type}])},i[20]||(i[20]=[s("option",{disabled:"",value:""},"Se√ßin",-1),s("option",{value:"0"},"Aidat",-1),s("option",{value:"1"},"Elektrik",-1),s("option",{value:"2"},"Su",-1),s("option",{value:"3"},"Doƒüalgaz",-1),s("option",{value:"4"},"Diƒüer",-1)]),2),[[f,S.type]]),T.value&&""===S.type?(l(),a("p",Ie,"√ñdeme tipi se√ßin.")):t("",!0)]),s("div",Ne,[i[23]||(i[23]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Banka *")],-1)),k(s("select",{"onUpdate:modelValue":i[7]||(i[7]=e=>S.bank=e),class:d(["select select-bordered w-full bg-white dark:bg-gray-700",{"border-red-400":T.value&&!S.bank}])},[i[22]||(i[22]=s("option",{disabled:"",value:""},"Se√ßin",-1)),(l(!0),a(y,null,x(K.value,e=>(l(),a("option",{key:e,value:e},r(e),9,Be))),128))],2),[[f,S.bank]]),T.value&&!S.bank?(l(),a("p",Te,"Banka se√ßin.")):t("",!0)])])])):t("",!0),2===I.value?(l(),a("div",Se,[G.value?(l(),a("div",Ve,i[24]||(i[24]=[s("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"},null,-1),s("span",null,"Bor√ßlar y√ºkleniyor...",-1)]))):0===_.value.length?(l(),a("div",ze,[i[27]||(i[27]=s("svg",{class:"w-6 h-6 text-green-500 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s("div",null,[i[26]||(i[26]=s("p",{class:"font-semibold text-green-700 dark:text-green-300"},"√ñdenmemi≈ü bor√ß bulunamadƒ±",-1)),s("p",Pe,[s("strong",null,r(ne(S.amount)),1),i[25]||(i[25]=n(" tutarƒ±n tamamƒ± avans hesabƒ±na aktarƒ±lacak. "))])])])):(l(),a(y,{key:2},[s("div",Ee,[s("button",{type:"button",onClick:i[8]||(i[8]=e=>q(!0)),class:d(["flex-1 py-2 px-3 rounded-lg border-2 text-sm font-semibold transition-all active:scale-95",W.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"border-gray-200 dark:border-gray-700 text-gray-500"])}," ‚ö° Otomatik E≈üle≈ütir ",2),s("button",{type:"button",onClick:i[9]||(i[9]=e=>q(!1)),class:d(["flex-1 py-2 px-3 rounded-lg border-2 text-sm font-semibold transition-all active:scale-95",W.value?"border-gray-200 dark:border-gray-700 text-gray-500":"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300"])}," ‚úèÔ∏è Manuel Se√ß ",2)]),W.value?(l(),a("div",Fe," Backend bor√ßlarƒ± en eskiden ba≈ülayarak kapatacak, fazla tutar avans hesabƒ±na aktarƒ±lacak. ")):(l(),a("div",Le,[(l(!0),a(y,null,x(_.value,e=>(l(),a("div",{key:e.id,onClick:a=>Z(e.id),class:d(["flex items-start gap-3 p-3 bg-white dark:bg-gray-700 rounded-xl border-2 cursor-pointer transition-all active:scale-[0.99]",$.value.includes(e.id)?"border-blue-400 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300"])},[s("input",{type:"checkbox",checked:$.value.includes(e.id),onClick:i[10]||(i[10]=w(()=>{},["stop"])),onChange:a=>Z(e.id),class:"checkbox checkbox-primary mt-1 flex-shrink-0"},null,40,He),s("div",Re,[s("div",Ke,[s("div",null,[s("p",Ye,r(e.typeLabel||e.type),1),s("p",Oe,[n(r(e.period||e.dueDateFormatted)+" ",1),e.unit&&"-"!==e.unit?(l(),a("span",_e,"("+r(e.unit)+")",1)):t("",!0)])]),s("div",Ge,[s("p",$e,r(ne(e.remainingAmount||e.amount)),1),s("p",We,r(re(e.dueDate))+" g√ºn",1)])]),$.value.includes(e.id)?(l(),a("div",{key:0,class:"mt-2",onClick:i[11]||(i[11]=w(()=>{},["stop"]))},[k(s("input",{"onUpdate:modelValue":a=>J.value[e.id]=a,type:"number",step:"0.01",max:e.remainingAmount||e.amount,class:"input input-sm input-bordered w-32",placeholder:"Tutar"},null,8,Je),[[h,J.value[e.id]]])])):t("",!0)])],10,Ue))),128))])),s("div",qe,[s("div",Ze,[i[28]||(i[28]=s("span",{class:"text-gray-500"},"Toplam Tutar",-1)),s("span",Qe,r(ne(S.amount)),1)]),s("div",Xe,[i[29]||(i[29]=s("span",{class:"text-gray-500"},"E≈üle≈ütirilecek",-1)),s("span",ea,r(ne(W.value?S.amount:Q.value)),1)]),s("div",aa,[i[30]||(i[30]=s("span",{class:"text-gray-500"},"Avans Hesabƒ±na",-1)),s("span",ta,r(ne(W.value?0:S.amount-Q.value)),1)])])],64))])):t("",!0),3===I.value?(l(),a("div",la,[s("div",sa,[s("div",na,[i[31]||(i[31]=s("span",{class:"text-sm text-gray-500"},"√ñdeme T√ºr√º",-1)),s("span",ra,r("tenant"===O.value?"üë§ Kiracƒ±":"üè† Mal Sahibi"),1)]),s("div",oa,[s("span",da,r("tenant"===O.value?"Kiracƒ±":"Mal Sahibi"),1),s("span",ia,r(X.value),1)]),s("div",ua,[i[32]||(i[32]=s("span",{class:"text-sm text-gray-500"},"Tarih",-1)),s("span",ca,r(S.date),1)]),s("div",ma,[i[33]||(i[33]=s("span",{class:"text-sm text-gray-500"},"Tutar",-1)),s("span",ba,r(ne(S.amount)),1)]),s("div",va,[i[34]||(i[34]=s("span",{class:"text-sm text-gray-500"},"Banka",-1)),s("span",pa,r(S.bank),1)]),s("div",ga,[i[35]||(i[35]=s("span",{class:"text-sm text-gray-500"},"Bor√ß E≈üle≈ütirme",-1)),s("span",ya,r(W.value?"‚ö° Otomatik":`‚úèÔ∏è Manuel (${$.value.length} bor√ß)`),1)])]),se.value?(l(),a("div",xa,[i[36]||(i[36]=s("svg",{class:"w-5 h-5 text-red-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),s("span",ka,r(se.value),1)])):t("",!0)])):t("",!0)]),_:1},8,["model-value","is-dirty"]))}},Ma={class:"financial-reports bg-base-100 p-6 rounded-lg shadow-lg"},Ca={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},ja={class:"form-control"},Ia={class:"form-control"},Na={class:"form-control"},Ba=["value"],Ta={class:"form-control"},Sa=["disabled","title"],Va={key:0,class:"loading loading-spinner loading-sm"},za={key:0,class:"alert alert-warning mb-4"},Pa={key:1,class:"text-center py-8 text-gray-500"},Ea={key:2,class:"space-y-6"},Fa={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},La={class:"stat bg-base-200 rounded-lg"},Ua={class:"stat-value text-primary"},Ha={class:"stat-desc"},Ra={class:"stat bg-base-200 rounded-lg"},Ka={class:"stat-value text-error"},Ya={class:"stat-desc"},Oa={class:"stat bg-base-200 rounded-lg"},_a={class:"stat-value text-success"},Ga={class:"stat-desc"},$a={class:"stat bg-base-200 rounded-lg"},Wa={class:"overflow-x-auto"},Ja={class:"table table-zebra w-full"},qa={class:"text-success"},Za={class:"text-error"},Qa={key:3,class:"text-center py-8"},Xa={__name:"FinancialReports",setup(o){const{handleNetworkError:i,handleValidationError:c}=F(),{showError:m,showSuccess:v}=B(),p=u(!1),g=u([]),w=u(null),A=new Date,M=new Date(A.getFullYear(),A.getMonth(),1),C=u({startDate:_(M,"yyyy-MM-dd"),endDate:_(A,"yyyy-MM-dd"),tenantId:"",ownerId:""}),j=e=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(Number(e||0)),N=e=>{if(!e)return"-";const a="string"==typeof e||"number"==typeof e?new Date(e):e;return isNaN(a)?"-":_(a,"dd MMM yyyy",{locale:I})},T=e(()=>!C.value.startDate||!C.value.endDate||new Date(C.value.startDate)<=new Date(C.value.endDate)),S=Object.freeze({totalPayments:0,paymentCount:0,totalDebts:0,debtCount:0,advanceBalance:0,advanceAccountCount:0,netBalance:0,details:[]}),V=e(()=>{const e=w.value||{};return{totalPayments:Number(e.totalPayments||0),paymentCount:Number(e.paymentCount||0),totalDebts:Number(e.totalDebts||0),debtCount:Number(e.debtCount||0),advanceBalance:Number(e.advanceBalance||0),advanceAccountCount:Number(e.advanceAccountCount||0),netBalance:Number(e.netBalance||(e.totalPayments||0)-(e.totalDebts||0)),details:Array.isArray(e.details)?e.details.map((e,a)=>({_idx:a,...e})):[]}}),P=e(()=>{const e=V.value;return e.paymentCount>0||e.debtCount>0||e.advanceAccountCount>0||e.details&&e.details.length>0});function E(e){return e.companyName||e.company||e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.email||"Kiracƒ±"}function L(e){const a=g.value.find(a=>a.id===e);return a?E(a):"Bilinmiyor"}async function U(){if(T.value){p.value=!0;try{const e=await z.getFinancialReports({startDate:C.value.startDate,endDate:C.value.endDate,tenantId:C.value.tenantId||void 0,ownerId:C.value.ownerId||void 0});w.value=e&&"object"==typeof e?e:S,v("Rapor g√ºncellendi")}catch(e){w.value=S,i(e,{component:"FinancialReports",action:"loadReports"}),m("Rapor y√ºklenemedi")}finally{p.value=!1}}else c(new Error("Tarih aralƒ±ƒüƒ± ge√ßersiz"),{component:"FinancialReports",action:"loadReports"})}return b(()=>{!async function(){try{const e=await K.getTenants();g.value=Array.isArray(e)?e:[]}catch(e){i(e,{component:"FinancialReports",action:"loadTenants"}),g.value=[]}}(),U()}),(e,o)=>(l(),a("div",Ma,[o[16]||(o[16]=s("h2",{class:"text-2xl font-bold mb-6 text-primary"},"Finansal Raporlar",-1)),s("div",Ca,[s("div",ja,[o[3]||(o[3]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"Ba≈ülangƒ±√ß Tarihi")],-1)),k(s("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>C.value.startDate=e),type:"date",class:"input input-bordered"},null,512),[[h,C.value.startDate]])]),s("div",Ia,[o[4]||(o[4]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"Biti≈ü Tarihi")],-1)),k(s("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>C.value.endDate=e),type:"date",class:"input input-bordered"},null,512),[[h,C.value.endDate]])]),s("div",Na,[o[6]||(o[6]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"Kiracƒ±")],-1)),k(s("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>C.value.tenantId=e),class:"select select-bordered"},[o[5]||(o[5]=s("option",{value:""},"T√ºm Kiracƒ±lar",-1)),(l(!0),a(y,null,x(g.value,e=>(l(),a("option",{key:e.id,value:e.id},r(E(e)),9,Ba))),128))],512),[[f,C.value.tenantId]])]),s("div",Ta,[o[7]||(o[7]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"¬†")],-1)),s("button",{onClick:U,class:"btn btn-primary",disabled:p.value||!T.value,title:T.value?"":"Ba≈ülangƒ±√ß tarihi biti≈üten b√ºy√ºk olamaz"},[p.value?(l(),a("span",Va)):t("",!0),n(" "+r(p.value?"Y√ºkleniyor...":"Rapor Y√ºkle"),1)],8,Sa)])]),T.value?t("",!0):(l(),a("div",za," Ba≈ülangƒ±√ß tarihi, biti≈ü tarihinden b√ºy√ºk olamaz. ")),p.value?(l(),a("div",Pa,"Y√ºkleniyor‚Ä¶")):P.value?(l(),a("div",Ea,[s("div",Fa,[s("div",La,[o[8]||(o[8]=s("div",{class:"stat-title"},"Toplam √ñdeme",-1)),s("div",Ua,r(j(V.value.totalPayments)),1),s("div",Ha,r(V.value.paymentCount)+" √∂deme",1)]),s("div",Ra,[o[9]||(o[9]=s("div",{class:"stat-title"},"Toplam Bor√ß",-1)),s("div",Ka,r(j(V.value.totalDebts)),1),s("div",Ya,r(V.value.debtCount)+" bor√ß",1)]),s("div",Oa,[o[10]||(o[10]=s("div",{class:"stat-title"},"Avans Bakiyesi",-1)),s("div",_a,r(j(V.value.advanceBalance)),1),s("div",Ga,r(V.value.advanceAccountCount)+" hesap",1)]),s("div",$a,[o[11]||(o[11]=s("div",{class:"stat-title"},"Net Durum",-1)),s("div",{class:d(["stat-value",V.value.netBalance>=0?"text-success":"text-error"])},r(j(V.value.netBalance)),3),o[12]||(o[12]=s("div",{class:"stat-desc"},"√ñdeme - Bor√ß",-1))])]),s("div",Wa,[s("table",Ja,[o[13]||(o[13]=s("thead",null,[s("tr",null,[s("th",null,"Tarih"),s("th",null,"Kiracƒ±"),s("th",null,"√ñdeme"),s("th",null,"Bor√ß"),s("th",null,"Kalan"),s("th",null,"Durum")])],-1)),s("tbody",null,[(l(!0),a(y,null,x(V.value.details,e=>(l(),a("tr",{key:e.id||e._idx},[s("td",null,r(N(e.date)),1),s("td",null,r(e.tenantName||L(e.tenantId)),1),s("td",qa,r(j(e.paymentAmount||0)),1),s("td",Za,r(j(e.debtAmount||0)),1),s("td",{class:d((e.remainingAmount||0)>=0?"text-success":"text-error")},r(j(e.remainingAmount||0)),3),s("td",null,[s("span",{class:d(["badge",(e.remainingAmount||0)>=0?"badge-success":"badge-error"])},r((e.remainingAmount||0)>=0?"Pozitif":"Negatif"),3)])]))),128))])])]),o[14]||(o[14]=D('<div class="bg-base-200 p-4 rounded-lg"><h3 class="text-lg font-semibold mb-3">Grafik G√∂r√ºn√ºm√º</h3><div class="text-center py-8 text-gray-500"><svg class="w-16 h-16 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2z"></path></svg><p>Grafik g√∂r√ºn√ºm√º yakƒ±nda eklenecek</p></div></div>',1))])):p.value?t("",!0):(l(),a("div",Qa,o[15]||(o[15]=[D('<div class="text-gray-500"><svg class="w-16 h-16 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg><p class="text-lg font-medium">Rapor bulunamadƒ±</p><p class="text-sm">Filtreleri deƒüi≈ütirip tekrar deneyin.</p></div>',1)])))]))}},et={class:"audit-logs bg-base-100 p-6 rounded-lg shadow-lg"},at={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"},tt={class:"form-control"},lt={class:"form-control"},st={class:"form-control"},nt=["value"],rt={class:"form-control"},ot=["value"],dt={class:"form-control"},it=["disabled"],ut={key:0,class:"loading loading-spinner loading-sm"},ct={key:0,class:"overflow-x-auto"},mt={class:"table table-zebra w-full"},bt={class:"flex items-center space-x-2"},vt={class:"avatar placeholder"},pt={class:"bg-neutral text-neutral-content rounded-full w-8"},gt={class:"text-xs"},yt={class:"font-medium"},xt={class:"text-sm text-gray-500"},kt={class:"font-medium"},ft={class:"text-sm text-gray-500"},ht={class:"text-sm text-gray-500"},wt=["onClick"],At={key:1,class:"text-center py-8"},Dt={id:"log_details_modal",class:"modal"},Mt={class:"modal-box w-11/12 max-w-4xl"},Ct={key:0,class:"space-y-4"},jt={class:"grid grid-cols-2 gap-4"},It={class:"text-sm"},Nt={class:"text-sm"},Bt={class:"text-sm"},Tt={class:"text-sm"},St={class:"text-sm"},Vt={class:"text-sm text-xs"},zt={key:0},Pt={class:"bg-base-200 p-4 rounded-lg"},Et={key:0,class:"mb-3"},Ft={class:"text-xs bg-error text-error-content p-2 rounded"},Lt={key:1},Ut={class:"text-xs bg-success text-success-content p-2 rounded"},Ht={key:1},Rt={class:"bg-base-200 p-4 rounded-lg"},Kt={class:"text-xs"},Yt={__name:"AuditLogs",setup(e){const{notifyError:o}=N(),i=u(!1),c=u([]),m=u(null),v=u({startDate:_(new Date((new Date).getFullYear(),(new Date).getMonth(),1),"yyyy-MM-dd"),endDate:_(new Date,"yyyy-MM-dd"),action:"",entityType:"",userId:""}),p=e=>_(new Date(e),"dd MMM yyyy HH:mm",{locale:I}),g=async()=>{i.value=!0;try{const e=await z.getAuditLogs(v.value);c.value=e||[]}catch(e){o("Loglar y√ºklenemedi: "+e.message)}finally{i.value=!1}};return b(()=>{g()}),(e,o)=>(l(),a("div",et,[o[25]||(o[25]=s("h2",{class:"text-2xl font-bold mb-6 text-primary"},"Sistem Loglarƒ±",-1)),s("div",at,[s("div",tt,[o[4]||(o[4]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"Ba≈ülangƒ±√ß Tarihi")],-1)),k(s("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>v.value.startDate=e),type:"date",class:"input input-bordered"},null,512),[[h,v.value.startDate]])]),s("div",lt,[o[5]||(o[5]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"Biti≈ü Tarihi")],-1)),k(s("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>v.value.endDate=e),type:"date",class:"input input-bordered"},null,512),[[h,v.value.endDate]])]),s("div",st,[o[7]||(o[7]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"ƒ∞≈ülem T√ºr√º")],-1)),k(s("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>v.value.action=e),class:"select select-bordered"},[o[6]||(o[6]=s("option",{value:""},"T√ºm ƒ∞≈ülemler",-1)),(l(!0),a(y,null,x(A(G),(e,t)=>(l(),a("option",{key:t,value:t},r(e),9,nt))),128))],512),[[f,v.value.action]])]),s("div",rt,[o[9]||(o[9]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"Varlƒ±k T√ºr√º")],-1)),k(s("select",{"onUpdate:modelValue":o[3]||(o[3]=e=>v.value.entityType=e),class:"select select-bordered"},[o[8]||(o[8]=s("option",{value:""},"T√ºm Varlƒ±klar",-1)),(l(!0),a(y,null,x(A($),(e,t)=>(l(),a("option",{key:t,value:t},r(e),9,ot))),128))],512),[[f,v.value.entityType]])]),s("div",dt,[o[10]||(o[10]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"¬†")],-1)),s("button",{onClick:g,class:"btn btn-primary",disabled:i.value},[i.value?(l(),a("span",ut)):t("",!0),n(" "+r(i.value?"Y√ºkleniyor...":"Log Y√ºkle"),1)],8,it)])]),c.value.length>0?(l(),a("div",ct,[s("table",mt,[o[11]||(o[11]=s("thead",null,[s("tr",null,[s("th",null,"Tarih"),s("th",null,"Kullanƒ±cƒ±"),s("th",null,"ƒ∞≈ülem"),s("th",null,"Varlƒ±k"),s("th",null,"IP Adresi"),s("th",null,"Detaylar")])],-1)),s("tbody",null,[(l(!0),a(y,null,x(c.value,e=>{var t,n;return l(),a("tr",{key:e.id},[s("td",null,r(p(e.createdAt)),1),s("td",null,[s("div",bt,[s("div",vt,[s("div",pt,[s("span",gt,r((null==(t=e.userName)?void 0:t.charAt(0))||"U"),1)])]),s("div",null,[s("div",yt,r(e.userName||"Sistem"),1),s("div",xt,r(e.userEmail||"-"),1)])])]),s("td",null,[s("span",{class:d(["badge",(n=e.action,{Create:"badge-success",Update:"badge-warning",Delete:"badge-error",Payment:"badge-primary",DebtAllocation:"badge-info",AdvanceUsage:"badge-secondary"}[n]||"badge-neutral")])},r(A(W)(e.action)),3)]),s("td",null,[s("div",null,[s("div",kt,r(A(J)(e.entityType)),1),s("div",ft,"ID: "+r(e.entityId),1)])]),s("td",ht,r(e.ipAddress||"-"),1),s("td",null,[s("button",{onClick:a=>(e=>{m.value=e,document.getElementById("log_details_modal").showModal()})(e),class:"btn btn-sm btn-outline"}," Detaylar ",8,wt)])])}),128))])])])):i.value?t("",!0):(l(),a("div",At,o[12]||(o[12]=[D('<div class="text-gray-500"><svg class="w-16 h-16 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg><p class="text-lg font-medium">Log bulunamadƒ±</p><p class="text-sm">Filtreleri deƒüi≈ütirip tekrar deneyin.</p></div>',1)]))),s("dialog",Dt,[s("div",Mt,[o[23]||(o[23]=s("h3",{class:"font-bold text-lg mb-4"},"Log Detaylarƒ±",-1)),m.value?(l(),a("div",Ct,[s("div",jt,[s("div",null,[o[13]||(o[13]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"Tarih")],-1)),s("div",It,r(p(m.value.createdAt)),1)]),s("div",null,[o[14]||(o[14]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"Kullanƒ±cƒ±")],-1)),s("div",Nt,r(m.value.userName||"Sistem"),1)]),s("div",null,[o[15]||(o[15]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"ƒ∞≈ülem")],-1)),s("div",Bt,r(A(W)(m.value.action)),1)]),s("div",null,[o[16]||(o[16]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"Varlƒ±k")],-1)),s("div",Tt,r(A(J)(m.value.entityType))+" (ID: "+r(m.value.entityId)+")",1)]),s("div",null,[o[17]||(o[17]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"IP Adresi")],-1)),s("div",St,r(m.value.ipAddress||"-"),1)]),s("div",null,[o[18]||(o[18]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"User Agent")],-1)),s("div",Vt,r(m.value.userAgent||"-"),1)])]),m.value.oldValues||m.value.newValues?(l(),a("div",zt,[o[21]||(o[21]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"Deƒüi≈üiklikler")],-1)),s("div",Pt,[m.value.oldValues?(l(),a("div",Et,[o[19]||(o[19]=s("div",{class:"font-semibold text-error mb-2"},"Eski Deƒüerler:",-1)),s("pre",Ft,r(JSON.stringify(m.value.oldValues,null,2)),1)])):t("",!0),m.value.newValues?(l(),a("div",Lt,[o[20]||(o[20]=s("div",{class:"font-semibold text-success mb-2"},"Yeni Deƒüerler:",-1)),s("pre",Ut,r(JSON.stringify(m.value.newValues,null,2)),1)])):t("",!0)])])):t("",!0),m.value.additionalData?(l(),a("div",Ht,[o[22]||(o[22]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold"},"Ek Bilgiler")],-1)),s("div",Rt,[s("pre",Kt,r(JSON.stringify(m.value.additionalData,null,2)),1)])])):t("",!0)])):t("",!0),o[24]||(o[24]=s("div",{class:"modal-action"},[s("form",{method:"dialog"},[s("button",{class:"btn"},"Kapat")])],-1))])])]))}},Ot=M("payments",{state:()=>({payments:[],advanceAccounts:[],loading:!1,lastFetched:null}),actions:{async fetchPayments(e=!1){if(!e&&this.payments.length>0&&this.lastFetched&&Date.now()-this.lastFetched<3e5)return this.payments;this.loading=!0;try{const e=await z.getPayments();return this.payments=e||[],this.lastFetched=Date.now(),this.payments}catch(a){throw T.logError(a,{component:"PaymentsStore",action:"fetchPayments"}),a}finally{this.loading=!1}},async fetchAdvanceAccounts(){this.loading=!0;try{const e=await z.getAdvanceAccounts(),a=Array.isArray(e)?e:(null==e?void 0:e.items)||[];return this.advanceAccounts=a.map(e=>({...e,balance:Number(e.balance??0)})).filter(e=>e.balance>0),this.advanceAccounts}catch(e){throw T.logError(e,{component:"PaymentsStore",action:"fetchAdvanceAccounts"}),e}finally{this.loading=!1}},async deletePayment(e){try{await z.deletePayment(e),this.payments=this.payments.filter(a=>a.id!==e),await this.fetchAdvanceAccounts()}catch(a){throw a}}}}),_t={class:"p-4 sm:p-6 bg-gray-50 min-h-screen font-sans dark:bg-gray-900"},Gt={class:"max-w-7xl mx-auto"},$t={class:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6"},Wt={class:"flex flex-wrap items-center justify-center md:justify-end gap-2 sm:gap-4"},Jt={class:"bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 px-3 py-1 rounded-full text-xs font-semibold shadow-sm"},qt={class:"bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 px-3 py-1 rounded-full text-xs font-semibold shadow-sm"},Zt={class:"bg-purple-100 dark:bg-purple-900/50 text-purple-600 dark:text-purple-400 px-3 py-1 rounded-full text-xs font-semibold shadow-sm"},Qt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Xt={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},el={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},al={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},tl={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},ll={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},sl={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},nl={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},rl={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},ol={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200 dark:border-gray-700 mb-8"},dl={class:"h-64 flex items-end justify-between gap-2"},il={class:"text-xs text-gray-500 dark:text-gray-400"},ul={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200 dark:border-gray-700 mb-8"},cl={class:"grid grid-cols-2 sm:grid-cols-4 gap-4"},ml={class:"flex items-center gap-3 mb-2"},bl={class:"text-2xl"},vl={class:"font-semibold text-gray-800 dark:text-gray-100"},pl={class:"text-sm text-gray-500 dark:text-gray-400"},gl={class:"text-lg font-bold text-green-600 dark:text-green-400"},yl={key:0,class:"mb-6"},xl={key:1,class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},kl={key:2,class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200 dark:border-gray-700 mb-6"},fl={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},hl={class:"flex items-center justify-between mb-2"},wl={class:"font-semibold text-gray-800 dark:text-gray-100"},Al={class:"text-2xl font-bold text-purple-600 dark:text-purple-400 mb-1"},Dl={class:"text-sm text-gray-600 dark:text-gray-400"},Ml={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200 dark:border-gray-700"},Cl={class:"mt-6 space-y-2"},jl={key:0,class:"text-center py-12 text-gray-500 dark:text-gray-400"},Il={key:1},Nl={class:"md:col-span-5 flex items-center gap-4"},Bl={class:"font-bold text-gray-800 dark:text-gray-100"},Tl={class:"text-sm text-gray-500 dark:text-gray-400"},Sl={class:"md:col-span-3 text-left md:text-center text-2xl font-semibold text-green-600 dark:text-green-400"},Vl={class:"md:col-span-2 text-left md:text-center text-sm text-gray-600 dark:text-gray-300"},zl={class:"font-semibold text-gray-800 dark:text-gray-100 flex items-center gap-2"},Pl={key:0,class:"md:col-span-2 text-right"},El={class:"dropdown dropdown-end"},Fl={tabindex:"0",class:"dropdown-content menu p-2 shadow bg-base-200 rounded-box w-32 z-10"},Ll=["onClick"],Ul=["onClick"],Hl={key:0,class:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 pt-6 border-t dark:border-gray-700"},Rl={class:"flex items-center gap-4"},Kl={class:"text-sm text-gray-500"},Yl={class:"font-medium"},Ol={class:"font-medium"},_l={class:"font-medium"},Gl={class:"flex items-center gap-1"},$l=["disabled"],Wl=["disabled"],Jl={class:"flex items-center gap-1"},ql=["onClick"],Zl=["disabled"],Ql=["disabled"],Xl={key:0,class:"modal",open:""},es={key:1,class:"modal",open:""},as={class:"modal-box max-w-4xl"},ts={class:"flex items-center justify-between mb-4"},ls={key:2,class:"modal",open:""},ss={class:"modal-box max-w-6xl"},ns={class:"flex items-center justify-between mb-4"},rs={key:3,class:"modal",open:""},os={class:"modal-box max-w-6xl"},ds={class:"flex items-center justify-between mb-4"},is={key:4,class:"flex justify-center items-center py-12"},us={__name:"Payments",setup(o){const{handleNetworkError:i}=F(),{notifySuccess:c,notifyError:v}=N(),p=S(),g=Ot(),h=Q(),w=e=>function(e,a="dd.MM.yyyy"){if(!e)return"Tarih belirtilmedi";try{let t;if("string"==typeof e)t=Y(e);else{if(!(e instanceof Date))return"Ge√ßersiz tarih";t=e}return O(t)?t.getFullYear()<=1900?"Tarih belirtilmedi":_(t,a,{locale:I}):"Ge√ßersiz tarih"}catch(t){return"Ge√ßersiz tarih"}}(e,"dd MMM yyyy"),D=e(()=>g.payments),M=e(()=>h.tenants),B=e(()=>g.advanceAccounts),T=u(["Ziraat","ƒ∞≈ü Bankasƒ±","Garanti","Yapƒ± Kredi","Halkbank"]),z=u(!1),P=u(!1),E=u(!1),L=u(!1),K=e(()=>g.loading||h.loading),G=u(!1),$=u(!1),W=u(null),J=u({searchTerm:"",period:"",type:""}),te=e=>{if("number"==typeof e)return e;if(""===e||null==e)return"";if(!Number.isNaN(Number(e)))return Number(e);const a=Object.entries(q).find(([,a])=>a===e);return a?Number(a[0]):""},le={0:"üè¢",1:"‚ö°Ô∏è",2:"üíß",3:"üî•",4:"üí≥"},se=e=>le[te(e)]??"üí≥",ne=e(()=>Object.entries(q).map(([e,a])=>({value:Number(e),label:a,icon:se(Number(e))}))),re=e(()=>[{value:"",label:"T√ºm Tipler",icon:"üì¶"},...ne.value]),oe=e=>(null==e?void 0:e.date)||(null==e?void 0:e.paymentDate)||(null==e?void 0:e.createdAt)||"",de=e(()=>D.value.reduce((e,a)=>e+Number(a.amount||0),0)),ie=e(()=>{const e=new Date,a=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`;return D.value.filter(e=>(oe(e)||"").startsWith(a)).reduce((e,a)=>e+Number(a.amount||0),0)}),ue=e(()=>{const e=new Date,a=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`;return D.value.filter(e=>(oe(e)||"").startsWith(a)).length}),ce=e(()=>D.value.length),me=e(()=>B.value.reduce((e,a)=>e+Number(a.balance??0),0)),be=e=>{if(!e)return"Mal Sahibi √ñdemesi";const a=h.getTenantById(e);return(null==a?void 0:a.companyName)||(null==a?void 0:a.company)||(null==a?void 0:a.contactPersonName)||(null==a?void 0:a.fullName)||[null==a?void 0:a.firstName,null==a?void 0:a.lastName].filter(Boolean).join(" ")||(null==a?void 0:a.email)||`#${e}`},ve=e(()=>{let e=D.value;const a=(J.value.searchTerm||"").toLowerCase(),t=te(J.value.type);return""!==t&&void 0!==t&&(e=e.filter(e=>te(e.type)===t)),J.value.period&&(e=e.filter(e=>{const a=oe(e);if(!a)return!1;const t=new Date(J.value.period),l=new Date(a);return l.getFullYear()===t.getFullYear()&&l.getMonth()===t.getMonth()})),a&&(e=e.filter(e=>be(e.tenantId).toLowerCase().includes(a)||Z(te(e.type)).toLowerCase().includes(a)||e.bank&&e.bank.toLowerCase().includes(a)||e.amount&&String(e.amount).includes(a))),e.sort((e,a)=>new Date(oe(a))-new Date(oe(e)))}),pe=u(1),ge=u(10),ye=e(()=>Math.ceil(ve.value.length/ge.value)),xe=e(()=>{const e=(pe.value-1)*ge.value,a=e+ge.value;return ve.value.slice(e,a)}),ke=e(()=>xe.value.map(e=>({...e,company:be(e.tenantId)}))),fe=e(()=>{const e=ye.value;if(e<=7)return Array.from({length:e},(e,a)=>a+1);const a=pe.value;let t=Math.max(1,a-3),l=Math.min(e,a+3);return a<=4&&(l=7),a>=e-3&&(t=e-6),Array.from({length:l-t+1},(e,a)=>t+a)});m([J,ge],()=>{pe.value=1},{deep:!0});const he=u({date:(new Date).toISOString().substring(0,10),tenantId:"",ownerId:null,amount:null,type:"",bank:"",description:""}),we=u(!1),Ae=u(null),De=()=>{z.value=!1,G.value=!1,$.value=!1,W.value=null,he.value={date:(new Date).toISOString().substring(0,10),tenantId:"",ownerId:null,amount:null,type:"",bank:"",description:""},we.value=!1,Ae.value=null},Me=()=>{if(G.value)return W.value="closePaymentModal",void($.value=!0);De()},Ce=()=>{"closePaymentModal"===W.value&&De()},je=()=>{$.value=!1,W.value=null},Ie=()=>{J.value={searchTerm:"",period:"",type:""},g.fetchPayments(!0)},Ne=async()=>{z.value=!1,he.value={date:(new Date).toISOString().substring(0,10),tenantId:"",ownerId:null,amount:null,type:"",bank:"",description:""};const e=we.value;we.value=!1,Ae.value=null,await Promise.all([g.fetchPayments(!0),g.fetchAdvanceAccounts()]),c(e?"√ñdeme g√ºncellendi.":"√ñdeme kaydedildi.")},Be=()=>{P.value=!1,g.fetchAdvanceAccounts(),c("Avans hesabƒ± i≈ülemi ba≈üarƒ±yla tamamlandƒ±.")},Te=e(()=>{const e=[],a=new Date;for(let t=5;t>=0;t--){const l=new Date(a.getFullYear(),a.getMonth()-t,1),s=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`,n=l.toLocaleDateString("tr-TR",{month:"short"}),r=D.value.filter(e=>(oe(e)||"").startsWith(s)).reduce((e,a)=>e+Number(a.amount||0),0);e.push({month:n,total:r})}return e}),Se=e(()=>Math.max(...Te.value.map(e=>e.total),1)),Ve=e(()=>{const e={};return D.value.forEach(a=>{const t=te(a.type);""!==t&&(e[t]||(e[t]={name:t,label:Z(t),icon:se(t),count:0,total:0}),e[t].count++,e[t].total+=Number(a.amount||0))}),Object.values(e).sort((e,a)=>a.total-e.total)});return b(()=>{h.fetchTenants(),g.fetchAdvanceAccounts(),g.fetchPayments()}),(e,o)=>(l(),a("div",_t,[s("div",Gt,[s("div",$t,[o[22]||(o[22]=s("h1",{class:"text-2xl sm:text-3xl font-bold text-gray-800 dark:text-gray-100 text-center md:text-left"},"√ñdemeler",-1)),s("div",Wt,[s("div",Jt,[o[16]||(o[16]=s("span",{class:"hidden sm:inline"},"Toplam:",-1)),o[17]||(o[17]=s("span",{class:"sm:hidden text-[10px]"},"TOPLAM",-1)),n(" "+r(A(X)(de.value)),1)]),s("div",qt,[o[18]||(o[18]=s("span",{class:"hidden sm:inline"},"Bu Ay:",-1)),o[19]||(o[19]=s("span",{class:"sm:hidden text-[10px]"},"BU AY",-1)),n(" "+r(A(X)(ie.value)),1)]),s("div",Zt,[n(r(ce.value)+" ",1),o[20]||(o[20]=s("span",{class:"hidden sm:inline"},"√∂deme",-1)),o[21]||(o[21]=s("span",{class:"sm:hidden text-[10px]"},"KAYIT",-1))])])]),s("section",Qt,[s("div",Xt,[o[24]||(o[24]=s("div",{class:"bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 rounded-full p-3"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})])],-1)),s("div",null,[o[23]||(o[23]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Bu Ayki Gelir",-1)),s("p",el,r(A(X)(ie.value)),1)])]),s("div",al,[o[26]||(o[26]=s("div",{class:"bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 rounded-full p-3"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),s("div",null,[o[25]||(o[25]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Toplam Gelir",-1)),s("p",tl,r(A(X)(de.value)),1)])]),s("div",ll,[o[28]||(o[28]=s("div",{class:"bg-amber-100 dark:bg-amber-900/50 text-amber-600 dark:text-amber-400 rounded-full p-3"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),s("div",null,[o[27]||(o[27]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Bu Ayki ƒ∞≈ülem Sayƒ±sƒ±",-1)),s("p",sl,r(ue.value),1)])]),s("div",nl,[o[30]||(o[30]=s("div",{class:"bg-purple-100 dark:bg-purple-900/50 text-purple-600 dark:text-purple-400 rounded-full p-3"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])],-1)),s("div",null,[o[29]||(o[29]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Toplam Avans",-1)),s("p",rl,r(A(X)(me.value)),1)])])]),s("section",ol,[o[31]||(o[31]=s("div",{class:"flex items-center justify-between mb-4"},[s("h2",{class:"text-xl font-semibold text-gray-800 dark:text-gray-100"},"Aylƒ±k √ñdeme Grafiƒüi")],-1)),s("div",dl,[(l(!0),a(y,null,x(Te.value,(e,t)=>(l(),a("div",{key:t,class:"flex-1 flex flex-col items-center gap-2"},[s("div",{class:"w-full bg-green-500 rounded-t",style:j({height:e.total/Se.value*200+"px"})},null,4),s("span",il,r(e.month),1)]))),128))])]),s("section",ul,[o[32]||(o[32]=s("h2",{class:"text-xl font-semibold text-gray-800 dark:text-gray-100 mb-4"},"√ñdeme Tipi Daƒüƒ±lƒ±mƒ±",-1)),s("div",cl,[(l(!0),a(y,null,x(Ve.value,e=>(l(),a("div",{key:e.name,class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600"},[s("div",ml,[s("span",bl,r(e.icon),1),s("div",null,[s("p",vl,r(e.label),1),s("p",pl,r(e.count)+" √∂deme",1)])]),s("p",gl,r(A(X)(e.total)),1)]))),128))])]),A(p).role===A(V).ADMIN||A(p).role===A(V).MANAGER?(l(),a("div",yl,[s("button",{onClick:o[0]||(o[0]=e=>z.value=!0),class:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-4 px-6 rounded-xl shadow-lg transition-all duration-300 active:scale-[0.98] active:opacity-90 flex items-center justify-center gap-3"},o[33]||(o[33]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),s("span",null,"Yeni √ñdeme Ekle",-1)]))])):t("",!0),A(p).role===A(V).ADMIN||A(p).role===A(V).MANAGER?(l(),a("div",xl,[s("button",{onClick:o[1]||(o[1]=e=>P.value=!0),class:"bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-semibold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 flex items-center justify-center gap-2"},o[34]||(o[34]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})],-1),s("span",null,"Avans Hesabƒ±",-1)])),s("button",{onClick:o[2]||(o[2]=e=>E.value=!0),class:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-semibold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 flex items-center justify-center gap-2"},o[35]||(o[35]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2z"})],-1),s("span",null,"Finansal Raporlar",-1)])),A(p).role===A(V).ADMIN?(l(),a("button",{key:0,onClick:o[3]||(o[3]=e=>L.value=!0),class:"bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 text-white font-semibold py-3 px-4 rounded-xl shadow-lg transition-all duration-300 flex items-center justify-center gap-2"},o[36]||(o[36]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),s("span",null,"Sistem Loglarƒ±",-1)]))):t("",!0)])):t("",!0),B.value.length>0?(l(),a("div",kl,[o[38]||(o[38]=s("h3",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4 flex items-center gap-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-purple-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})]),n(" Avans Hesaplarƒ± ")],-1)),s("div",fl,[(l(!0),a(y,null,x(B.value,e=>(l(),a("div",{key:e.id,class:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800"},[s("div",hl,[s("span",wl,r(be(e.tenantId)),1),o[37]||(o[37]=s("span",{class:"badge badge-success badge-sm"},"Aktif",-1))]),s("p",Al,r(A(X)(Number(e.balance??e.amount??0))),1),s("p",Dl,r(w(e.updatedAt||e.lastMovementAt||e.createdAt||e.paymentDate)),1)]))),128))])])):t("",!0),s("div",Ml,[C(U,{search:J.value.searchTerm,"search-placeholder":"Firma, tutar, tip veya banka ara...",period:J.value.period,"select-type":J.value.type,"select-type-options":re.value,"onUpdate:search":o[4]||(o[4]=e=>J.value.searchTerm=e),"onUpdate:period":o[5]||(o[5]=e=>J.value.period=e),"onUpdate:selectType":o[6]||(o[6]=e=>J.value.type=e),onClearFilters:Ie},null,8,["search","period","select-type","select-type-options"]),s("div",Cl,[0===ve.value.length?(l(),a("div",jl,o[39]||(o[39]=[s("p",null,"Aramanƒ±zla e≈üle≈üen √∂deme bulunamadƒ±.",-1)]))):(l(),a("div",Il,[(l(!0),a(y,null,x(ke.value,e=>(l(),a("div",{key:e.id,class:"grid grid-cols-1 md:grid-cols-12 gap-4 items-center p-4 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-200 border-b dark:border-gray-700/50"},[s("div",Nl,[s("div",{class:d(["flex-shrink-0 h-12 w-12 flex items-center justify-center text-white rounded-full text-xl font-bold",A(ee)(e.company)])},r(A(ae)(e.company)),3),s("div",null,[s("p",Bl,r(e.company),1),s("p",Tl,r(w(oe(e))),1)])]),s("div",Sl,r(A(X)(e.amount)),1),s("div",Vl,[s("p",zl,[s("span",null,r(se(e.type)),1),s("span",null,r(A(Z)(te(e.type))),1)]),s("p",null,r(e.bank),1)]),A(p).role===A(V).ADMIN||A(p).role===A(V).MANAGER?(l(),a("div",Pl,[s("div",El,[o[40]||(o[40]=s("label",{tabindex:"0",class:"btn btn-ghost btn-sm"},"ƒ∞≈ülemler",-1)),s("ul",Fl,[s("li",null,[s("a",{onClick:a=>{return t=e,he.value={date:(oe(t)||(new Date).toISOString()).substring(0,10),tenantId:t.tenantId||"",ownerId:t.ownerId??null,amount:t.amount??null,type:te(t.type),bank:t.bank??"",description:t.description??""},Ae.value=t.id,we.value=!0,void(z.value=!0);var t}},"D√ºzenle",8,Ll)]),s("li",null,[s("a",{onClick:a=>(async e=>{try{await g.deletePayment(e),c("√ñdeme silindi.")}catch(a){v("√ñdeme silinemedi."),i(a,{component:"Payments",action:"deletePayment"})}})(e.id),class:"text-red-500"},"Sil",8,Ul)])])])])):t("",!0)]))),128)),ye.value>1?(l(),a("div",Hl,[s("div",Rl,[s("p",Kl,[o[41]||(o[41]=n(" Toplam ")),s("span",Yl,r(ve.value.length),1),o[42]||(o[42]=n(" kayƒ±t arasƒ±ndan ")),s("span",Ol,r((pe.value-1)*ge.value+1),1),o[43]||(o[43]=n(" - ")),s("span",_l,r(Math.min(pe.value*ge.value,ve.value.length)),1),o[44]||(o[44]=n(" arasƒ± g√∂steriliyor "))]),k(s("select",{"onUpdate:modelValue":o[7]||(o[7]=e=>ge.value=e),class:"select select-xs select-bordered bg-white dark:bg-gray-700"},o[45]||(o[45]=[s("option",{value:10},"10 / sayfa",-1),s("option",{value:25},"25 / sayfa",-1),s("option",{value:50},"50 / sayfa",-1),s("option",{value:100},"100 / sayfa",-1)]),512),[[f,ge.value]])]),s("div",Gl,[s("button",{onClick:o[8]||(o[8]=e=>pe.value=1),disabled:1===pe.value,class:"btn btn-sm btn-ghost","aria-label":"ƒ∞lk Sayfa"}," ¬´¬´ ",8,$l),s("button",{onClick:o[9]||(o[9]=e=>pe.value--),disabled:1===pe.value,class:"btn btn-sm btn-ghost"}," √ñnceki ",8,Wl),s("div",Jl,[(l(!0),a(y,null,x(fe.value,e=>(l(),a("button",{key:e,onClick:a=>pe.value=e,class:d(["btn btn-sm",pe.value===e?"btn-primary":"btn-ghost"])},r(e),11,ql))),128))]),s("button",{onClick:o[10]||(o[10]=e=>pe.value++),disabled:pe.value===ye.value,class:"btn btn-sm btn-ghost"}," Sonraki ",8,Zl),s("button",{onClick:o[11]||(o[11]=e=>pe.value=ye.value),disabled:pe.value===ye.value,class:"btn btn-sm btn-ghost","aria-label":"Son Sayfa"}," ¬ª¬ª ",8,Ql)])])):t("",!0)]))])])]),C(Da,{visible:z.value,payment:he.value,tenants:M.value,banks:T.value,editMode:we.value,onSave:Ne,onCancel:Me,onDirtyChanged:o[12]||(o[12]=e=>G.value=e)},null,8,["visible","payment","tenants","banks","editMode"]),$.value?(l(),a("dialog",Xl,[s("div",{class:"modal-box"},[o[46]||(o[46]=s("h3",{class:"font-bold text-lg"},"Deƒüi≈üiklikler kaybolacak",-1)),o[47]||(o[47]=s("p",{class:"py-4"},"Kaydetmeden √ßƒ±kmak istediƒüine emin misin?",-1)),s("div",{class:"modal-action"},[s("button",{class:"btn btn-ghost",onClick:je},"Vazge√ß"),s("button",{class:"btn btn-primary",onClick:Ce},"Devam Et")])])])):t("",!0),P.value?(l(),a("dialog",es,[s("div",as,[s("div",ts,[o[48]||(o[48]=s("h3",{class:"text-xl font-bold"},"Avans Hesabƒ± Y√∂netimi",-1)),s("button",{onClick:o[13]||(o[13]=e=>P.value=!1),class:"btn btn-sm btn-ghost"},"‚úï")]),C(H,{onSuccess:Be})])])):t("",!0),E.value?(l(),a("dialog",ls,[s("div",ss,[s("div",ns,[o[49]||(o[49]=s("h3",{class:"text-xl font-bold"},"Finansal Raporlar",-1)),s("button",{onClick:o[14]||(o[14]=e=>E.value=!1),class:"btn btn-sm btn-ghost"},"‚úï")]),C(Xa)])])):t("",!0),L.value?(l(),a("dialog",rs,[s("div",os,[s("div",ds,[o[50]||(o[50]=s("h3",{class:"text-xl font-bold"},"Sistem Loglarƒ±",-1)),s("button",{onClick:o[15]||(o[15]=e=>L.value=!1),class:"btn btn-sm btn-ghost"},"‚úï")]),C(Yt)])])):t("",!0),K.value?(l(),a("div",is,[C(R)])):t("",!0)]))}};export{us as default};
