import{r as e,w as a,o as r,b as t,m as l,j as o,e as s,p as n,s as i,G as d,H as u,I as c,F as b,i as g,t as y,J as v,c as m,f as p,n as f,u as x,E as k,l as h,q as w}from"./vue-vendor-Bart4FG5.js";import{a as A,u as N,R as U,e as C}from"./index-BbOmoSe-.js";import"./utils-vendor-Cy2sLATb.js";const S="/owners",O={async getOwners(e={}){const a=new URLSearchParams;e.searchTerm&&a.append("searchTerm",e.searchTerm),void 0!==e.isActive&&a.append("isActive",String(e.isActive));const r=a.toString(),t=r?`${S}?${r}`:S;return await A.get(t)}},T=["open"],$={key:0,class:"modal-box max-w-4xl bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border border-gray-200 dark:border-gray-700 shadow-2xl"},I={class:"flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700 mb-6"},F={class:"overflow-y-auto max-h-[70vh] pr-2"},M={class:"card bg-base-200 p-4"},R={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},j={class:"form-control"},P={class:"form-control"},V={key:0,class:"form-control"},K=["disabled"],B={key:0,class:"text-xs text-gray-500"},G={class:"form-control"},E={class:"form-control"},z={class:"form-control md:col-span-2"},D=["value"],L={class:"form-control"},q={class:"label cursor-pointer"},_={class:"form-control"},H={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700 mt-6"},Y={__name:"FlatEditModal",props:{flat:Object,visible:Boolean},emits:["save","close"],setup(m,{emit:p}){const f=m,x=p,k=e(null),h=e([]),w=async()=>{try{const e=await O.getOwners({isActive:!0});h.value=Array.isArray(e)?e:[]}catch(e){}};a(()=>f.flat,e=>{e&&(k.value={...e})},{immediate:!0}),a(()=>f.visible,e=>{e&&w()}),r(w),a(()=>{var e;return null==(e=k.value)?void 0:e.type},e=>{k.value&&("Parking"===e?k.value.floorNumber=null:"Entry"===e&&(k.value.floorNumber=0))});const A=()=>{if(!k.value)return;const e={...k.value};e.code=String(e.code||"").trim().toUpperCase(),x("save",e)};return(e,a)=>(l(),t("dialog",{id:"editFlatModal",class:"modal",open:m.visible},[m.flat?(l(),t("div",$,[s("div",I,[a[11]||(a[11]=s("h3",{class:"text-xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2"},[s("span",{class:"text-2xl"},"âœï¸"),n(" Ãœnite Bilgilerini GÃ¼ncelle ")],-1)),s("button",{onClick:a[0]||(a[0]=a=>e.$emit("close")),class:"btn btn-sm btn-ghost text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},a[10]||(a[10]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),s("div",F,[s("form",{onSubmit:i(A,["prevent"]),class:"space-y-6"},[s("div",M,[a[22]||(a[22]=s("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ“‹ Temel Bilgiler",-1)),s("div",R,[s("div",j,[a[12]||(a[12]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Ãœnite Kodu (Code) *")],-1)),d(s("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>k.value.code=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},null,512),[[u,k.value.code,void 0,{trim:!0}]])]),s("div",P,[a[14]||(a[14]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Tip *")],-1)),d(s("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>k.value.type=e),class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},a[13]||(a[13]=[s("option",{value:"Floor"},"Kat",-1),s("option",{value:"Entry"},"GiriÅŸ",-1),s("option",{value:"Parking"},"Otopark",-1)]),512),[[c,k.value.type]])]),"Parking"!==k.value.type?(l(),t("div",V,[a[15]||(a[15]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Kat (FloorNumber) *")],-1)),d(s("input",{type:"number","onUpdate:modelValue":a[3]||(a[3]=e=>k.value.floorNumber=e),disabled:"Entry"===k.value.type,class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},null,8,K),[[u,k.value.floorNumber,void 0,{number:!0}]]),"Entry"===k.value.type?(l(),t("small",B,"GiriÅŸ iÃ§in kat = 0 kabul edilir.")):o("",!0)])):o("",!0),s("div",G,[a[16]||(a[16]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Alan (mÂ²) *")],-1)),d(s("input",{type:"number","onUpdate:modelValue":a[4]||(a[4]=e=>k.value.unitArea=e),min:"1",step:"0.01",class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},null,512),[[u,k.value.unitArea,void 0,{number:!0}]])]),s("div",E,[a[17]||(a[17]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"AylÄ±k Kira")],-1)),d(s("input",{type:"number","onUpdate:modelValue":a[5]||(a[5]=e=>k.value.monthlyRent=e),min:"0",step:"0.01",class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400"},null,512),[[u,k.value.monthlyRent,void 0,{number:!0}]])]),s("div",z,[a[19]||(a[19]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Mal Sahibi")],-1)),d(s("select",{"onUpdate:modelValue":a[6]||(a[6]=e=>k.value.ownerId=e),class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400"},[a[18]||(a[18]=s("option",{value:null},"â€” SeÃ§ilmedi â€”",-1)),(l(!0),t(b,null,g(h.value,e=>(l(),t("option",{key:e.id,value:e.id},y((e=>{const a=e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"Mal Sahibi",r=e.phone||e.email||"";return r?`${a} (${r})`:a})(e)),9,D))),128))],512),[[c,k.value.ownerId]])]),s("div",L,[s("label",q,[a[20]||(a[20]=s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Aktif Ãœnite",-1)),d(s("input",{type:"checkbox","onUpdate:modelValue":a[7]||(a[7]=e=>k.value.isActive=e),class:"toggle toggle-success"},null,512),[[v,k.value.isActive]])])]),s("div",_,[a[21]||(a[21]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"AÃ§Ä±klama")],-1)),d(s("textarea",{"onUpdate:modelValue":a[8]||(a[8]=e=>k.value.description=e),rows:"3",class:"textarea textarea-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400"},null,512),[[u,k.value.description]])])])])],32)]),s("div",H,[s("button",{type:"button",onClick:a[9]||(a[9]=a=>e.$emit("close")),class:"btn btn-outline border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"},"Ä°ptal"),s("button",{onClick:A,class:"btn btn-primary bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 border-0 text-white shadow-lg"},"GÃ¼ncelle")])])):o("",!0)],8,T))}},Z="/flats",J="/tenants",W={async getFlats(e={}){const a=new URLSearchParams;""!==e.isActive&&void 0!==e.isActive&&a.append("isActive",String(e.isActive)),""!==e.isOccupied&&void 0!==e.isOccupied&&a.append("isOccupied",String(e.isOccupied)),e.type&&a.append("type",e.type),""!==e.floorNumber&&null!==e.floorNumber&&void 0!==e.floorNumber&&a.append("floorNumber",e.floorNumber),e.code&&a.append("code",e.code),e.searchTerm&&a.append("searchTerm",e.searchTerm),e.ownerId&&a.append("ownerId",e.ownerId),e.tenantId&&a.append("tenantId",e.tenantId),a.has("floorNumber")||void 0===e.floor||""===e.floor||a.append("floorNumber",e.floor);const r=a.toString(),t=r?`${Z}?${r}`:Z;return await A.get(t)},getFlatById:async e=>await A.get(`${Z}/${e}`),createFlat:async e=>await A.post(Z,e),async updateFlat(e,a){const r={id:e,...a};return await A.put(`${Z}/${e}`,r)},deleteFlat:async e=>await A.delete(`${Z}/${e}`),async getAvailableFlats(e={}){const a=new URLSearchParams;void 0!==e.floorNumber&&""!==e.floorNumber&&a.append("floor",e.floorNumber),e.searchTerm&&a.append("searchTerm",e.searchTerm);const r=a.toString(),t=r?`${J}/available-flats?${r}`:`${J}/available-flats`;return await A.get(t)},getFlatStats:async()=>await A.get(`${Z}/stats`)},Q=["open"],X={class:"modal-box max-w-4xl bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border border-gray-200 dark:border-gray-700 shadow-2xl"},ee={class:"flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700 mb-6"},ae={class:"overflow-y-auto max-h-[70vh] pr-2"},re={class:"card bg-base-200 p-4"},te={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},le={class:"form-control"},oe={key:0,class:"label"},se={class:"label-text-alt text-error"},ne={class:"form-control"},ie={key:0,class:"form-control"},de=["disabled"],ue={key:0,class:"text-xs text-gray-500"},ce={class:"form-control"},be={class:"md:col-span-2"},ge={class:"form-control"},ye=["value"],ve={class:"form-control"},me={class:"form-control"},pe={class:"label cursor-pointer"},fe={class:"form-control"},xe={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700 mt-6"},ke=["disabled"],he={key:0,class:"loading loading-spinner mr-2"},we={__name:"FlatCreateModal",props:{visible:Boolean},emits:["save","close"],setup(r,{emit:m}){const p=r,f=m,x=e(!1),k=e(""),h=e({code:"",type:0,floorNumber:null,unitArea:0,ownerId:null,monthlyRent:0,isActive:!0,description:""}),w=e([]);function A(){k.value="";const e=(h.value.code||"").trim().toUpperCase();if(h.value.code=e,!e)return;if(e.startsWith("OTOPARK")||"P"===e||"PARK"===e)return h.value.type=2,void(h.value.floorNumber=null);if(e.match(/^G([A-Z])$/))return h.value.type=1,void(h.value.floorNumber=0);const a=e.match(/^(\d{1,2})([A-Z])$/);if(a)return h.value.type=0,void(h.value.floorNumber=parseInt(a[1],10));const r=e.match(/^([A-Z])[- ]?(\d{3,})$/);if(r){const e=parseInt(r[2],10),a=Math.floor(e/100);return h.value.type=0,void(h.value.floorNumber=isFinite(a)?a:null)}const t=e.match(/^(\d{3,})$/);if(t){const e=parseInt(t[1],10);h.value.type=0,h.value.floorNumber=Math.floor(e/100)}}async function N(){var e;if(h.value.code&&h.value.unitArea&&(2===h.value.type||null!==h.value.floorNumber&&void 0!==h.value.floorNumber)){x.value=!0,k.value="";try{const a=await W.getFlats({code:String(h.value.code).trim().toUpperCase()});if(Array.isArray(a)&&a.length>0)return k.value=`Bu kod zaten kullanÄ±lÄ±yor: ${h.value.code}`,void(x.value=!1);const r={code:String(h.value.code||"").trim().toUpperCase(),type:Number(h.value.type),floorNumber:1===h.value.type?0:2===h.value.type?null:h.value.floorNumber,unitArea:Number(h.value.unitArea||0),ownerId:h.value.ownerId||null,monthlyRent:h.value.monthlyRent?Number(h.value.monthlyRent):null,isActive:!!h.value.isActive,description:(null==(e=h.value.description)?void 0:e.trim())||`OluÅŸturan: UI (${(new Date).toLocaleString("tr-TR")})`};f("save",r),h.value={code:"",type:0,floorNumber:null,unitArea:0,ownerId:null,monthlyRent:0,isActive:!0,description:""}}finally{x.value=!1}}}return a(()=>p.visible,e=>{e&&(h.value={code:"",type:0,floorNumber:null,unitArea:0,ownerId:null,monthlyRent:0,isActive:!0,description:""},k.value="",(async(e="")=>{try{const a=await O.getOwners({searchTerm:e,isActive:!0});w.value=Array.isArray(a)?a:[]}catch(a){w.value=[]}})())}),a(()=>h.value.type,e=>{2===e?h.value.floorNumber=null:1===e&&(h.value.floorNumber=0)}),(e,a)=>(l(),t("dialog",{id:"createFlatModal",class:"modal",open:r.visible},[s("div",X,[s("div",ee,[a[11]||(a[11]=s("h3",{class:"text-xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2"},[s("span",{class:"text-2xl"},"ðŸ¢"),n(" Yeni Ãœnite Ekle ")],-1)),s("button",{onClick:a[0]||(a[0]=a=>e.$emit("close")),class:"btn btn-sm btn-ghost text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},a[10]||(a[10]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),s("div",ae,[s("form",{onSubmit:i(N,["prevent"]),id:"flatForm",class:"space-y-6"},[s("div",re,[a[22]||(a[22]=s("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ“‹ Temel Bilgiler",-1)),s("div",te,[s("div",le,[a[12]||(a[12]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Ãœnite Kodu (Code) *")],-1)),d(s("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>h.value.code=e),onInput:A,class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"Ã–rn: A-201, 3A, GA, OTOPARK",required:""},null,544),[[u,h.value.code,void 0,{trim:!0}]]),k.value?(l(),t("label",oe,[s("span",se,y(k.value),1)])):o("",!0),a[13]||(a[13]=s("small",{class:"text-xs text-gray-500"},[n(" Ä°pucu: "),s("code",null,"A-201"),n(" yazarsanÄ±z kat otomatik "),s("b",null,"2"),n(" alÄ±nÄ±r. "),s("code",null,"GA"),n(" giriÅŸ-A bÃ¶lÃ¼mÃ¼ anlamÄ±na gelir. ")],-1))]),s("div",ne,[a[15]||(a[15]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Tip *")],-1)),d(s("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>h.value.type=e),class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},a[14]||(a[14]=[s("option",{value:0},"Kat",-1),s("option",{value:1},"GiriÅŸ",-1),s("option",{value:2},"Otopark",-1)]),512),[[c,h.value.type,void 0,{number:!0}]])]),2!==h.value.type?(l(),t("div",ie,[a[16]||(a[16]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Kat (FloorNumber) *")],-1)),d(s("input",{type:"number","onUpdate:modelValue":a[3]||(a[3]=e=>h.value.floorNumber=e),disabled:1===h.value.type,class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"Ã–rn: 3",required:""},null,8,de),[[u,h.value.floorNumber,void 0,{number:!0}]]),1===h.value.type?(l(),t("small",ue,"GiriÅŸ iÃ§in kat = 0 kabul edilir.")):o("",!0)])):o("",!0),s("div",ce,[a[17]||(a[17]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Alan (mÂ²) *")],-1)),d(s("input",{type:"number","onUpdate:modelValue":a[4]||(a[4]=e=>h.value.unitArea=e),min:"1",step:"0.01",class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},null,512),[[u,h.value.unitArea,void 0,{number:!0}]])]),s("div",be,[s("div",ge,[a[19]||(a[19]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Mal Sahibi (opsiyonel)")],-1)),d(s("select",{"onUpdate:modelValue":a[5]||(a[5]=e=>h.value.ownerId=e),class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400"},[a[18]||(a[18]=s("option",{value:null},"â€” SeÃ§ilmedi â€”",-1)),(l(!0),t(b,null,g(w.value,e=>(l(),t("option",{key:e.id,value:e.id},y((e=>{const a=e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"Mal Sahibi",r=e.phone||e.email||"";return r?`${a} (${r})`:a})(e)),9,ye))),128))],512),[[c,h.value.ownerId]])])]),s("div",ve,[a[20]||(a[20]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"AylÄ±k Kira")],-1)),d(s("input",{type:"number","onUpdate:modelValue":a[6]||(a[6]=e=>h.value.monthlyRent=e),min:"0",step:"0.01",class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200"},null,512),[[u,h.value.monthlyRent,void 0,{number:!0}]])]),s("div",me,[s("label",pe,[a[21]||(a[21]=s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Aktif Ãœnite",-1)),d(s("input",{type:"checkbox","onUpdate:modelValue":a[7]||(a[7]=e=>h.value.isActive=e),class:"toggle toggle-success"},null,512),[[v,h.value.isActive]])])])])]),s("div",fe,[a[23]||(a[23]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"AÃ§Ä±klama")],-1)),d(s("textarea",{"onUpdate:modelValue":a[8]||(a[8]=e=>h.value.description=e),rows:"3",class:"textarea textarea-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200",placeholder:"KÄ±sa bir aÃ§Ä±klama girin (zorunlu)"},null,512),[[u,h.value.description,void 0,{trim:!0}]])])],32)]),s("div",xe,[s("button",{type:"button",onClick:a[9]||(a[9]=a=>e.$emit("close")),class:"btn btn-outline border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}," Ä°ptal "),s("button",{form:"flatForm",type:"submit",disabled:x.value,class:"btn btn-success bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 border-0 text-white shadow-lg"},[x.value?(l(),t("span",he)):o("",!0),a[24]||(a[24]=n(" Kaydet "))],8,ke)])])],8,Q))}},Ae={class:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 p-6"},Ne={class:"mb-8"},Ue={class:"flex items-center justify-between"},Ce={class:"card bg-white dark:bg-gray-800 shadow-lg mb-6"},Se={class:"card-body"},Oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4"},Te={class:"form-control"},$e={class:"form-control"},Ie=["value"],Fe={class:"form-control"},Me={class:"form-control"},Re={class:"form-control"},je={class:"flex justify-between items-center mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"},Pe={class:"text-sm text-gray-500 dark:text-gray-400"},Ve={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},Ke={class:"absolute top-4 right-4 z-10"},Be={class:"dropdown dropdown-end"},Ge={tabindex:"0",class:"dropdown-content menu p-2 shadow bg-base-200 rounded-box w-40 z-10"},Ee={key:0},ze=["onClick"],De={key:1},Le=["onClick"],qe={key:1,class:"opacity-50 pointer-events-none text-error"},_e={key:2},He=["onClick"],Ye={class:"flex items-center gap-4 mb-4"},Ze={class:"flex items-center gap-2 mb-1"},Je={class:"text-lg font-bold text-gray-800 dark:text-gray-100"},We={class:"badge badge-info text-xs"},Qe={class:"badge badge-ghost text-xs"},Xe={class:"flex items-center gap-2"},ea={class:"space-y-2 text-sm text-gray-600 dark:text-gray-400"},aa={class:"flex justify-between"},ra={class:"font-semibold"},ta={key:0,class:"flex justify-between"},la={class:"font-semibold text-green-600"},oa={key:1,class:"mt-3 text-xs text-gray-500 dark:text-gray-400 italic"},sa={key:1,class:"text-center py-12"},na={class:"card-body border-t border-gray-200 dark:border-gray-700"},ia={class:"flex items-center justify-between"},da={class:"text-sm text-gray-600 dark:text-gray-400"},ua={class:"join"},ca=["disabled"],ba={class:"join-item btn btn-sm"},ga=["disabled"],ya={__name:"Flats",setup(i){const v=e=>!(null==e?void 0:e.isOccupied),A=[{value:0,label:"Kat"},{value:1,label:"GiriÅŸ"},{value:2,label:"Otopark"}],S=e=>({...e,type:Number(e.type),floorNumber:2===e.type?null:Number(e.floorNumber??0)});h();const O=N(),T=e([]),$=e(!1),I=e(!1),F=e(!1),M=e(null),R=e(1),j=e({searchTerm:"",isActive:null,isOccupied:null,type:null,floorNumber:null}),P=m(()=>{let e=T.value;if(j.value.searchTerm){const a=String(j.value.searchTerm).toLowerCase();e=e.filter(e=>String(e.code??"").toLowerCase().includes(a)||String(e.floorNumber??"").toLowerCase().includes(a))}if(null!==j.value.type){const a=Number(j.value.type);e=e.filter(e=>Number(e.type)===a)}null!==j.value.isActive&&(e=e.filter(e=>e.isActive===j.value.isActive)),null!==j.value.isOccupied&&(e=e.filter(e=>e.isOccupied===j.value.isOccupied));const a=j.value.floorNumber;if(null!==a&&""!==a&&Number.isFinite(Number(a))){const r=Number(a);e=e.filter(e=>Number(e.floorNumber)===r)}return e}),V=m(()=>{const e=10*(R.value-1),a=e+10;return P.value.slice(e,a)}),K=m(()=>Math.ceil(P.value.length/10)),B=async()=>{$.value=!0;try{const e=await W.getFlats({});T.value=e||[]}catch(e){C.logError(e,{component:"UnitsPage",action:"fetch"})}finally{$.value=!1}},G=()=>{R.value=1},E=()=>{j.value={searchTerm:"",isActive:null,isOccupied:null,type:null,floorNumber:null},R.value=1},z=async e=>{try{const a={...e};a.description&&a.description.trim()||(a.description=`UI Ã¼zerinden oluÅŸturuldu (${(new Date).toLocaleString("tr-TR")})`),await W.createFlat(S(a)),C.logSuccess("success","Ãœnite baÅŸarÄ±yla eklendi.",{component:"UnitsPage",action:"create"}),I.value=!1,await B()}catch(a){C.logError(a,{component:"UnitsPage",action:"create"})}},D=async e=>{try{await W.updateFlat(M.value.id,S({...e,id:M.value.id})),C.logSuccess("success","Ãœnite baÅŸarÄ±yla gÃ¼ncellendi.",{component:"UnitsPage",action:"update"}),L(),await B()}catch(a){C.logError(a,{component:"UnitsPage",action:"update"})}},L=()=>{M.value=null,F.value=!1},q=e=>e.isActive?e.isOccupied?"bg-orange-500":"bg-green-500":"bg-gray-500",_=e=>2===e.type?"Otopark":1===e.type?"GiriÅŸ":`${e.floorNumber}. Kat`;return r(B),a(j,G,{deep:!0}),(e,a)=>(l(),t("div",Ae,[s("div",Ne,[s("div",Ue,[a[10]||(a[10]=s("div",null,[s("h1",{class:"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-2 flex items-center gap-3"},[s("span",{class:"text-4xl"},"ðŸ¢"),n(" Ãœnite YÃ¶netimi ")]),s("p",{class:"text-gray-600 dark:text-gray-400"},"Ä°ÅŸ hanÄ±ndaki tÃ¼m Ã¼niteleri yÃ¶netin")],-1)),x(O).role===x(U).ADMIN||x(O).role===x(U).MANAGER?(l(),t("button",{key:0,onClick:a[0]||(a[0]=e=>I.value=!0),class:"btn btn-success bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 border-0 text-white shadow-lg"},a[9]||(a[9]=[s("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),n(" Yeni Ãœnite Ekle ")]))):o("",!0)])]),s("div",Ce,[s("div",Se,[s("div",Oe,[s("div",Te,[a[11]||(a[11]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Arama")],-1)),d(s("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>j.value.searchTerm=e),onInput:G,class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"Kod (3A, GA, OTOPARK) veya kat"},null,544),[[u,j.value.searchTerm]])]),s("div",$e,[a[13]||(a[13]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Tip")],-1)),d(s("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>j.value.type=e),onChange:G,class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400"},[a[12]||(a[12]=s("option",{value:"null"},"TÃ¼mÃ¼",-1)),(l(),t(b,null,g(A,e=>s("option",{key:e.value,value:e.value},y(e.label),9,Ie)),64))],544),[[c,j.value.type]])]),s("div",Fe,[a[15]||(a[15]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Durum")],-1)),d(s("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>j.value.isActive=e),onChange:G,class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400"},a[14]||(a[14]=[s("option",{value:"null"},"TÃ¼mÃ¼",-1),s("option",{value:"true"},"Aktif",-1),s("option",{value:"false"},"Pasif",-1)]),544),[[c,j.value.isActive]])]),s("div",Me,[a[17]||(a[17]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Doluluk")],-1)),d(s("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>j.value.isOccupied=e),onChange:G,class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400"},a[16]||(a[16]=[s("option",{value:"null"},"TÃ¼mÃ¼",-1),s("option",{value:"true"},"Dolu",-1),s("option",{value:"false"},"BoÅŸ",-1)]),544),[[c,j.value.isOccupied]])]),s("div",Re,[a[18]||(a[18]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Kat")],-1)),d(s("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>j.value.floorNumber=e),onInput:G,type:"number",class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"Ã–rn: 3"},null,544),[[u,j.value.floorNumber,void 0,{number:!0}]])])]),s("div",je,[s("div",{class:"flex gap-2"},[s("button",{onClick:E,class:"btn btn-outline btn-sm border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"},a[19]||(a[19]=[s("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),n(" Filtreleri Temizle ")]))]),s("div",Pe,y(P.value.length)+" Ã¼nite bulundu ",1)])])]),P.value.length>0?(l(),t("div",Ve,[(l(!0),t(b,null,g(V.value,e=>{return l(),t("div",{key:e.id,class:"relative group bg-white dark:bg-gray-800 rounded-2xl shadow-lg transition-transform duration-200 hover:scale-105 hover:shadow-2xl p-6 flex flex-col"},[s("div",Ke,[s("div",Be,[a[20]||(a[20]=k('<button tabindex="0" class="btn btn-ghost btn-circle btn-sm"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><circle cx="12" cy="12" r="1.5"></circle><circle cx="19" cy="12" r="1.5"></circle><circle cx="5" cy="12" r="1.5"></circle></svg></button>',1)),s("ul",Ge,[x(O).role===x(U).ADMIN||x(O).role===x(U).MANAGER?(l(),t("li",Ee,[s("a",{onClick:a=>(e=>{M.value=e,F.value=!0})(e)},"DÃ¼zenle",8,ze)])):o("",!0),x(O).role===x(U).ADMIN?(l(),t("li",De,[v(e)?(l(),t("a",{key:0,onClick:a=>(async e=>{if(confirm(`${e.code} Ã¼nitesini silmek istediÄŸinizden emin misiniz?`))try{await W.deleteFlat(e.id),C.logSuccess("success","Ãœnite baÅŸarÄ±yla silindi.",{component:"UnitsPage",action:"delete"}),await B()}catch(a){C.logError(a,{component:"UnitsPage",action:"delete"})}})(e),class:"text-error"},"Sil",8,Le)):(l(),t("a",qe,"Sil (Dolu)"))])):o("",!0),x(O).role!==x(U).ADMIN&&x(O).role!==x(U).MANAGER||2!==e.type?o("",!0):(l(),t("li",_e,[s("a",{onClick:a=>(async e=>{try{await W.updateFlat(e.id,{...e,isActive:!1}),C.logSuccess("success","Otopark pasifleÅŸtirildi.",{component:"UnitsPage",action:"deactivate"}),await B()}catch(a){C.logError(a,{component:"UnitsPage",action:"deactivate"})}})(e)},"PasifleÅŸtir",8,He)]))])])]),s("div",Ye,[s("div",{class:w(["flex items-center justify-center rounded-full w-16 h-16 text-2xl font-bold text-white shadow-lg",q(e)])},y(e.code),3),s("div",null,[s("div",Ze,[s("span",Je,y(e.code),1),s("span",We,y(_(e)),1),s("span",Qe,y((n=e.type,{0:"Kat",1:"GiriÅŸ",2:"Otopark"}[n]??n)),1)]),s("div",Xe,[s("span",{class:w(["badge font-semibold",e.isActive?"badge-success":"badge-ghost"])},y(e.isActive?"Aktif":"Pasif"),3),s("span",{class:w(["badge font-semibold",e.isOccupied?"badge-warning":"badge-info"])},y(e.isOccupied?"Dolu":"BoÅŸ"),3)])])]),s("div",ea,[s("div",aa,[a[21]||(a[21]=s("span",null,"Alan:",-1)),s("span",ra,y(e.unitArea)+" mÂ²",1)]),e.monthlyRent&&e.monthlyRent>0?(l(),t("div",ta,[a[22]||(a[22]=s("span",null,"AylÄ±k Kira:",-1)),s("span",la,y((r=e.monthlyRent,new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(r))),1)])):o("",!0),e.description?(l(),t("div",oa,y(e.description),1)):o("",!0)])]);var r,n}),128))])):(l(),t("div",sa,a[23]||(a[23]=[k('<div class="text-gray-500 dark:text-gray-400"><svg class="mx-auto h-12 w-12 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg><p class="text-lg font-medium">Ãœnite bulunamadÄ±</p><p class="text-sm">Arama kriterlerinize uygun Ã¼nite bulunmamaktadÄ±r.</p></div>',1)]))),s("div",na,[s("div",ia,[s("div",da,y(10*(R.value-1)+1)+"-"+y(Math.min(10*R.value,P.value.length))+" / "+y(P.value.length)+" Ã¼nite ",1),s("div",ua,[s("button",{onClick:a[6]||(a[6]=e=>R.value--),disabled:1===R.value,class:"join-item btn btn-sm"},"Â«",8,ca),s("button",ba,y(R.value),1),s("button",{onClick:a[7]||(a[7]=e=>R.value++),disabled:R.value>=K.value,class:"join-item btn btn-sm"},"Â»",8,ga)])])]),p(we,{visible:I.value,onSave:z,onClose:a[8]||(a[8]=e=>I.value=!1)},null,8,["visible"]),M.value?(l(),f(Y,{key:2,visible:F.value,flat:M.value,onSave:D,onClose:L},null,8,["visible","flat"])):o("",!0)]))}};export{ya as default};
