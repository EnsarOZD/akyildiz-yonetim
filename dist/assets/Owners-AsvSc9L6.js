import{a as e}from"./index-CAkTsZV-.js";import{t as a}from"./tenantsService-DcFCN9jj.js";import{u as t}from"./useErrorHandler-CQcR_3b6.js";import{_ as r}from"./ConfirmDeleteModal-B9VWRTw-.js";import{_ as l}from"./FilterBar-wXoQM61V.js";import{r as s,C as n,w as o,G as i,c as d,l as c,b as u,n as b,q as g,D as v,H as m,e as h,F as p,i as x,I as y,t as k,o as w,f,p as C}from"./vue-vendor-BE3w9SvD.js";import{u as M}from"./useNotification-Dv4wKXE4.js";const O=new class{constructor(){this.backendAvailable=!1,this.checkBackendAvailability()}async checkBackendAvailability(){try{await e.get("/health"),this.backendAvailable=!0}catch(a){this.backendAvailable=!1}}async getOwners(a={}){try{if(this.backendAvailable)return await e.get("/owners",a)}catch(t){this.backendAvailable=!1}return[]}async getOwnerById(a){try{if(this.backendAvailable)return await e.get(`/owners/${a}`)}catch(t){this.backendAvailable=!1}return null}async createOwner(a){try{if(this.backendAvailable)return await e.post("/owners",a)}catch(t){this.backendAvailable=!1}return{success:!0,message:"Owner oluşturuldu (backend mevcut değil)"}}async updateOwner(a,t){try{if(this.backendAvailable)return await e.put(`/owners/${a}`,t)}catch(r){this.backendAvailable=!1}return{success:!0,message:"Owner güncellendi (backend mevcut değil)"}}async deleteOwner(a){try{if(this.backendAvailable)return await e.delete(`/owners/${a}`)}catch(t){this.backendAvailable=!1}return{success:!0,message:"Owner silindi (backend mevcut değil)"}}},A=["open"],S={class:"modal-box max-w-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700"},j={class:"flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700"},B={class:"form-control"},U={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},E={class:"form-control"},z={class:"form-control"},H={class:"form-control"},L={class:"p-4 border rounded-lg bg-gray-50 dark:bg-gray-700/50 dark:border-gray-600 max-h-48 overflow-y-auto"},_={class:"grid grid-cols-3 sm:grid-cols-4 gap-2"},K=["value"],T={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},V={key:0,class:"text-center text-sm text-gray-500 dark:text-gray-400"},N={key:0,class:"text-red-500 text-sm mt-1"},$={class:"modal-action pt-4 border-t border-gray-200 dark:border-gray-700"},D=["disabled"],I={__name:"OwnerCreateModal",props:{visible:Boolean,availableUnits:Array},emits:["close","save"],setup(e,{emit:a}){const t=e,r=a,l=s({name:"",phone:"",email:"",units:[]}),w=s(""),f=n(()=>l.value.name&&l.value.units.length>0),C=()=>{f.value?r("save",{...l.value}):0===l.value.units.length&&(w.value="En az bir kat seçmelisiniz.")};return o(()=>t.visible,e=>{e&&(l.value={name:"",phone:"",email:"",units:[]},w.value="")}),(a,t)=>{const r=i("mask");return c(),d("dialog",{open:e.visible,class:"modal bg-black/30 backdrop-blur-sm"},[u("div",S,[u("div",j,[t[7]||(t[7]=u("h3",{class:"text-xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2"},[u("span",{class:"text-2xl"},"🏠"),b(" Yeni Mal Sahibi Ekle ")],-1)),u("button",{onClick:t[0]||(t[0]=e=>a.$emit("close")),class:"btn btn-sm btn-ghost text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},t[6]||(t[6]=[u("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),u("form",{onSubmit:g(C,["prevent"]),class:"py-6 space-y-6"},[u("div",B,[t[8]||(t[8]=u("label",{class:"label"},[u("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Ad Soyad")],-1)),v(u("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>l.value.name=e),type:"text",placeholder:"Mal sahibinin adı ve soyadı",class:"input input-bordered w-full bg-white dark:bg-gray-700",required:""},null,512),[[m,l.value.name]])]),u("div",U,[u("div",E,[t[9]||(t[9]=u("label",{class:"label"},[u("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Telefon Numarası")],-1)),v(u("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>l.value.phone=e),type:"tel",placeholder:"+90 (5xx) xxx xx xx",class:"input input-bordered w-full bg-white dark:bg-gray-700"},null,512),[[m,l.value.phone],[r,"+90 (###) ### ## ##"]])]),u("div",z,[t[10]||(t[10]=u("label",{class:"label"},[u("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"E-posta Adresi")],-1)),v(u("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>l.value.email=e),type:"email",placeholder:"ornek@mail.com",class:"input input-bordered w-full bg-white dark:bg-gray-700"},null,512),[[m,l.value.email]])])]),u("div",H,[t[11]||(t[11]=u("label",{class:"label"},[u("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Sahip Olunan Katlar")],-1)),u("div",L,[u("div",_,[(c(!0),d(p,null,x(e.availableUnits,e=>(c(),d("label",{key:e,class:"flex items-center gap-2 p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors cursor-pointer"},[v(u("input",{type:"checkbox",value:e,"onUpdate:modelValue":t[4]||(t[4]=e=>l.value.units=e),class:"checkbox checkbox-primary"},null,8,K),[[y,l.value.units]]),u("span",T,k(e),1)]))),128))]),e.availableUnits&&0!==e.availableUnits.length?h("",!0):(c(),d("div",V," Atanacak boş kat bulunmuyor. "))]),w.value?(c(),d("div",N,k(w.value),1)):h("",!0)]),t[14]||(t[14]=u("div",{class:"text-sm text-gray-500 dark:text-gray-400"},[u("p",null,"Seçilen katlar bu mal sahibine atanacaktır. Bir kat yalnızca bir mal sahibine atanabilir.")],-1)),u("div",$,[u("button",{type:"button",onClick:t[5]||(t[5]=e=>a.$emit("close")),class:"btn btn-outline border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"},t[12]||(t[12]=[u("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),b(" İptal ")])),u("button",{type:"submit",class:"btn btn-primary bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 border-0 text-white shadow-lg",disabled:!f.value},t[13]||(t[13]=[u("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),b(" Kaydet ")]),8,D)])],32)])],8,A)}}},F={class:"p-4 sm:p-6 bg-gray-50 min-h-screen font-sans dark:bg-gray-900"},q={class:"max-w-7xl mx-auto"},Y={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},G={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},P={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},J={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},Q={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},R={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},W={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},X={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200 dark:border-gray-700"},Z={class:"mt-6 space-y-2"},ee={key:0,class:"text-center py-12 text-gray-500"},ae={key:1},te={class:"col-span-12 sm:col-span-5 flex items-center gap-4"},re={class:"font-bold text-gray-800 dark:text-gray-100"},le={class:"text-sm text-gray-500 dark:text-gray-400"},se={class:"col-span-12 sm:col-span-4 text-sm text-gray-600 dark:text-gray-300"},ne={key:0,class:"font-semibold text-gray-800 dark:text-gray-100"},oe={class:"col-span-12 sm:col-span-3 flex justify-end items-center"},ie={class:"dropdown dropdown-end"},de={tabindex:"0",class:"dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52"},ce=["onClick"],ue=["onClick"],be={__name:"Owners",setup(e){const{handleNetworkError:o,handleValidationError:i}=t(),{showCreateSuccess:b,showDeleteSuccess:g}=M(),v=s([]),m=s([]),y=s(null),A=s(!1),S=s(!1),j=s(!1),B=s(null),U=s("");w(()=>{try{v.value=O.getAllOwners(),m.value=a.getAllTenants()}catch(e){o(e,{component:"Owners",action:"fetchOwners"})}});const E=n(()=>v.value.length),z=n(()=>v.value.flatMap(e=>e.units||[])),H=n(()=>new Set(z.value).size),L=n(()=>{const e=new Set;return m.value.forEach(a=>{a.isActive&&a.units&&a.units.forEach(a=>{const t="object"==typeof a&&a.id?a.id:a;e.add(t)})}),e}),_=n(()=>[...new Set(z.value)].filter(e=>!L.value.has(e)).length),K=n(()=>{if(!U.value)return v.value;const e=U.value.toLowerCase();return v.value.filter(a=>{const t=a.name&&a.name.toLowerCase().includes(e),r=a.email&&a.email.toLowerCase().includes(e),l=a.units&&a.units.some(a=>String(a).toLowerCase().includes(e));return t||r||l})}),T=n(()=>K.value.map(e=>{const a=e.units?e.units.filter(e=>!L.value.has(e)):[];return{...e,vacantUnits:a}}).filter(e=>e.vacantUnits.length>0)),V=n(()=>{const e=new Set(z.value);return UNIT_OPTIONS.filter(a=>!e.has(a))}),N=()=>{U.value=""},$=e=>{if(!e)return"bg-gray-500";const a=["bg-blue-500","bg-purple-500","bg-amber-500","bg-emerald-500","bg-red-500","bg-pink-500","bg-indigo-500","bg-teal-500"];return a[e.split("").reduce((e,a)=>e+a.charCodeAt(0),0)%a.length]},D=async()=>{try{await O.deleteOwner(B.value.id),g("Mal Sahibi"),j.value=!1}catch(e){i(e,{component:"Owners",action:"deleteOwner"})}},be=async e=>{try{await O.createOwner(e),b("Mal Sahibi"),S.value=!1}catch(a){i(a,{component:"Owners",action:"saveOwner"})}};return(e,a)=>(c(),d("div",F,[u("div",q,[a[15]||(a[15]=u("h1",{class:"text-3xl font-bold text-gray-800 mb-6 dark:text-gray-100"},"Mal Sahipleri",-1)),u("section",Y,[u("div",G,[a[5]||(a[5]=u("div",{class:"bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 rounded-full p-3"},[u("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),u("div",null,[a[4]||(a[4]=u("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Toplam Mal Sahibi",-1)),u("p",P,k(E.value),1)])]),u("div",J,[a[7]||(a[7]=u("div",{class:"bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 rounded-full p-3"},[u("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1)),u("div",null,[a[6]||(a[6]=u("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Sahip Olunan Toplam Kat",-1)),u("p",Q,k(H.value),1)])]),u("div",R,[a[9]||(a[9]=u("div",{class:"bg-orange-100 dark:bg-orange-900/50 text-orange-600 dark:text-orange-400 rounded-full p-3"},[u("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})])],-1)),u("div",null,[a[8]||(a[8]=u("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Boşta Olan Kat",-1)),u("p",W,k(_.value),1)])]),u("div",{class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center justify-center border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-blue-500 dark:hover:border-blue-400 transition-colors duration-300",onClick:a[0]||(a[0]=e=>S.value=!0)},a[10]||(a[10]=[u("button",{class:"w-full h-full text-blue-500 dark:text-blue-400 flex items-center justify-center gap-2"},[u("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})]),u("span",{class:"font-semibold"},"Yeni Mal Sahibi Ekle")],-1)]))]),u("div",X,[f(l,{search:U.value,"onUpdate:search":a[1]||(a[1]=e=>U.value=e),"search-placeholder":"Mal sahibi adı veya kat ara...",onClearFilters:N},null,8,["search"]),u("div",Z,[0===T.value.length?(c(),d("div",ee,a[11]||(a[11]=[u("p",null,"Boşta katı olan mal sahibi bulunamadı.",-1)]))):(c(),d("div",ae,[a[14]||(a[14]=u("div",{class:"hidden sm:grid grid-cols-12 gap-4 px-4 py-2 text-sm font-semibold text-gray-500 dark:text-gray-400 border-b dark:border-gray-700"},[u("div",{class:"col-span-5"},"Mal Sahibi"),u("div",{class:"col-span-4"},"Sahip Olduğu Boş Katlar"),u("div",{class:"col-span-3 text-center"},"İşlemler")],-1)),(c(!0),d(p,null,x(T.value,e=>{return c(),d("div",{key:e.id,class:"grid grid-cols-12 gap-4 items-center p-4 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-200 border-b dark:border-gray-700/50"},[u("div",te,[u("div",{class:C(["flex-shrink-0 h-12 w-12 flex items-center justify-center bg-blue-500 text-white rounded-full text-xl font-bold",$(e.name)])},k((t=e.name,t?t.charAt(0).toUpperCase():"?")),3),u("div",null,[u("p",re,k(e.name),1),u("p",le,k(e.email),1)])]),u("div",se,[a[12]||(a[12]=u("span",{class:"sm:hidden font-semibold text-gray-500"},"Boş Katlar: ",-1)),e.vacantUnits.length>0?(c(),d("span",ne,k(e.vacantUnits.join(", ")),1)):h("",!0)]),u("div",oe,[u("div",ie,[a[13]||(a[13]=u("label",{tabindex:"0",class:"btn btn-ghost btn-sm m-1"},"İşlemler",-1)),u("ul",de,[u("li",null,[u("a",{onClick:a=>(e=>{y.value={...e},A.value=!0})(e)},"Düzenle",8,ce)]),u("li",null,[u("a",{onClick:a=>(e=>{B.value=e,j.value=!0})(e),class:"text-red-500"},"Sil",8,ue)])])])])]);var t}),128))]))])])]),f(I,{visible:S.value,"available-units":V.value,onSave:be,onClose:a[2]||(a[2]=e=>S.value=!1)},null,8,["visible","available-units"]),f(r,{visible:j.value,"item-name":B.value?B.value.name:"","item-type":"mal sahibini",onConfirm:D,onCancel:a[3]||(a[3]=e=>j.value=!1)},null,8,["visible","item-name"])]))}};export{be as default};
