import{r as e,w as a,c as t,b as l,f as s,g as n,h as i,t as r,p as u,e as d,F as o,i as c,n as m,j as v,l as g}from"./vue-vendor-B4bLxnmP.js";import{t as y}from"./tenantsService-B2_anAuD.js";import{p as b}from"./paymentsService-ynK3N560.js";import{u as p}from"./utilityDebtsService-Bz_V1koj.js";import{u as x}from"./index-ErXur627.js";import{u as h}from"./useErrorHandler-DB_Jk_TF.js";const f={key:0,class:"flex justify-center items-center h-96"},k={key:1,class:"text-center p-12"},D={key:2,class:"p-4 sm:p-6 space-y-6"},T={class:"card bg-base-100 shadow-xl"},A={class:"card-body"},w={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},B={class:"flex items-center gap-4"},P={class:"avatar placeholder"},N={class:"bg-primary text-primary-content rounded-full w-16"},E={class:"text-2xl"},S={class:"text-3xl font-bold"},K={class:"text-base-content/70"},j={class:"flex items-center gap-4"},C={class:"text-right"},I={class:"tabs tabs-boxed"},G={class:"card bg-base-100 shadow-xl min-h-[300px]"},L={class:"card-body"},$={key:0},_={class:"overflow-x-auto"},z={class:"table w-full"},F={class:"text-right font-semibold"},R={key:0},Y={key:1},U={class:"overflow-x-auto"},V={class:"table w-full"},W={class:"text-right font-semibold text-success"},H={key:0},q={key:2},J={class:"overflow-x-auto"},M={class:"table w-full"},O={class:"text-right font-semibold"},Q={key:0},X={key:3,class:"space-y-4"},Z={class:"card bg-base-200 p-4"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4"},ae={class:"card bg-base-200 p-4"},te={class:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4"},le=["href"],se={key:0},ne=["href"],ie={class:"card bg-base-200 p-4"},re={key:0},ue={key:1,class:"text-base-content/60"},de={class:"card bg-base-200 p-4"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4"},ce={class:"card bg-base-200 p-4"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4"},ve={key:0},ge={key:1},ye={key:2},be={__name:"TenantDetailPage",setup(be){const pe=v(),xe=x(),{handleNetworkError:he}=h(),fe=e(null),ke=e(null),De=e([]),Te=e([]),Ae=e([]),we=e(!0),Be=e("debts"),Pe=e(0),Ne=e=>null==e||isNaN(e)?"â‚º0,00":Number(e).toLocaleString("tr-TR",{style:"currency",currency:"TRY"}),Ee=e=>{if(!e)return"-";return(e.toDate?e.toDate():new Date(e)).toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric"})},Se=e=>e.isPaid?"badge-success":e.dueDate&&new Date(e.dueDate)<new Date?"badge-error":"badge-warning",Ke=e=>e.isPaid?"Ã–dendi":e.dueDate&&new Date(e.dueDate)<new Date?"Ã–denmedi":"Ã–denmemiÅŸ",je=e=>"Individual"===e.companyType?"TC Kimlik NumarasÄ±":"Corporate"===e.companyType?"Vergi NumarasÄ±":"Kimlik/Vergi NumarasÄ±",Ce=e=>e.identityNumber||e.taxNumber||"BelirtilmemiÅŸ";return a(()=>[xe.user,pe.params.id],([e,a])=>{"Profile"===pe.name?"tenant"===(null==e?void 0:e.role)&&e.tenantId&&(fe.value=e.tenantId):fe.value=a},{immediate:!0,deep:!0}),a(fe,(e,a)=>{e&&e!==a&&(async()=>{if(fe.value){we.value=!0;try{const e=await y.getTenantById(fe.value);if(!e)return ke.value=null,void(we.value=!1);ke.value=e;const[a,t]=await Promise.all([b.getPayments({tenantId:fe.value}),p.getUtilityDebts({tenantId:fe.value})]),l=[];t.forEach(e=>l.push({...e,type:e.type,description:`${"Electricity"===e.type?"Elektrik":"Water"===e.type?"Su":"BorÃ§"} (${e.period||e.dueDate?new Date(e.dueDate).toLocaleDateString("tr-TR"):"DÃ¶nem BelirtilmemiÅŸ"})`,amount:e.amount||0,toplamTutar:e.amount||0,remainingAmount:e.remainingAmount||e.amount||0,isPaid:"Paid"===e.status})),Ae.value=l.sort((e,a)=>(a.date||0)-(e.date||0)),De.value=t.filter(e=>{const a=Number(e.remainingAmount||e.amount||0);return"Paid"!==e.status&&a>0}).map(e=>{var a;return{...e,amount:Number(e.remainingAmount||e.amount||0),typeLabel:"Electricity"===e.type?"Elektrik":"Water"===e.type?"Su":"BorÃ§",company:(null==(a=ke.value)?void 0:a.companyName)||"Bilinmeyen",floor:e.unit||"-"}}).sort((e,a)=>(e.dueDate||0)-(a.dueDate||0)),Te.value=a.sort((e,a)=>(a.paymentDate||0)-(e.paymentDate||0));let s=De.value.reduce((e,a)=>e+Number(a.amount||0),0);Pe.value=s}catch(e){he(e,{component:"TenantDetailPage",action:"fetchTenantDetails"})}finally{we.value=!1}}else we.value=!1})()},{immediate:!0}),(e,a)=>{var v;const y=i("router-link");return we.value?(g(),t("div",f,a[4]||(a[4]=[l("span",{class:"loading loading-spinner loading-lg"},null,-1)]))):ke.value?(g(),t("div",D,[l("div",T,[l("div",A,[l("div",w,[l("div",B,[l("div",P,[l("div",N,[l("span",E,r((p=ke.value.companyName,p?p.charAt(0).toUpperCase():"?")),1)])]),l("div",null,[l("h1",S,r(ke.value.companyName),1),l("p",K,r(ke.value.businessType)+" - "+r((null==(v=ke.value.flats)?void 0:v.map(e=>e.unitNumber).join(", "))||"Ãœnite bilgisi yok"),1)])]),l("div",j,[l("div",C,[a[8]||(a[8]=l("div",{class:"text-sm text-base-content/70"},"GÃ¼ncel Bakiye",-1)),l("div",{class:u(["text-2xl font-bold",Pe.value>0?"text-error":"text-success"])},r(Ne(Pe.value)),3)]),l("span",{class:u(["badge badge-lg font-semibold",ke.value.isActive?"badge-success":"badge-ghost"])},r(ke.value.isActive?"Aktif":"Pasif"),3)])])])]),l("div",I,[l("a",{class:u(["tab",{"tab-active":"debts"===Be.value}]),onClick:a[0]||(a[0]=e=>Be.value="debts")},"Ã–denmemiÅŸ BorÃ§lar",2),l("a",{class:u(["tab",{"tab-active":"payments"===Be.value}]),onClick:a[1]||(a[1]=e=>Be.value="payments")},"YapÄ±lan Ã–demeler",2),l("a",{class:u(["tab",{"tab-active":"history"===Be.value}]),onClick:a[2]||(a[2]=e=>Be.value="history")},"SayaÃ§ ve Aidat KayÄ±tlarÄ±",2),l("a",{class:u(["tab",{"tab-active":"info"===Be.value}]),onClick:a[3]||(a[3]=e=>Be.value="info")},"Ä°ÅŸ Yeri Bilgileri",2)]),l("div",G,[l("div",L,["debts"===Be.value?(g(),t("div",$,[a[11]||(a[11]=l("h3",{class:"text-xl font-bold mb-4"},"Ã–denmemiÅŸ Faturalar ve Aidatlar",-1)),l("div",_,[l("table",z,[a[10]||(a[10]=l("thead",null,[l("tr",null,[l("th",null,"AÃ§Ä±klama"),l("th",null,"Son Ã–deme Tarihi"),l("th",{class:"text-right"},"Tutar")])],-1)),l("tbody",null,[(g(!0),t(o,null,c(De.value,e=>(g(),t("tr",{key:e.id,class:"hover"},[l("td",null,r(e.description||`Aidat (${e.period||e.unit})`),1),l("td",null,r(Ee(e.dueDate)),1),l("td",F,r(Ne(e.amount||e.toplamTutar)),1)]))),128)),0===De.value.length?(g(),t("tr",R,a[9]||(a[9]=[l("td",{colspan:"3",class:"text-center py-8 text-base-content/60"},"Ã–denmemiÅŸ borÃ§ bulunmamaktadÄ±r.",-1)]))):d("",!0)])])])])):d("",!0),"payments"===Be.value?(g(),t("div",Y,[a[14]||(a[14]=l("h3",{class:"text-xl font-bold mb-4"},"Ã–deme GeÃ§miÅŸi",-1)),l("div",U,[l("table",V,[a[13]||(a[13]=l("thead",null,[l("tr",null,[l("th",null,"Ã–deme Tarihi"),l("th",null,"AÃ§Ä±klama"),l("th",{class:"text-right"},"Tutar")])],-1)),l("tbody",null,[(g(!0),t(o,null,c(Te.value,e=>(g(),t("tr",{key:e.id,class:"hover"},[l("td",null,r(Ee(e.paymentDate)),1),l("td",null,r(e.description),1),l("td",W,r(Ne(e.amount)),1)]))),128)),0===Te.value.length?(g(),t("tr",H,a[12]||(a[12]=[l("td",{colspan:"3",class:"text-center py-8 text-base-content/60"},"KayÄ±tlÄ± Ã¶deme bulunmamaktadÄ±r.",-1)]))):d("",!0)])])])])):d("",!0),"history"===Be.value?(g(),t("div",q,[a[17]||(a[17]=l("h3",{class:"text-xl font-bold mb-4"},"GeÃ§miÅŸ KayÄ±tlar",-1)),l("div",J,[l("table",M,[a[16]||(a[16]=l("thead",null,[l("tr",null,[l("th",null,"Tarih"),l("th",null,"TÃ¼r"),l("th",null,"AÃ§Ä±klama"),l("th",null,"Ä°lk Endeks"),l("th",null,"Son Endeks"),l("th",null,"TÃ¼ketim"),l("th",{class:"text-right"},"Tutar"),l("th",null,"Durum")])],-1)),l("tbody",null,[(g(!0),t(o,null,c(Ae.value,e=>(g(),t("tr",{key:e.id,class:"hover"},[l("td",null,r(Ee(e.date)),1),l("td",null,[l("span",{class:u(["badge","water"===e.type?"badge-info":"electricity"===e.type?"badge-warning":"badge-neutral"])},r("water"===e.type?"Su":"electricity"===e.type?"Elektrik":"Aidat"),3)]),l("td",null,r(e.description),1),l("td",null,r(e.ilkEndeks||"-"),1),l("td",null,r(e.sonEndeks||"-"),1),l("td",null,r(e.tuketim||"-"),1),l("td",O,r(Ne(e.amount)),1),l("td",null,[l("span",{class:u(["badge",Se(e)])},r(Ke(e)),3)])]))),128)),0===Ae.value.length?(g(),t("tr",Q,a[15]||(a[15]=[l("td",{colspan:"8",class:"text-center py-8 text-base-content/60"},"KayÄ±tlÄ± sayaÃ§ veya aidat bulunmamaktadÄ±r.",-1)]))):d("",!0)])])])])):d("",!0),"info"===Be.value?(g(),t("div",X,[a[41]||(a[41]=l("h3",{class:"text-xl font-bold"},"DetaylÄ± Bilgiler",-1)),l("div",Z,[a[21]||(a[21]=l("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ğŸ¢ Ä°ÅŸ Yeri Bilgileri",-1)),l("div",ee,[l("div",null,[a[18]||(a[18]=l("strong",null,"Åirket AdÄ±:",-1)),m(" "+r(ke.value.companyName),1)]),l("div",null,[a[19]||(a[19]=l("strong",null,"Firma TÃ¼rÃ¼:",-1)),m(" "+r((b=ke.value,"Individual"===b.companyType?"ÅahÄ±s FirmasÄ±":"Corporate"===b.companyType?"TÃ¼zel KiÅŸi":"BelirtilmemiÅŸ")),1)]),l("div",null,[a[20]||(a[20]=l("strong",null,"Ä°ÅŸ TÃ¼rÃ¼:",-1)),m(" "+r(ke.value.businessType),1)]),l("div",null,[l("strong",null,r(je(ke.value))+":",1),m(" "+r(Ce(ke.value)),1)])])]),l("div",ae,[a[27]||(a[27]=l("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ğŸ‘¤ Ä°letiÅŸim KiÅŸisi Bilgileri",-1)),l("div",te,[l("div",null,[a[22]||(a[22]=l("strong",null,"Ä°letiÅŸim KiÅŸisi:",-1)),m(" "+r(ke.value.contactPersonName),1)]),l("div",null,[a[23]||(a[23]=l("strong",null,"Telefon:",-1)),a[24]||(a[24]=m()),l("a",{href:`tel:${ke.value.contactPersonPhone}`,class:"link link-primary"},r(ke.value.contactPersonPhone),9,le)]),ke.value.contactPersonEmail?(g(),t("div",se,[a[25]||(a[25]=l("strong",null,"E-posta:",-1)),a[26]||(a[26]=m()),l("a",{href:`mailto:${ke.value.contactPersonEmail}`,class:"link link-primary"},r(ke.value.contactPersonEmail),9,ne)])):d("",!0)])]),l("div",ie,[a[31]||(a[31]=l("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ğŸ“ Ãœnite Bilgileri",-1)),ke.value.flats&&ke.value.flats.length>0?(g(),t("div",re,[(g(!0),t(o,null,c(ke.value.flats,e=>(g(),t("div",{key:e.id,class:"grid grid-cols-1 md:grid-cols-3 gap-x-8 gap-y-4 mb-4 p-3 bg-base-100 rounded-lg"},[l("div",null,[a[28]||(a[28]=l("strong",null,"Ãœnite:",-1)),m(" "+r(e.unitNumber),1)]),l("div",null,[a[29]||(a[29]=l("strong",null,"Kat:",-1)),m(" "+r(e.floor)+". Kat",1)]),l("div",null,[a[30]||(a[30]=l("strong",null,"Alan:",-1)),m(" "+r(e.unitArea)+"mÂ²",1)])]))),128))])):(g(),t("div",ue,"Ãœnite bilgisi bulunmamaktadÄ±r."))]),l("div",de,[a[33]||(a[33]=l("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ğŸ’° Aidat Bilgileri",-1)),l("div",oe,[l("div",null,[a[32]||(a[32]=l("strong",null,"AylÄ±k Aidat:",-1)),m(" "+r(Ne(ke.value.monthlyAidat)),1)])])]),l("div",ce,[a[40]||(a[40]=l("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ğŸ“‹ SÃ¶zleÅŸme Bilgileri",-1)),l("div",me,[ke.value.contractStartDate?(g(),t("div",ve,[a[34]||(a[34]=l("strong",null,"SÃ¶zleÅŸme BaÅŸlangÄ±cÄ±:",-1)),m(" "+r(Ee(ke.value.contractStartDate)),1)])):d("",!0),ke.value.contractEndDate?(g(),t("div",ge,[a[35]||(a[35]=l("strong",null,"SÃ¶zleÅŸme BitiÅŸi:",-1)),m(" "+r(Ee(ke.value.contractEndDate)),1)])):d("",!0),l("div",null,[a[36]||(a[36]=l("strong",null,"Durum:",-1)),a[37]||(a[37]=m()),l("span",{class:u(["badge",ke.value.isActive?"badge-success":"badge-ghost"])},r(ke.value.isActive?"Aktif":"Pasif"),3)]),l("div",null,[a[38]||(a[38]=l("strong",null,"KayÄ±t Tarihi:",-1)),m(" "+r(Ee(ke.value.createdAt)),1)]),ke.value.updatedAt?(g(),t("div",ye,[a[39]||(a[39]=l("strong",null,"Son GÃ¼ncelleme:",-1)),m(" "+r(Ee(ke.value.updatedAt)),1)])):d("",!0)])])])):d("",!0)])])])):(g(),t("div",k,[a[6]||(a[6]=l("h2",{class:"text-2xl font-bold text-error"},"KiracÄ± BulunamadÄ±",-1)),a[7]||(a[7]=l("p",{class:"text-base-content/70 mt-2"},"Bu ID'ye sahip bir kiracÄ± bulunamadÄ± veya veritabanÄ±ndan silinmiÅŸ olabilir.",-1)),s(y,{to:"/tenants",class:"btn btn-primary mt-6"},{default:n(()=>a[5]||(a[5]=[m("KiracÄ± Listesine Geri DÃ¶n")])),_:1,__:[5]})]));var b,p}}};export{be as default};
