import{G as e,c as a,l as t,e as l,b as s,D as r,H as n,F as o,i,I as d,p as c,t as u,q as b,r as v,w as g,n as p,C as m,o as y,s as f,f as k,u as x,k as h}from"./vue-vendor-BE3w9SvD.js";import{t as w}from"./tenantsService-DcFCN9jj.js";import{U as C}from"./units-DJG6lNYB.js";import{_ as A}from"./ConfirmDeleteModal-B9VWRTw-.js";import{_ as T}from"./FilterBar-wXoQM61V.js";import{u as N}from"./useNotification-Dv4wKXE4.js";import"./index-CAkTsZV-.js";import{u as M}from"./useEventBus-CFAD6Pmz.js";const K=["open"],U={key:0,class:"modal-box max-w-2xl"},j={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},S={class:"md:col-span-2"},V={class:"md:col-span-2"},B={class:"flex flex-wrap gap-3"},q=["value","disabled"],D={class:"md:col-span-2 flex items-center gap-2"},z={class:"modal-action mt-6"},L={__name:"TenantEditModal",props:{tenant:Object,unitOptions:Array,visible:Boolean,allTenants:Array},emits:["save","close"],setup(v,{emit:g}){const p=v,m=e=>p.allTenants.some(a=>{var t;return a.id!==p.tenant.id&&a.isActive&&(null==(t=a.units)?void 0:t.includes(e))}),y=g,f=()=>{y("save")};return(g,p)=>{const y=e("mask");return t(),a("dialog",{id:"editTenantModal",class:"modal",open:v.visible},[v.tenant?(t(),a("div",U,[p[16]||(p[16]=s("h3",{class:"font-bold text-lg mb-4"},"KiracÄ± Bilgilerini GÃ¼ncelle",-1)),s("form",{onSubmit:b(f,["prevent"])},[s("div",j,[s("div",null,[p[8]||(p[8]=s("label",{class:"label font-semibold"},"Ad",-1)),r(s("input",{"onUpdate:modelValue":p[0]||(p[0]=e=>v.tenant.firstName=e),class:"input input-bordered w-full",required:""},null,512),[[n,v.tenant.firstName]])]),s("div",null,[p[9]||(p[9]=s("label",{class:"label font-semibold"},"Soyad",-1)),r(s("input",{"onUpdate:modelValue":p[1]||(p[1]=e=>v.tenant.lastName=e),class:"input input-bordered w-full",required:""},null,512),[[n,v.tenant.lastName]])]),s("div",null,[p[10]||(p[10]=s("label",{class:"label font-semibold"},"Telefon",-1)),r(s("input",{"onUpdate:modelValue":p[2]||(p[2]=e=>v.tenant.phone=e),class:"input input-bordered w-full",required:""},null,512),[[y,"+90 (###) ### ## ##"],[n,v.tenant.phone]])]),s("div",null,[p[11]||(p[11]=s("label",{class:"label font-semibold"},"E-posta",-1)),r(s("input",{type:"email","onUpdate:modelValue":p[3]||(p[3]=e=>v.tenant.email=e),class:"input input-bordered w-full"},null,512),[[n,v.tenant.email]])]),s("div",S,[p[12]||(p[12]=s("label",{class:"label font-semibold"},"Åžirket UnvanÄ±",-1)),r(s("input",{"onUpdate:modelValue":p[4]||(p[4]=e=>v.tenant.company=e),class:"input input-bordered w-full",required:""},null,512),[[n,v.tenant.company]])]),s("div",V,[p[13]||(p[13]=s("label",{class:"label font-semibold"},"Katlar",-1)),s("div",B,[(t(!0),a(o,null,i(v.unitOptions,e=>(t(),a("label",{key:e,class:"flex items-center gap-2"},[r(s("input",{type:"checkbox",value:e,"onUpdate:modelValue":p[5]||(p[5]=e=>v.tenant.units=e),disabled:m(e)},null,8,q),[[d,v.tenant.units]]),s("span",{class:c(m(e)?"text-gray-400 line-through":"")},u(e),3)]))),128))])]),s("div",D,[r(s("input",{type:"checkbox","onUpdate:modelValue":p[6]||(p[6]=e=>v.tenant.isActive=e),class:"toggle toggle-success"},null,512),[[d,v.tenant.isActive]]),p[14]||(p[14]=s("label",{class:"label font-semibold"},"Aktif",-1))])]),s("div",z,[p[15]||(p[15]=s("button",{type:"submit",class:"btn btn-success"},"Kaydet",-1)),s("button",{type:"button",onClick:p[7]||(p[7]=e=>g.$emit("close")),class:"btn btn-ghost"},"Kapat")])],32)])):l("",!0)],8,K)}}},E=["open"],_={class:"modal-box max-w-2xl bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border border-gray-200 dark:border-gray-700 shadow-2xl"},$={class:"flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700 mb-6"},O={class:"overflow-y-auto max-h-[70vh] pr-2"},P={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},F={class:"form-control"},G={class:"form-control"},H={class:"form-control"},R={class:"form-control"},Y={class:"form-control md:col-span-2"},I={class:"form-control md:col-span-2"},J={class:"p-4 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 max-h-48 overflow-y-auto"},Q={class:"grid grid-cols-3 sm:grid-cols-4 gap-3"},W=["value","disabled"],X={class:"form-control md:col-span-2"},Z={class:"form-control md:col-span-2"},ee={class:"label cursor-pointer"},ae={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700 mt-6"},te={__name:"TenantCreateModal",props:{visible:Boolean,unitOptions:Array,allTenants:Array},emits:["save","close"],setup(l,{emit:m}){const y=l,f=m,k=()=>({firstName:"",lastName:"",phone:"",email:"",company:"",units:[],entryDate:(new Date).toISOString().slice(0,10),isActive:!0}),x=v(k());g(()=>y.visible,e=>{e&&(x.value=k())});const h=e=>y.allTenants.some(a=>{var t;return a.isActive&&(null==(t=a.units)?void 0:t.includes(e))}),w=()=>{f("save",x.value),x.value=k()};return(v,g)=>{const m=e("mask");return t(),a("dialog",{id:"createTenantModal",class:"modal",open:l.visible},[s("div",_,[s("div",$,[g[11]||(g[11]=s("h3",{class:"text-xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2"},[s("span",{class:"text-2xl"},"ðŸ‘¤"),p(" Yeni KiracÄ± Ekle ")],-1)),s("button",{onClick:g[0]||(g[0]=e=>v.$emit("close")),class:"btn btn-sm btn-ghost text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},g[10]||(g[10]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),s("div",O,[s("form",{onSubmit:b(w,["prevent"]),id:"tenantForm",class:"space-y-6"},[s("div",P,[s("div",F,[g[12]||(g[12]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Ad")],-1)),r(s("input",{"onUpdate:modelValue":g[1]||(g[1]=e=>x.value.firstName=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},null,512),[[n,x.value.firstName]])]),s("div",G,[g[13]||(g[13]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Soyad")],-1)),r(s("input",{"onUpdate:modelValue":g[2]||(g[2]=e=>x.value.lastName=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},null,512),[[n,x.value.lastName]])]),s("div",H,[g[14]||(g[14]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Telefon")],-1)),r(s("input",{"onUpdate:modelValue":g[3]||(g[3]=e=>x.value.phone=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},null,512),[[m,"+90 (###) ### ## ##"],[n,x.value.phone]])]),s("div",R,[g[15]||(g[15]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"E-posta")],-1)),r(s("input",{type:"email","onUpdate:modelValue":g[4]||(g[4]=e=>x.value.email=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400"},null,512),[[n,x.value.email]])]),s("div",Y,[g[16]||(g[16]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Åžirket UnvanÄ±")],-1)),r(s("input",{"onUpdate:modelValue":g[5]||(g[5]=e=>x.value.company=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},null,512),[[n,x.value.company]])]),s("div",I,[g[17]||(g[17]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Katlar")],-1)),s("div",J,[s("div",Q,[(t(!0),a(o,null,i(l.unitOptions,e=>(t(),a("label",{key:e,class:"flex items-center gap-2 p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors cursor-pointer"},[r(s("input",{type:"checkbox",value:e,"onUpdate:modelValue":g[6]||(g[6]=e=>x.value.units=e),disabled:h(e),class:"checkbox checkbox-primary"},null,8,W),[[d,x.value.units]]),s("span",{class:c(h(e)?"text-gray-400 line-through":"text-gray-700 dark:text-gray-300")},u(e),3)]))),128))])])]),s("div",X,[g[18]||(g[18]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"GiriÅŸ Tarihi")],-1)),r(s("input",{type:"date","onUpdate:modelValue":g[7]||(g[7]=e=>x.value.entryDate=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},null,512),[[n,x.value.entryDate]])]),s("div",Z,[s("label",ee,[g[19]||(g[19]=s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Aktif",-1)),r(s("input",{type:"checkbox","onUpdate:modelValue":g[8]||(g[8]=e=>x.value.isActive=e),class:"toggle toggle-success"},null,512),[[d,x.value.isActive]])])])])],32)]),s("div",ae,[s("button",{type:"button",onClick:g[9]||(g[9]=e=>v.$emit("close")),class:"btn btn-outline border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"},g[20]||(g[20]=[s("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),p(" Ä°ptal ")])),g[21]||(g[21]=s("button",{form:"tenantForm",type:"submit",class:"btn btn-success bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 border-0 text-white shadow-lg"},[s("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),p(" Kaydet ")],-1))])])],8,E)}}},le={class:"p-4 sm:p-6 bg-base-200 min-h-screen"},se={class:"max-w-7xl mx-auto"},re={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},ne={class:"stat bg-base-100 shadow-lg rounded-box"},oe={class:"stat-value text-primary"},ie={class:"stat bg-base-100 shadow-lg rounded-box"},de={class:"stat-value text-success"},ce={class:"stat bg-base-100 shadow-lg rounded-box"},ue={class:"stat-value text-warning"},be={class:"card bg-base-100 shadow-xl mb-6"},ve={class:"card-body"},ge={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},pe={class:"card-body"},me={class:"flex items-start justify-between"},ye={class:"flex items-center gap-4"},fe={class:"avatar placeholder"},ke={class:"text-xl font-bold"},xe={class:"card-title text-base-content"},he={class:"text-sm text-base-content/70"},we={class:"dropdown dropdown-end"},Ce={tabindex:"0",class:"dropdown-content menu p-2 shadow bg-base-200 rounded-box w-40 z-10"},Ae=["onClick"],Te=["onClick"],Ne={key:0},Me=["onClick"],Ke={key:1},Ue=["onClick"],je=["onClick"],Se={class:"flex justify-between items-center text-sm"},Ve={class:"text-right"},Be={class:"text-lg font-bold text-success"},qe={key:1,class:"text-center py-16"},De={__name:"Tenants",setup(e){const l=h(),{showCreateSuccess:r,showUpdateSuccess:n,showDeleteSuccess:d}=N(),{on:b,off:g}=M(),K=v([]),U=v(null),j=v(null),S=v(!1),V=v(!1),B=v(!1),q=v(null),D=v("all"),z=v(""),E=v(!1),_=async()=>{try{E.value=!0;const e={};z.value&&(e.searchTerm=z.value),"active"===D.value?e.isActive=!0:"passive"===D.value&&(e.isActive=!1);const[a,t]=await Promise.all([w.getTenants(e),w.getTenantStats()]);K.value=a,U.value=t}catch(e){alert("KiracÄ±lar yÃ¼klenirken bir hata oluÅŸtu")}finally{E.value=!1}},$=m(()=>{let e=K.value;if("active"===D.value?e=e.filter(e=>e.isActive):"passive"===D.value&&(e=e.filter(e=>!e.isActive)),z.value){const a=z.value.toLowerCase();e=e.filter(e=>`${e.firstName} ${e.lastName}`.toLowerCase().includes(a)||(e.apartmentNumber||"").toLowerCase().includes(a)||(e.email||"").toLowerCase().includes(a))}return e.sort((e,a)=>e.firstName.localeCompare(a.firstName))}),O=e=>{if(!e)return"bg-gray-500";const a=["bg-primary","bg-secondary","bg-accent","bg-info","bg-success","bg-warning","bg-error"];return a[e.split("").reduce((e,a)=>e+a.charCodeAt(0),0)%a.length]},P=()=>{z.value="",D.value="all",_()},F=async e=>{try{await w.updateTenant(e.id,e),S.value=!1,await _(),n("KiracÄ±")}catch(a){alert("KiracÄ± gÃ¼ncellenirken bir hata oluÅŸtu")}},G=async e=>{try{await w.createTenant(e),V.value=!1,await _(),r("KiracÄ±")}catch(a){alert("KiracÄ± oluÅŸturulurken bir hata oluÅŸtu")}},H=async()=>{try{await w.deleteTenant(q.value.id),B.value=!1,await _(),d("KiracÄ±")}catch(e){alert("KiracÄ± silinirken bir hata oluÅŸtu")}};y(()=>{_(),b("payment:created",R)}),f(()=>{g("payment:created",R)});const R=async e=>{try{await _()}catch(a){}};return(e,r)=>{var n,d,b;return t(),a("div",le,[s("div",se,[r[17]||(r[17]=s("h1",{class:"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-6"},"KiracÄ±lar",-1)),s("section",re,[s("div",ne,[r[6]||(r[6]=s("div",{class:"stat-figure text-primary"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),r[7]||(r[7]=s("div",{class:"stat-title"},"Toplam KiracÄ±",-1)),s("div",oe,u((null==(n=U.value)?void 0:n.totalCount)||0),1)]),s("div",ie,[r[8]||(r[8]=s("div",{class:"stat-figure text-success"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),r[9]||(r[9]=s("div",{class:"stat-title"},"Aktif KiracÄ±",-1)),s("div",de,u((null==(d=U.value)?void 0:d.activeCount)||0),1)]),s("div",ce,[r[10]||(r[10]=s("div",{class:"stat-figure text-warning"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})])],-1)),r[11]||(r[11]=s("div",{class:"stat-title"},"Pasif KiracÄ±",-1)),s("div",ue,u((null==(b=U.value)?void 0:b.passiveCount)||0),1)]),s("button",{class:"btn btn-primary btn-lg h-full",onClick:r[0]||(r[0]=e=>V.value=!0)},r[12]||(r[12]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),p(" Yeni KiracÄ± Ekle ")]))]),s("div",be,[s("div",ve,[k(T,{search:z.value,"onUpdate:search":r[1]||(r[1]=e=>z.value=e),status:D.value,"onUpdate:status":r[2]||(r[2]=e=>D.value=e),"search-placeholder":"Åžirket, kiÅŸi veya daire ara...","status-options":[{value:"all",label:"TÃ¼mÃ¼"},{value:"active",label:"Aktif"},{value:"passive",label:"Pasif"}],onClearFilters:P},null,8,["search","status"])])]),$.value.length>0?(t(),a("div",ge,[(t(!0),a(o,null,i($.value,e=>{return t(),a("div",{key:e.id,class:"card bg-base-100 shadow-lg hover:shadow-2xl transition-shadow duration-300 transform hover:-translate-y-1"},[s("div",pe,[s("div",me,[s("div",ye,[s("div",fe,[s("div",{class:c([O(e.firstName),"bg-neutral-focus text-neutral-content rounded-full w-14"])},[s("span",ke,u((o=e.firstName,o?o.charAt(0).toUpperCase():"?")),1)],2)]),s("div",null,[s("h2",xe,u(`${e.firstName} ${e.lastName}`),1),s("p",he," Daire: "+u(e.apartmentNumber),1)])]),s("div",we,[r[13]||(r[13]=s("label",{tabindex:"0",class:"btn btn-ghost btn-sm btn-circle"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})])],-1)),s("ul",Ce,[s("li",null,[s("a",{onClick:a=>{return t=e.id,void l.push({name:"TenantDetailPage",params:{id:t}});var t}},"DetaylarÄ± GÃ¶r",8,Ae)]),s("li",null,[s("a",{onClick:a=>(e=>{j.value={...e},S.value=!0})(e)},"DÃ¼zenle",8,Te)]),e.isActive?(t(),a("li",Ke,[s("a",{onClick:a=>(async e=>{try{await w.updateTenant(e,{isActive:!1}),await _()}catch(a){alert("KiracÄ± pasif edilirken bir hata oluÅŸtu")}})(e.id)},"Pasif Et",8,Ue)])):(t(),a("li",Ne,[s("a",{onClick:a=>(async e=>{try{await w.updateTenant(e,{isActive:!0}),await _()}catch(a){alert("KiracÄ± aktif edilirken bir hata oluÅŸtu")}})(e.id)},"Aktif Et",8,Me)])),s("li",null,[s("a",{onClick:a=>(e=>{q.value=e,B.value=!0})(e),class:"text-error"},"Sil",8,je)])])])]),r[15]||(r[15]=s("div",{class:"divider my-3"},null,-1)),s("div",Se,[s("span",{class:c(["badge font-semibold",e.isActive?"badge-success":"badge-ghost"])},u(e.isActive?"Aktif":"Pasif"),3),s("div",Ve,[r[14]||(r[14]=s("div",{class:"font-semibold text-base-content/80"},"AylÄ±k Kira",-1)),s("div",Be,u((n=e.monthlyRent,null==n||isNaN(n)?"â‚º0,00":Number(n).toLocaleString("tr-TR",{style:"currency",currency:"TRY"}))),1)])])])]);var n,o}),128))])):(t(),a("div",qe,r[16]||(r[16]=[s("p",{class:"text-xl text-base-content/60"},"AramanÄ±zla eÅŸleÅŸen kiracÄ± bulunamadÄ±.",-1)])))]),k(L,{tenant:j.value,visible:S.value,"unit-options":x(C),"all-tenants":K.value,onSave:F,onClose:r[3]||(r[3]=e=>S.value=!1)},null,8,["tenant","visible","unit-options","all-tenants"]),k(te,{visible:V.value,"unit-options":x(C),"all-tenants":K.value,onSave:G,onClose:r[4]||(r[4]=e=>V.value=!1)},null,8,["visible","unit-options","all-tenants"]),k(A,{visible:B.value,tenant:q.value,onConfirm:H,onCancel:r[5]||(r[5]=e=>B.value=!1)},null,8,["visible","tenant"])])}}};export{De as default};
