import{r as e,c as a,o as l,b as t,e as r,t as s,G as d,H as u,I as n,F as i,i as o,j as c,m as v,q as p}from"./vue-vendor-Bart4FG5.js";import{a as b}from"./index-BbOmoSe-.js";import"./utils-vendor-Cy2sLATb.js";const g={class:"p-4 sm:p-6 bg-gray-50 min-h-screen font-sans dark:bg-gray-900"},m={class:"max-w-7xl mx-auto"},y={class:"flex items-center justify-between mb-6"},x={class:"flex items-center gap-4"},k={class:"bg-purple-100 dark:bg-purple-900/50 text-purple-600 dark:text-purple-400 px-3 py-1 rounded-full text-sm"},w={class:"bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 px-3 py-1 rounded-full text-sm"},f={class:"bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-400 px-3 py-1 rounded-full text-sm"},h={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200 dark:border-gray-700 mb-6"},D={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},N=["value"],O=["value"],T={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md border border-gray-200 dark:border-gray-700 overflow-hidden"},C={class:"overflow-x-auto"},M={class:"table w-full"},A={class:"p-4"},j={class:"font-medium text-gray-800 dark:text-gray-100"},S={class:"text-sm text-gray-500 dark:text-gray-400"},L={class:"p-4 text-gray-800 dark:text-gray-100"},V={class:"p-4 text-gray-800 dark:text-gray-100"},B={class:"p-4"},E={class:"font-semibold text-gray-800 dark:text-gray-100"},G={class:"p-4 text-gray-800 dark:text-gray-100"},U={class:"p-4"},z={class:"p-4"},H={class:"flex items-center gap-2"},R=["onClick"],I=["onClick"],K={key:0,class:"text-center py-12"},Y={__name:"OwnerDues",setup(Y){const _=e([]),q=e([]),F=e(""),$=e(""),J=e(""),P=e(""),Q=e(!1),W=[{value:"01",label:"Ocak"},{value:"02",label:"Şubat"},{value:"03",label:"Mart"},{value:"04",label:"Nisan"},{value:"05",label:"Mayıs"},{value:"06",label:"Haziran"},{value:"07",label:"Temmuz"},{value:"08",label:"Ağustos"},{value:"09",label:"Eylül"},{value:"10",label:"Ekim"},{value:"11",label:"Kasım"},{value:"12",label:"Aralık"}],X=e=>null==e||isNaN(e)?"₺0.00":Number(e).toLocaleString("tr-TR",{style:"currency",currency:"TRY"}),Z=async()=>{Q.value=!0;try{const e=await b.get("/owner-dues");_.value=(e||[]).map(e=>{const a=q.value.find(a=>a.id===e.ownerId),l=new Date(e.dueDate)<new Date&&"paid"===!e.status;return{...e,ownerName:(null==a?void 0:a.name)||"Bilinmiyor",ownerEmail:(null==a?void 0:a.email)||"",isOverdue:l}})}catch(e){_.value=[]}finally{Q.value=!1}},ee=a(()=>{const e=new Set(_.value.map(e=>{var a;return null==(a=e.period)?void 0:a.slice(0,4)}));return Array.from(e).filter(Boolean).sort((e,a)=>a-e)}),ae=a(()=>{let e=_.value;if(F.value){const a=F.value.toLowerCase();e=e.filter(e=>e.ownerName.toLowerCase().includes(a)||e.unit.toLowerCase().includes(a))}return $.value&&("paid"===$.value?e=e.filter(e=>"paid"===e.status):"unpaid"===$.value?e=e.filter(e=>"paid"!==e.status&&!e.isOverdue):"overdue"===$.value&&(e=e.filter(e=>e.isOverdue))),J.value&&(e=e.filter(e=>{var a;return(null==(a=e.period)?void 0:a.slice(0,4))===J.value})),P.value&&(e=e.filter(e=>{var a;return(null==(a=e.period)?void 0:a.slice(5,7))===P.value})),e.sort((e,a)=>new Date(a.dueDate)-new Date(e.dueDate))}),le=a(()=>_.value.reduce((e,a)=>e+Number(a.amount||0),0)),te=a(()=>_.value.filter(e=>"paid"===e.status)),re=a(()=>_.value.filter(e=>e.isOverdue).reduce((e,a)=>e+Number(a.amount||0),0)),se=e=>"paid"===e.status?"Ödendi":e.isOverdue?"Geciken":"Bekliyor";return l(()=>{(async()=>{try{const e=await b.get("/owners");q.value=e||[]}catch(e){q.value=[]}})().then(()=>Z())}),(e,a)=>(v(),t("div",g,[r("div",m,[r("div",y,[a[4]||(a[4]=r("h1",{class:"text-3xl font-bold text-gray-800 dark:text-gray-100"},"Mal Sahibi Aidatları",-1)),r("div",x,[r("div",k," Toplam: "+s(X(le.value)),1),r("div",w," Ödenen: "+s(X(te.value)),1),r("div",f," Geciken: "+s(X(re.value)),1)])]),r("div",h,[r("div",D,[r("div",null,[a[5]||(a[5]=r("label",{class:"label"},"Arama",-1)),d(r("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>F.value=e),type:"text",placeholder:"Mal sahibi adı veya kat ara...",class:"input input-bordered w-full"},null,512),[[u,F.value]])]),r("div",null,[a[7]||(a[7]=r("label",{class:"label"},"Durum",-1)),d(r("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>$.value=e),class:"select select-bordered w-full"},a[6]||(a[6]=[r("option",{value:""},"Tümü",-1),r("option",{value:"paid"},"Ödenmiş",-1),r("option",{value:"unpaid"},"Ödenmemiş",-1),r("option",{value:"overdue"},"Geciken",-1)]),512),[[n,$.value]])]),r("div",null,[a[9]||(a[9]=r("label",{class:"label"},"Yıl",-1)),d(r("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>J.value=e),class:"select select-bordered w-full"},[a[8]||(a[8]=r("option",{value:""},"Tümü",-1)),(v(!0),t(i,null,o(ee.value,e=>(v(),t("option",{key:e,value:e},s(e),9,N))),128))],512),[[n,J.value]])]),r("div",null,[a[11]||(a[11]=r("label",{class:"label"},"Ay",-1)),d(r("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>P.value=e),class:"select select-bordered w-full"},[a[10]||(a[10]=r("option",{value:""},"Tümü",-1)),(v(),t(i,null,o(W,e=>r("option",{key:e.value,value:e.value},s(e.label),9,O)),64))],512),[[n,P.value]])])])]),r("div",T,[r("div",C,[r("table",M,[a[12]||(a[12]=r("thead",{class:"bg-gray-50 dark:bg-gray-700"},[r("tr",null,[r("th",{class:"text-left p-4"},"Mal Sahibi"),r("th",{class:"text-left p-4"},"Kat"),r("th",{class:"text-left p-4"},"Dönem"),r("th",{class:"text-left p-4"},"Tutar"),r("th",{class:"text-left p-4"},"Son Ödeme"),r("th",{class:"text-left p-4"},"Durum"),r("th",{class:"text-left p-4"},"İşlemler")])],-1)),r("tbody",null,[(v(!0),t(i,null,o(ae.value,e=>{return v(),t("tr",{key:e.id,class:"border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50"},[r("td",A,[r("div",null,[r("p",j,s(e.ownerName),1),r("p",S,s(e.ownerEmail),1)])]),r("td",L,s(e.unit),1),r("td",V,s(e.period),1),r("td",B,[r("span",E,s(X(e.amount)),1)]),r("td",G,s((a=e.dueDate,a?new Date(a).toLocaleDateString("tr-TR",{year:"numeric",month:"short",day:"numeric"}):"-")),1),r("td",U,[r("span",{class:p([{"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-400":"paid"===e.status,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-400":"paid"!==e.status&&!e.isOverdue,"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-400":e.isOverdue},"px-2 py-1 rounded-full text-xs font-medium"])},s(se(e)),3)]),r("td",z,[r("div",H,["paid"!==e.status?(v(),t("button",{key:0,onClick:a=>(async e=>{try{await b.put(`/owner-dues/${e}`,{status:"paid"}),await Z()}catch(a){}})(e.id),class:"btn btn-sm btn-success"}," Ödendi ",8,R)):c("",!0),r("button",{onClick:e=>{},class:"btn btn-sm btn-outline"}," Detay ",8,I)])])]);var a}),128))])])]),0===ae.value.length?(v(),t("div",K,a[13]||(a[13]=[r("div",{class:"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 rounded-full p-3 w-fit mx-auto mb-3"},[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})])],-1),r("p",{class:"text-gray-500 dark:text-gray-400"},"Arama kriterlerinize uygun aidat kaydı bulunamadı.",-1)]))):c("",!0)])])]))}};export{Y as default};
