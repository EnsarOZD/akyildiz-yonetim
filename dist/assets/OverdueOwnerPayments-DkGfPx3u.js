import{r as e,C as a,o as t,c as l,b as r,t as s,D as o,H as d,E as n,J as u,e as i,F as c,i as p,l as g,p as v}from"./vue-vendor-BE3w9SvD.js";import{a as y}from"./index-CAkTsZV-.js";const b={class:"p-4 sm:p-6 bg-gray-50 min-h-screen font-sans dark:bg-gray-900"},m={class:"max-w-7xl mx-auto"},x={class:"flex items-center justify-between mb-6"},k={class:"flex items-center gap-4"},w={class:"bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-400 px-3 py-1 rounded-full text-sm"},f={class:"bg-orange-100 dark:bg-orange-900/50 text-orange-600 dark:text-orange-400 px-3 py-1 rounded-full text-sm"},h={class:"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-600 dark:text-yellow-400 px-3 py-1 rounded-full text-sm"},D={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200 dark:border-gray-700 mb-6"},C={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},T={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md border border-gray-200 dark:border-gray-700 overflow-hidden"},S={class:"overflow-x-auto"},N={class:"table w-full"},G={class:"p-4"},z={class:"font-medium text-gray-800 dark:text-gray-100"},L={class:"text-sm text-gray-500 dark:text-gray-400"},j={class:"p-4 text-gray-800 dark:text-gray-100"},E={class:"p-4"},M={class:"p-4"},O={class:"font-semibold text-red-600 dark:text-red-400"},U={class:"p-4 text-gray-800 dark:text-gray-100"},V={class:"p-4"},A={class:"p-4"},B={class:"flex items-center gap-2"},R=["onClick"],H=["onClick"],I=["onClick"],$={key:0,class:"text-center py-12"},_={__name:"OverdueOwnerPayments",setup(_){const F=e([]),J=e([]),K=e(!1),P=e(""),Y=e(""),q=e(""),Q=e("dueDate"),W=e=>null==e||isNaN(e)?"₺0.00":Number(e).toLocaleString("tr-TR",{style:"currency",currency:"TRY"}),X=async()=>{K.value=!0;try{const e=await y.get("/owner-payments/overdue");F.value=(e||[]).map(e=>{const a=J.value.find(a=>a.id===e.ownerId);return{...e,ownerName:(null==a?void 0:a.name)||"Bilinmiyor"}})}catch(e){F.value=[]}finally{K.value=!1}},Z=a(()=>F.value.reduce((e,a)=>e+Number(a.amount||0),0)),ee=a(()=>F.value.length),ae=a(()=>0===ee.value?0:Z.value/ee.value),te=a(()=>{let e=F.value;if(P.value){const a=P.value.toLowerCase();e=e.filter(e=>e.ownerName.toLowerCase().includes(a)||e.unit.toLowerCase().includes(a))}if(Y.value){const a=parseInt(Y.value);e=e.filter(e=>e.overdueDays>=a)}return q.value&&(e=e.filter(e=>e.type===q.value)),e.sort((e,a)=>{switch(Q.value){case"amount":return a.amount-e.amount;case"overdueDays":return a.overdueDays-e.overdueDays;default:return new Date(e.dueDate)-new Date(a.dueDate)}}),e});return t(()=>{(async()=>{try{const e=await y.get("/owners");J.value=e||[]}catch(e){J.value=[]}})().then(()=>X())}),(e,a)=>(g(),l("div",b,[r("div",m,[r("div",x,[a[4]||(a[4]=r("h1",{class:"text-3xl font-bold text-gray-800 dark:text-gray-100"},"Geciken Mal Sahibi Ödemeleri",-1)),r("div",k,[r("div",w," Toplam: "+s(W(e.totalOverdue)),1),r("div",f,s(ee.value)+" geciken ödeme ",1),r("div",h," Ortalama: "+s(W(ae.value)),1)])]),r("div",D,[r("div",C,[r("div",null,[a[5]||(a[5]=r("label",{class:"label"},"Arama",-1)),o(r("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>P.value=e),type:"text",placeholder:"Mal sahibi adı veya kat ara...",class:"input input-bordered w-full"},null,512),[[d,P.value]])]),r("div",null,[a[7]||(a[7]=r("label",{class:"label"},"Gecikme Süresi",-1)),o(r("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>Y.value=e),class:"select select-bordered w-full"},a[6]||(a[6]=[u('<option value="">Tümü</option><option value="7">7 günden fazla</option><option value="15">15 günden fazla</option><option value="30">30 günden fazla</option><option value="60">60 günden fazla</option>',5)]),512),[[n,Y.value]])]),r("div",null,[a[9]||(a[9]=r("label",{class:"label"},"Ödeme Türü",-1)),o(r("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>q.value=e),class:"select select-bordered w-full"},a[8]||(a[8]=[u('<option value="">Tümü</option><option value="aidat">Aidat</option><option value="su">Su</option><option value="elektrik">Elektrik</option><option value="diger">Diğer</option>',5)]),512),[[n,q.value]])]),r("div",null,[a[11]||(a[11]=r("label",{class:"label"},"Sıralama",-1)),o(r("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>Q.value=e),class:"select select-bordered w-full"},a[10]||(a[10]=[r("option",{value:"dueDate"},"Son Ödeme Tarihi",-1),r("option",{value:"amount"},"Tutar",-1),r("option",{value:"overdueDays"},"Gecikme Günü",-1)]),512),[[n,Q.value]])])])]),r("div",T,[r("div",S,[r("table",N,[a[12]||(a[12]=r("thead",{class:"bg-gray-50 dark:bg-gray-700"},[r("tr",null,[r("th",{class:"text-left p-4"},"Mal Sahibi"),r("th",{class:"text-left p-4"},"Kat"),r("th",{class:"text-left p-4"},"Ödeme Türü"),r("th",{class:"text-left p-4"},"Tutar"),r("th",{class:"text-left p-4"},"Son Ödeme"),r("th",{class:"text-left p-4"},"Gecikme"),r("th",{class:"text-left p-4"},"İşlemler")])],-1)),r("tbody",null,[(g(!0),l(c,null,p(te.value,e=>{return g(),l("tr",{key:e.id,class:"border-b border-gray-200 dark:border-gray-700 hover:bg-red-50 dark:hover:bg-red-900/20"},[r("td",G,[r("div",null,[r("p",z,s(e.ownerName),1),r("p",L,s(e.ownerEmail),1)])]),r("td",j,s(e.unit),1),r("td",E,[r("span",{class:v([{"bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-400":"aidat"===e.type,"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-400":"su"===e.type,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-400":"elektrik"===e.type,"bg-gray-100 text-gray-800 dark:bg-gray-900/50 dark:text-gray-400":"diger"===e.type},"px-2 py-1 rounded-full text-xs font-medium"])},s((t=e.type,{aidat:"Aidat",su:"Su",elektrik:"Elektrik",diger:"Diğer"}[t]||"Bilinmiyor")),3)]),r("td",M,[r("span",O,s(W(e.amount)),1)]),r("td",U,s((a=e.dueDate,a?new Date(a).toLocaleDateString("tr-TR",{year:"numeric",month:"short",day:"numeric"}):"-")),1),r("td",V,[r("span",{class:v([{"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-400":e.overdueDays>30,"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-400":e.overdueDays>15&&e.overdueDays<=30,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-400":e.overdueDays<=15},"px-2 py-1 rounded-full text-xs font-medium"])},s(e.overdueDays)+" gün ",3)]),r("td",A,[r("div",B,[r("button",{onClick:a=>(async e=>{try{await y.put(`/owner-payments/${e}`,{status:"paid"}),await X()}catch(a){}})(e.id),class:"btn btn-sm btn-success"}," Ödendi ",8,R),r("button",{onClick:a=>(e=>{alert(`${e.ownerName} için hatırlatma gönderildi.`)})(e),class:"btn btn-sm btn-warning"}," Hatırlat ",8,H),r("button",{onClick:e=>{},class:"btn btn-sm btn-outline"}," Detay ",8,I)])])]);var a,t}),128))])])]),0===te.value.length?(g(),l("div",$,a[13]||(a[13]=[r("div",{class:"bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 rounded-full p-3 w-fit mx-auto mb-3"},[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1),r("p",{class:"text-gray-500 dark:text-gray-400"},"Geciken ödeme bulunmuyor.",-1)]))):i("",!0)])])]))}};export{_ as default};
