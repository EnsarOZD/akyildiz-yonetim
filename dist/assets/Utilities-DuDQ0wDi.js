import{r as e,o as a,c as t,l as r,b as l,G as d,D as n,H as s,t as o,F as i,i as u,C as c,n as g,e as b,q as p,w as v,N as y,E as m,m as k,p as x,f as w}from"./vue-vendor-B4bLxnmP.js";import{a as h}from"./index-ErXur627.js";import{u as f,a as V}from"./useErrorHandler-DB_Jk_TF.js";import{e as C}from"./expensesService-CsRQiA1h.js";import{a as D}from"./aidatService-BMIBvfx0.js";import{_ as M}from"./FilterBar-BWi_ml3H.js";import{u as S}from"./utilityDebtsService-Bz_V1koj.js";import{t as R}from"./tenantsService-B2_anAuD.js";const T="/meterreadings",U={async getMeterReadings(e={}){try{const a=new URLSearchParams;e.flatId&&a.append("flatId",e.flatId),e.type&&a.append("type",e.type),e.periodYear&&a.append("periodYear",e.periodYear),e.periodMonth&&a.append("periodMonth",e.periodMonth),e.startDate&&a.append("startDate",e.startDate),e.endDate&&a.append("endDate",e.endDate);const t=`${T}?${a.toString()}`;return(await h.get(t)).data}catch(a){throw a}},async getMeterReadingById(e){try{return(await h.get(`${T}/${e}`)).data}catch(a){throw a}},async createMeterReading(e){try{return(await h.post(T,e)).data}catch(a){throw a}},async updateMeterReading(e,a){try{return(await h.put(`${T}/${e}`,a)).data}catch(t){throw t}},async deleteMeterReading(e){try{return(await h.delete(`${T}/${e}`)).data}catch(a){throw a}},async getLastReading(e,a){try{return(await h.get(`${T}/last-readings/${e}/${a}`)).data}catch(t){throw t}},async getMeterReadingStats(e={}){try{const a=new URLSearchParams;e.year&&a.append("year",e.year),e.month&&a.append("month",e.month),e.type&&a.append("type",e.type);const t=`${T}/stats?${a.toString()}`;return(await h.get(t)).data}catch(a){throw a}},async getMeterReadingsByPeriod(e,a,t=null){try{const r={periodYear:e,periodMonth:a};return t&&(r.type=t),await this.getMeterReadings(r)}catch(r){throw r}},async getMeterReadingsByFlat(e,a=null){try{const t={flatId:e};return a&&(t.type=a),await this.getMeterReadings(t)}catch(t){throw t}}},j={id:"electricityModal",class:"modal",open:""},H={class:"modal-box max-w-7xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700"},E={class:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200 dark:border-gray-700"},N={class:"space-y-4 mb-6"},B={class:"flex flex-wrap gap-4 items-center"},I={class:"form-control"},A={class:"form-control"},L={class:"form-control"},K={class:"form-control"},O=["disabled"],z={class:"overflow-x-auto"},$={class:"table w-full bg-white dark:bg-gray-800 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700"},W={class:"divide-y divide-gray-200 dark:divide-gray-700"},Y={class:"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500"},_={class:"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-500"},F=["onUpdate:modelValue"],P=["onUpdate:modelValue"],G=["onUpdate:modelValue"],q=["onUpdate:modelValue"],J={class:"modal-action flex justify-between items-center pt-6 border-t border-gray-200 dark:border-gray-700"},Q=["disabled"],X={__name:"ElectricityModal",emits:["close"],setup(c,{emit:g}){const b=g,p=e((new Date).toISOString().slice(0,7)),v=e(""),y=e(""),m=e(""),k=e([]),x=e(!1),w=e({individualConsumption:0,totalConsumption:0,kdvHaric:0,kdvDahil:0,note:"",previousReading:0,currentReading:0}),f=e({individualConsumption:0,totalConsumption:0,kdvHaric:0,kdvDahil:0,note:"",previousReading:0,currentReading:0});a(async()=>{const e=await h.get("/flats"),a=await U.getMeterReadings({type:"Electricity"}),t=new Map;a.forEach(e=>t.set(e.flatId,e)),k.value=e.map(e=>{const a=t.get(e.id);return{flatId:e.id,flatNumber:e.unitNumber,previousReading:a?a.readingValue:0,currentReading:0,individualConsumption:0,sharedConsumption:0,totalConsumption:0,kdvHaric:0,kdvDahil:0,note:""}})});const V=()=>{w.value.individualConsumption=Math.max(0,w.value.currentReading-w.value.previousReading),w.value.totalConsumption=w.value.individualConsumption,w.value.kdvDahil=Number(w.value.kdvHaric)>0?(1.2*Number(w.value.kdvHaric)).toFixed(2):""},C=()=>{f.value.individualConsumption=Math.max(0,f.value.currentReading-f.value.previousReading),f.value.totalConsumption=f.value.individualConsumption,f.value.kdvDahil=Number(f.value.kdvHaric)>0?(1.2*Number(f.value.kdvHaric)).toFixed(2):""},D=()=>{k.value.forEach(e=>{e.individualConsumption=Math.max(0,e.currentReading-e.previousReading),e.totalConsumption=e.individualConsumption+(e.sharedConsumption||0),e.kdvDahil=Number(e.kdvHaric)>0?(1.2*Number(e.kdvHaric)).toFixed(2):""})},M=async()=>{x.value=!0;try{const[e,a]=p.value.split("-").map(Number);(await h.post("/MeterReadings/distribute-shared-consumption",{sharedAreaConsumption:w.value.individualConsumption,mescitConsumption:f.value.individualConsumption,periodYear:e,periodMonth:a})).forEach(e=>{const a=k.value.find(a=>a.flatId===e.flatId);a&&(a.sharedConsumption=e.distributedConsumption)}),D()}finally{x.value=!1}},S=async()=>{x.value=!0;try{const[e,a]=p.value.split("-").map(Number);w.value.individualConsumption>0&&await U.createMeterReading({flatId:null,type:"Electricity",periodYear:e,periodMonth:a,readingDate:y.value,readingValue:w.value.individualConsumption,consumption:w.value.totalConsumption,kdvHaric:w.value.kdvHaric,kdvDahil:w.value.kdvDahil,note:w.value.note,firstReadingDate:v.value,paymentDueDate:m.value,isSharedArea:!0}),f.value.individualConsumption>0&&await U.createMeterReading({flatId:null,type:"Electricity",periodYear:e,periodMonth:a,readingDate:y.value,readingValue:f.value.individualConsumption,consumption:f.value.totalConsumption,kdvHaric:f.value.kdvHaric,kdvDahil:f.value.kdvDahil,note:f.value.note,firstReadingDate:v.value,paymentDueDate:m.value,isMescit:!0});for(const t of k.value)t.currentReading>0&&await U.createMeterReading({flatId:t.flatId,type:"Electricity",periodYear:e,periodMonth:a,readingDate:y.value,readingValue:t.currentReading,consumption:t.totalConsumption,kdvHaric:t.kdvHaric,kdvDahil:t.kdvDahil,note:t.note,firstReadingDate:v.value,paymentDueDate:m.value});b("close",!0)}finally{x.value=!1}};return(e,a)=>(r(),t("dialog",j,[l("div",H,[l("div",E,[a[15]||(a[15]=d('<div class="flex items-center gap-3"><div class="bg-amber-100 dark:bg-amber-900/50 text-amber-600 dark:text-amber-400 rounded-full p-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div><h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Elektrik Sayaç Okuması</h3></div>',1)),l("button",{onClick:a[0]||(a[0]=a=>e.$emit("close")),class:"btn btn-ghost btn-sm"},a[14]||(a[14]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),l("div",N,[l("div",B,[l("div",I,[a[16]||(a[16]=l("label",{class:"label"},[l("span",{class:"label-text"},"Dönem (Yıl/Ay)")],-1)),n(l("input",{type:"month","onUpdate:modelValue":a[1]||(a[1]=e=>p.value=e),class:"input input-bordered",placeholder:"örn. 2024-07"},null,512),[[s,p.value]])]),l("div",A,[a[17]||(a[17]=l("label",{class:"label"},[l("span",{class:"label-text"},"İlk Okuma Tarihi")],-1)),n(l("input",{type:"date","onUpdate:modelValue":a[2]||(a[2]=e=>v.value=e),class:"input input-bordered",placeholder:"örn. 2024-07-01"},null,512),[[s,v.value]])]),l("div",L,[a[18]||(a[18]=l("label",{class:"label"},[l("span",{class:"label-text"},"Son Okuma Tarihi")],-1)),n(l("input",{type:"date","onUpdate:modelValue":a[3]||(a[3]=e=>y.value=e),class:"input input-bordered",placeholder:"örn. 2024-07-31"},null,512),[[s,y.value]])]),l("div",K,[a[19]||(a[19]=l("label",{class:"label"},[l("span",{class:"label-text"},"Son Ödeme Tarihi")],-1)),n(l("input",{type:"date","onUpdate:modelValue":a[4]||(a[4]=e=>m.value=e),class:"input input-bordered",placeholder:"örn. 2024-08-10"},null,512),[[s,m.value]])]),l("button",{class:"btn btn-info mt-6",onClick:M,disabled:x.value},"Ortak Tüketimi Katlara Bölüştür",8,O)])]),l("div",z,[l("table",$,[a[24]||(a[24]=l("thead",{class:"bg-gray-100 dark:bg-gray-700"},[l("tr",null,[l("th",null,"Kat/Daire"),l("th",null,"İlk Okuma"),l("th",null,"Son Okuma"),l("th",null,"Bireysel Tüketim"),l("th",null,"Ortak Pay"),l("th",null,"Toplam Tüketim"),l("th",null,"KDV Hariç"),l("th",null,"KDV Dahil"),l("th",null,"Not")])],-1)),l("tbody",W,[l("tr",Y,[a[20]||(a[20]=l("td",{class:"font-semibold text-blue-700 dark:text-blue-300"},"Ortak Alan",-1)),l("td",null,[n(l("input",{type:"number","onUpdate:modelValue":a[5]||(a[5]=e=>w.value.previousReading=e),onInput:V,class:"input input-bordered input-sm w-24",placeholder:"örn. 12345"},null,544),[[s,w.value.previousReading,void 0,{number:!0}]])]),l("td",null,[n(l("input",{type:"number","onUpdate:modelValue":a[6]||(a[6]=e=>w.value.currentReading=e),onInput:V,class:"input input-bordered input-sm w-24",placeholder:"örn. 12500"},null,544),[[s,w.value.currentReading,void 0,{number:!0}]])]),l("td",null,o(w.value.individualConsumption),1),a[21]||(a[21]=l("td",null,"-",-1)),l("td",null,o(w.value.totalConsumption),1),l("td",null,[n(l("input",{type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>w.value.kdvHaric=e),onInput:V,class:"input input-bordered input-sm w-24",placeholder:"örn. 1000"},null,544),[[s,w.value.kdvHaric,void 0,{number:!0}]])]),l("td",null,o(w.value.kdvDahil),1),l("td",null,[n(l("input",{type:"text","onUpdate:modelValue":a[8]||(a[8]=e=>w.value.note=e),class:"input input-bordered input-sm w-32",placeholder:"Açıklama..."},null,512),[[s,w.value.note]])])]),l("tr",_,[a[22]||(a[22]=l("td",{class:"font-semibold text-green-700 dark:text-green-300"},"Mescit",-1)),l("td",null,[n(l("input",{type:"number","onUpdate:modelValue":a[9]||(a[9]=e=>f.value.previousReading=e),onInput:C,class:"input input-bordered input-sm w-24",placeholder:"örn. 12345"},null,544),[[s,f.value.previousReading,void 0,{number:!0}]])]),l("td",null,[n(l("input",{type:"number","onUpdate:modelValue":a[10]||(a[10]=e=>f.value.currentReading=e),onInput:C,class:"input input-bordered input-sm w-24",placeholder:"örn. 12500"},null,544),[[s,f.value.currentReading,void 0,{number:!0}]])]),l("td",null,o(f.value.individualConsumption),1),a[23]||(a[23]=l("td",null,"-",-1)),l("td",null,o(f.value.totalConsumption),1),l("td",null,[n(l("input",{type:"number","onUpdate:modelValue":a[11]||(a[11]=e=>f.value.kdvHaric=e),onInput:C,class:"input input-bordered input-sm w-24",placeholder:"örn. 1000"},null,544),[[s,f.value.kdvHaric,void 0,{number:!0}]])]),l("td",null,o(f.value.kdvDahil),1),l("td",null,[n(l("input",{type:"text","onUpdate:modelValue":a[12]||(a[12]=e=>f.value.note=e),class:"input input-bordered input-sm w-32",placeholder:"Açıklama..."},null,512),[[s,f.value.note]])])]),(r(!0),t(i,null,u(k.value,e=>(r(),t("tr",{key:e.flatId},[l("td",null,o(e.flatNumber),1),l("td",null,[n(l("input",{type:"number","onUpdate:modelValue":a=>e.previousReading=a,onInput:D,class:"input input-bordered input-sm w-24",placeholder:"örn. 12345"},null,40,F),[[s,e.previousReading,void 0,{number:!0}]])]),l("td",null,[n(l("input",{type:"number","onUpdate:modelValue":a=>e.currentReading=a,onInput:D,class:"input input-bordered input-sm w-24",placeholder:"örn. 12500"},null,40,P),[[s,e.currentReading,void 0,{number:!0}]])]),l("td",null,o(e.individualConsumption),1),l("td",null,o(e.sharedConsumption),1),l("td",null,o(e.totalConsumption),1),l("td",null,[n(l("input",{type:"number","onUpdate:modelValue":a=>e.kdvHaric=a,onInput:D,class:"input input-bordered input-sm w-24",placeholder:"örn. 1000"},null,40,G),[[s,e.kdvHaric,void 0,{number:!0}]])]),l("td",null,o(e.kdvDahil),1),l("td",null,[n(l("input",{type:"text","onUpdate:modelValue":a=>e.note=a,class:"input input-bordered input-sm w-32",placeholder:"Açıklama..."},null,8,q),[[s,e.note]])])]))),128))])])]),l("div",J,[l("button",{class:"btn btn-primary",onClick:S,disabled:x.value},"Tümünü Kaydet",8,Q),l("button",{class:"btn btn-outline",onClick:a[13]||(a[13]=a=>e.$emit("close"))},"Kapat")])])]))}},Z={id:"waterModal",class:"modal",open:""},ee={class:"modal-box max-w-7xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700"},ae={class:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200 dark:border-gray-700"},te={class:"space-y-6"},re={class:"form-control w-full max-w-xs"},le={class:"form-control w-full max-w-xs"},de={class:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4"},ne={class:"flex items-center justify-between mb-4"},se={class:"bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 px-3 py-1 rounded-full text-sm font-medium"},oe={class:"overflow-x-auto"},ie={class:"table w-full bg-white dark:bg-gray-800 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700"},ue={class:"divide-y divide-gray-200 dark:divide-gray-700"},ce={class:"font-medium text-gray-800 dark:text-gray-100"},ge={key:0,class:"badge badge-warning badge-xs ml-1"},be=["value"],pe=["onUpdate:modelValue","onInput"],ve={class:"font-semibold text-blue-600 dark:text-blue-400"},ye=["onUpdate:modelValue"],me={class:"modal-action flex justify-between items-center pt-6 border-t border-gray-200 dark:border-gray-700"},ke={class:"flex gap-2"},xe=["disabled"],we=["disabled"],he={__name:"WaterModal",emits:["close"],setup(p,{emit:v}){const y=v,m=e((new Date).toISOString().slice(0,7)),k=e((new Date).toISOString().slice(0,10)),x=e([]),w=c(()=>x.value.some(e=>e.currentReading>0)),f=c(()=>x.value.every(e=>e.currentReading>0)),V=async()=>{try{const[e,a]=m.value.split("-").map(Number),t=x.value.filter(e=>e.currentReading>0);for(const r of t){const t={flatId:r.flatId,type:"Water",periodYear:e,periodMonth:a,readingValue:r.currentReading,consumption:r.consumption,readingDate:k.value,note:r.note||null};await U.createMeterReading(t)}y("close",!0)}catch(e){alert("Kayıtlar kaydedilirken bir hata oluştu.")}},C=async()=>{try{const[e,a]=m.value.split("-").map(Number),t=x.value.filter(e=>e.currentReading>0);for(const r of t){const t={flatId:r.flatId,type:"Water",periodYear:e,periodMonth:a,readingValue:r.currentReading,consumption:r.consumption,readingDate:k.value,note:r.note||null};await U.createMeterReading(t)}y("close",!0)}catch(e){alert("Kayıtlar kaydedilirken bir hata oluştu.")}};return a(async()=>{try{const e=await h.get("/flats"),a=await U.getMeterReadings({type:"Water"}),t=new Map;e.forEach(e=>{const r=a.filter(a=>a.flatId===e.id);if(r.length>0){const a=r.sort((e,a)=>new Date(a.readingDate)-new Date(e.readingDate))[0];t.set(e.id,a)}}),x.value=e.map(e=>{const a=t.get(e.id);return{flatId:e.id,flatNumber:e.unitNumber,isActive:e.isActive,previousReading:a?a.readingValue:0,currentReading:0,consumption:0,note:""}})}catch(e){alert("Veriler yüklenirken bir hata oluştu.")}}),(e,a)=>(r(),t("dialog",Z,[l("div",ee,[l("div",ae,[a[5]||(a[5]=d('<div class="flex items-center gap-3"><div class="bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 rounded-full p-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg></div><h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Su Sayaç Okuması</h3></div>',1)),l("button",{onClick:a[0]||(a[0]=a=>e.$emit("close")),class:"btn btn-ghost btn-sm"},a[4]||(a[4]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),l("div",te,[l("div",re,[a[6]||(a[6]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Dönem")],-1)),n(l("input",{type:"month","onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300"},null,512),[[s,m.value]])]),l("div",le,[a[7]||(a[7]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Okuma Tarihi")],-1)),n(l("input",{type:"date","onUpdate:modelValue":a[2]||(a[2]=e=>k.value=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300"},null,512),[[s,k.value]])]),l("div",de,[l("div",ne,[a[8]||(a[8]=l("h4",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100"},"Sayaç Okumaları",-1)),l("div",se,o(x.value.length)+" Birim ",1)]),l("div",oe,[l("table",ie,[a[9]||(a[9]=l("thead",{class:"bg-gray-100 dark:bg-gray-700"},[l("tr",null,[l("th",{class:"text-gray-700 dark:text-gray-300 font-semibold"},"Daire"),l("th",{class:"text-gray-700 dark:text-gray-300 font-semibold"},"Önceki Sayaç"),l("th",{class:"text-gray-700 dark:text-gray-300 font-semibold"},"Yeni Sayaç"),l("th",{class:"text-gray-700 dark:text-gray-300 font-semibold"},"Tüketim (m³)"),l("th",{class:"text-gray-700 dark:text-gray-300 font-semibold"},"Not")])],-1)),l("tbody",ue,[(r(!0),t(i,null,u(x.value,(e,a)=>{return r(),t("tr",{key:a,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-200"},[l("td",ce,[g(o(e.flatNumber)+" ",1),e.isActive?b("",!0):(r(),t("span",ge,"Pasif"))]),l("td",null,[l("input",{type:"number",class:"input input-bordered input-sm w-24 bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-600 text-gray-500 dark:text-gray-400",value:e.previousReading,disabled:""},null,8,be)]),l("td",null,[n(l("input",{type:"number",class:"input input-bordered input-sm w-24 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300","onUpdate:modelValue":a=>e.currentReading=a,onInput:e=>(e=>{const a=x.value[e];a.consumption=Math.max(0,a.currentReading-a.previousReading)})(a),step:"0.01"},null,40,pe),[[s,e.currentReading,void 0,{number:!0}]])]),l("td",ve,o((d=e.consumption,null==d||isNaN(d)?"0.00":Number(d).toFixed(2))),1),l("td",null,[n(l("input",{type:"text",class:"input input-bordered input-sm w-32 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300","onUpdate:modelValue":a=>e.note=a,placeholder:"Not..."},null,8,ye),[[s,e.note]])])]);var d}),128))])])])])]),l("div",me,[l("div",ke,[l("button",{class:"btn btn-success btn-sm",onClick:C,disabled:!w.value},a[10]||(a[10]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"})],-1),g(" Girilenleri Kaydet ")]),8,xe),l("button",{class:"btn btn-primary btn-sm",onClick:V,disabled:!f.value},a[11]||(a[11]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),g(" Tümünü Kaydet ")]),8,we)]),l("button",{class:"btn btn-outline btn-sm",onClick:a[3]||(a[3]=a=>e.$emit("close"))},a[12]||(a[12]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),g(" Kapat ")]))])])]))}},fe={open:"",class:"modal"},Ve={class:"modal-box max-w-md bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700"},Ce={class:"space-y-4"},De={class:"form-control"},Me={class:"form-control"},Se={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700"},Re=["disabled"],Te={__name:"AidatModal",emits:["close","refresh"],setup(a,{emit:o}){const i=o,u=e(""),c=e(""),b=()=>{i("close")},v=async()=>{try{if(!u.value||!c.value)return void alert("Lütfen dönem ve son ödeme tarihini giriniz.");const e=parseInt(u.value.slice(0,4)),a=await h.post("/utilitydebts/create-aidat",{period:u.value,dueDate:c.value,year:e});if(0===a.tenantDuesCreated&&0===a.ownerDuesCreated)return void alert(`Seçilen dönem (${u.value}) için zaten tüm aidat kayıtları oluşturulmuş veya tanımlı aidat bulunmuyor.`);alert(`${a.tenantDuesCreated} kiracı ve ${a.ownerDuesCreated} mal sahibi için aidat kayıtları başarıyla oluşturuldu.`),i("refresh"),i("close")}catch(e){alert("Bir hata oluştu. Konsolu kontrol ediniz.")}};return(e,a)=>(r(),t("dialog",fe,[l("div",Ve,[l("div",{class:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200 dark:border-gray-700"},[a[3]||(a[3]=d('<div class="flex items-center gap-3"><div class="bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 rounded-full p-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path></svg></div><h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Aidat Oluştur</h3></div>',1)),l("button",{onClick:b,class:"btn btn-ghost btn-sm"},a[2]||(a[2]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),l("form",{onSubmit:p(v,["prevent"]),class:"space-y-6"},[l("div",Ce,[l("div",De,[a[4]||(a[4]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Dönem"),l("span",{class:"label-text-alt text-red-500"},"*")],-1)),n(l("input",{type:"month","onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",required:""},null,512),[[s,u.value]]),a[5]||(a[5]=l("label",{class:"label"},[l("span",{class:"label-text-alt text-gray-500 dark:text-gray-400"},"Aidatın geçerli olacağı ay ve yıl")],-1))]),l("div",Me,[a[6]||(a[6]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Son Ödeme Tarihi"),l("span",{class:"label-text-alt text-red-500"},"*")],-1)),n(l("input",{type:"date","onUpdate:modelValue":a[1]||(a[1]=e=>c.value=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",required:""},null,512),[[s,c.value]]),a[7]||(a[7]=l("label",{class:"label"},[l("span",{class:"label-text-alt text-gray-500 dark:text-gray-400"},"Aidatın son ödeme tarihi")],-1))])]),a[10]||(a[10]=d('<div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800"><div class="flex items-start gap-3"><div class="bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 rounded-full p-1 mt-0.5"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><div class="text-sm text-gray-700 dark:text-gray-300"><p class="font-medium mb-1">Bilgi</p><p>Seçilen dönem için yıllık aidat tanımlarından otomatik olarak aidat kayıtları oluşturulacaktır.</p></div></div></div>',1)),l("div",Se,[l("button",{type:"button",class:"btn btn-outline btn-sm",onClick:b},a[8]||(a[8]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),g(" İptal ")])),l("button",{type:"submit",class:"btn btn-primary btn-sm",disabled:!u.value||!c.value},a[9]||(a[9]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),g(" Oluştur ")]),8,Re)])],32)])]))}},Ue={key:0,open:"",class:"modal"},je={class:"modal-box max-w-2xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700"},He={class:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200 dark:border-gray-700"},Ee={class:"space-y-6"},Ne={class:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 space-y-4"},Be={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ie={class:"form-control"},Ae=["value"],Le={class:"form-control"},Ke=["value"],Oe={class:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 space-y-4"},ze={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},$e={class:"form-control"},We={class:"form-control"},Ye={class:"bg-white dark:bg-gray-700 rounded-lg p-4 border border-blue-200 dark:border-blue-800"},_e={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Fe={class:"text-center"},Pe={class:"text-lg font-bold text-blue-600 dark:text-blue-400"},Ge={class:"text-center"},qe={class:"text-lg font-bold text-green-600 dark:text-green-400"},Je={class:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 space-y-4"},Qe={class:"form-control"},Xe={key:0,class:"space-y-3"},Ze={key:0,class:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 border border-red-200 dark:border-red-800"},ea={class:"flex items-start gap-3"},aa={class:"text-sm text-gray-700 dark:text-gray-300"},ta={class:"list-disc list-inside space-y-1"},ra={key:1,class:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800"},la={class:"flex items-start gap-3"},da={class:"text-sm text-gray-700 dark:text-gray-300"},na={class:"list-disc list-inside space-y-1"},sa={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700"},oa=["disabled"],ia={__name:"EditElectricityModal",props:{record:Object},emits:["close","updated"],setup(a,{emit:c}){const p=a,y=c,{handleNetworkError:m,handleValidationError:k,showSuccess:x}=f(),w=e({previousValue:0,currentValue:0,kdvHaric:0}),h=e({isValid:!0,issues:[],warnings:[]}),V=()=>{var e;const a={currentValue:w.value.currentValue,previousValue:w.value.previousValue,endDate:null==(e=p.record)?void 0:e.endDate};h.value=C.validateReadingEdit(p.record,a)};v(()=>p.record,e=>{e&&(w.value.previousValue=e.previousValue??0,w.value.currentValue=e.currentValue??0,w.value.kdvHaric=e.kdvHaric??0,V())},{immediate:!0});const D=async()=>{try{if(V(),!h.value.isValid)return void k("Lütfen hataları düzeltin.");const e=C.calculateConsumption(w.value.currentValue,w.value.previousValue),a=C.calculateTotalWithVAT(w.value.kdvHaric,.2);await C.updateReading(p.record.id,{previousValue:w.value.previousValue,currentValue:w.value.currentValue,consumption:e,kdvHaric:w.value.kdvHaric,toplamTutar:a,kdvDahil:a,remainingAmount:a-(p.record.paidAmount||0),isPaid:a-(p.record.paidAmount||0)<=0,lastModified:new Date,modifiedBy:"unknown_user"}),x("Elektrik kaydı başarıyla güncellendi."),y("updated"),y("close")}catch(e){m("Elektrik kaydı güncellenirken bir hata oluştu.",e)}};return(e,c)=>{return a.record?(r(),t("dialog",Ue,[l("div",je,[l("div",He,[c[6]||(c[6]=d('<div class="flex items-center gap-3"><div class="bg-yellow-100 dark:bg-yellow-900/50 text-yellow-600 dark:text-yellow-400 rounded-full p-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></div><h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Elektrik Kaydı Düzenle</h3></div>',1)),l("button",{onClick:c[0]||(c[0]=a=>e.$emit("close")),class:"btn btn-ghost btn-sm"},c[5]||(c[5]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),l("div",Ee,[l("div",Ne,[c[9]||(c[9]=l("h4",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-3"},"Kayıt Bilgileri",-1)),l("div",Be,[l("div",Ie,[c[7]||(c[7]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Kat")],-1)),l("input",{type:"text",class:"input input-bordered w-full bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-600 text-gray-500 dark:text-gray-400",value:a.record.unit,disabled:""},null,8,Ae)]),l("div",Le,[c[8]||(c[8]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Şirket")],-1)),l("input",{type:"text",class:"input input-bordered w-full bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-600 text-gray-500 dark:text-gray-400",value:a.record.tenantName||"-",disabled:""},null,8,Ke)])])]),l("div",Oe,[c[14]||(c[14]=l("h4",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-3"},"Sayaç Okumaları",-1)),l("div",ze,[l("div",$e,[c[10]||(c[10]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Önceki Endeks (kWh)"),l("span",{class:"label-text-alt text-red-500"},"*")],-1)),n(l("input",{type:"number","onUpdate:modelValue":c[1]||(c[1]=e=>w.value.previousValue=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",min:"0",step:"0.01",onInput:V},null,544),[[s,w.value.previousValue,void 0,{number:!0}]])]),l("div",We,[c[11]||(c[11]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Yeni Endeks (kWh)"),l("span",{class:"label-text-alt text-red-500"},"*")],-1)),n(l("input",{type:"number","onUpdate:modelValue":c[2]||(c[2]=e=>w.value.currentValue=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",min:"0",step:"0.01",onInput:V},null,544),[[s,w.value.currentValue,void 0,{number:!0}]])])]),l("div",Ye,[l("div",_e,[l("div",Fe,[c[12]||(c[12]=l("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Tüketim",-1)),l("p",Pe,o(w.value.currentValue-w.value.previousValue)+" kWh ",1)]),l("div",Ge,[c[13]||(c[13]=l("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Toplam (KDV Dahil)",-1)),l("p",qe,o((p=1.2*w.value.kdvHaric,isNaN(p)?"-":p.toLocaleString("tr-TR",{style:"currency",currency:"TRY"}))),1)])])])]),l("div",Je,[c[17]||(c[17]=l("h4",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-3"},"Tutar Bilgileri",-1)),l("div",Qe,[c[15]||(c[15]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"KDV Hariç Tutar (₺)"),l("span",{class:"label-text-alt text-red-500"},"*")],-1)),n(l("input",{type:"number","onUpdate:modelValue":c[3]||(c[3]=e=>w.value.kdvHaric=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",step:"0.01",min:"0"},null,512),[[s,w.value.kdvHaric,void 0,{number:!0}]]),c[16]||(c[16]=l("label",{class:"label"},[l("span",{class:"label-text-alt text-gray-500 dark:text-gray-400"},"KDV hariç elektrik tutarı")],-1))])]),h.value.issues.length>0||h.value.warnings.length>0?(r(),t("div",Xe,[h.value.issues.length>0?(r(),t("div",Ze,[l("div",ea,[c[19]||(c[19]=l("div",{class:"bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-400 rounded-full p-1 mt-0.5"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),l("div",aa,[c[18]||(c[18]=l("p",{class:"font-medium mb-1 text-red-600 dark:text-red-400"},"Hatalar",-1)),l("ul",ta,[(r(!0),t(i,null,u(h.value.issues,e=>(r(),t("li",{key:e,class:"text-red-600 dark:text-red-400"},o(e),1))),128))])])])])):b("",!0),h.value.warnings.length>0?(r(),t("div",ra,[l("div",la,[c[21]||(c[21]=l("div",{class:"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-600 dark:text-yellow-400 rounded-full p-1 mt-0.5"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),l("div",da,[c[20]||(c[20]=l("p",{class:"font-medium mb-1"},"Uyarılar",-1)),l("ul",na,[(r(!0),t(i,null,u(h.value.warnings,e=>(r(),t("li",{key:e},o(e),1))),128))])])])])):b("",!0)])):b("",!0),l("div",sa,[l("button",{class:"btn btn-outline btn-sm",onClick:c[4]||(c[4]=a=>e.$emit("close"))},c[22]||(c[22]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),g(" İptal ")])),l("button",{class:"btn btn-primary btn-sm",onClick:D,disabled:!h.value.isValid||w.value.previousValue<0||w.value.currentValue<0||w.value.kdvHaric<0},c[23]||(c[23]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"})],-1),g(" Kaydet ")]),8,oa)])])])])):b("",!0);var p}}},ua={open:"",class:"modal"},ca={class:"modal-box max-w-2xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700"},ga={class:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200 dark:border-gray-700"},ba={class:"space-y-6"},pa={class:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 space-y-4"},va={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ya={class:"form-control"},ma=["value"],ka={class:"form-control"},xa=["value"],wa={class:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 space-y-4"},ha={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fa={class:"form-control"},Va={class:"form-control"},Ca={class:"bg-white dark:bg-gray-700 rounded-lg p-4 border border-blue-200 dark:border-blue-800"},Da={class:"text-center"},Ma={class:"text-lg font-bold text-blue-600 dark:text-blue-400"},Sa={class:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 space-y-4"},Ra={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ta={class:"form-control"},Ua={class:"form-control"},ja={class:"bg-white dark:bg-gray-700 rounded-lg p-4 border border-green-200 dark:border-green-800"},Ha={class:"text-center"},Ea={class:"text-lg font-bold text-green-600 dark:text-green-400"},Na={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700"},Ba=["disabled"],Ia={__name:"EditWaterModal",props:{record:Object},emits:["close","updated"],setup(a,{emit:i}){const u=a,b=i,{handleNetworkError:p,handleValidationError:v,showSuccess:m}=f(),k=e({previousValue:0,currentValue:0,kdvHaric:0}),x=e({isValid:!0,issues:[],warnings:[]}),w=()=>{var e;const a={currentValue:k.value.currentValue,previousValue:k.value.previousValue,endDate:null==(e=u.record)?void 0:e.endDate};x.value=meterManager.validateReadingEdit(u.record,a)};y(()=>{u.record&&(k.value.previousValue=u.record.previousValue??0,k.value.currentValue=u.record.currentValue??0,k.value.kdvHaric=u.record.kdvHaric??0,w())});const h=c(()=>+(1.01*k.value.kdvHaric+1.1*k.value.wasteAmount).toFixed(2)),V=async()=>{var e,a;try{if(w(),!x.value.isValid)return void v("Lütfen hataları düzeltin.",{component:"EditWaterModal",action:"save"});const t=calculateConsumption(k.value.currentValue,k.value.previousValue),r=calculateTotalWithVAT(k.value.kdvHaric,.2),l=doc(db,"readings",u.record.id),d=meterManager.createAuditTrail(u.record,{...u.record,...k.value,consumption:t,toplamTutar:r},(null==(e=authStore.user)?void 0:e.uid)||"unknown_user");await updateDoc(l,{previousValue:k.value.previousValue,currentValue:k.value.currentValue,consumption:t,kdvHaric:k.value.kdvHaric,toplamTutar:r,kdvDahil:r,remainingAmount:r-(u.record.paidAmount||0),isPaid:r-(u.record.paidAmount||0)<=0,lastModified:new Date,modifiedBy:(null==(a=authStore.user)?void 0:a.uid)||"unknown_user"}),await addDoc(collection(db,"auditTrail"),d),meterManager.clearCacheForUnit(u.record.unit,"water"),m("Su kaydı başarıyla güncellendi.",{component:"EditWaterModal",action:"save"}),b("updated"),b("close")}catch(t){p(t,{component:"EditWaterModal",action:"save"})}};return(e,i)=>{return r(),t("dialog",ua,[l("div",ca,[l("div",ga,[i[7]||(i[7]=d('<div class="flex items-center gap-3"><div class="bg-yellow-100 dark:bg-yellow-900/50 text-yellow-600 dark:text-yellow-400 rounded-full p-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></div><h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Su Kaydı Düzenle</h3></div>',1)),l("button",{onClick:i[0]||(i[0]=a=>e.$emit("close")),class:"btn btn-ghost btn-sm"},i[6]||(i[6]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),l("div",ba,[l("div",pa,[i[10]||(i[10]=l("h4",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-3"},"Kayıt Bilgileri",-1)),l("div",va,[l("div",ya,[i[8]||(i[8]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Kat")],-1)),l("input",{type:"text",class:"input input-bordered w-full bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-600 text-gray-500 dark:text-gray-400",value:a.record.unit,disabled:""},null,8,ma)]),l("div",ka,[i[9]||(i[9]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Şirket")],-1)),l("input",{type:"text",class:"input input-bordered w-full bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-600 text-gray-500 dark:text-gray-400",value:a.record.tenantName||"-",disabled:""},null,8,xa)])])]),l("div",wa,[i[14]||(i[14]=l("h4",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-3"},"Sayaç Okumaları",-1)),l("div",ha,[l("div",fa,[i[11]||(i[11]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Önceki Endeks (m³)"),l("span",{class:"label-text-alt text-red-500"},"*")],-1)),n(l("input",{type:"number","onUpdate:modelValue":i[1]||(i[1]=e=>k.value.previousValue=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",min:"0",step:"0.01"},null,512),[[s,k.value.previousValue,void 0,{number:!0}]])]),l("div",Va,[i[12]||(i[12]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Yeni Endeks (m³)"),l("span",{class:"label-text-alt text-red-500"},"*")],-1)),n(l("input",{type:"number","onUpdate:modelValue":i[2]||(i[2]=e=>k.value.currentValue=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",min:"0",step:"0.01"},null,512),[[s,k.value.currentValue,void 0,{number:!0}]])])]),l("div",Ca,[l("div",Da,[i[13]||(i[13]=l("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Tüketim",-1)),l("p",Ma,o(k.value.currentValue-k.value.previousValue)+" m³ ",1)])])]),l("div",Sa,[i[20]||(i[20]=l("h4",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-3"},"Tutar Bilgileri",-1)),l("div",Ra,[l("div",Ta,[i[15]||(i[15]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Su Tutarı (₺)"),l("span",{class:"label-text-alt text-red-500"},"*")],-1)),n(l("input",{type:"number","onUpdate:modelValue":i[3]||(i[3]=e=>k.value.kdvHaric=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",step:"0.01",min:"0"},null,512),[[s,k.value.kdvHaric,void 0,{number:!0}]]),i[16]||(i[16]=l("label",{class:"label"},[l("span",{class:"label-text-alt text-gray-500 dark:text-gray-400"},"KDV hariç su tutarı (%1 KDV)")],-1))]),l("div",Ua,[i[17]||(i[17]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Atık Su Tutarı (₺)"),l("span",{class:"label-text-alt text-red-500"},"*")],-1)),n(l("input",{type:"number","onUpdate:modelValue":i[4]||(i[4]=e=>k.value.wasteAmount=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",step:"0.01",min:"0"},null,512),[[s,k.value.wasteAmount,void 0,{number:!0}]]),i[18]||(i[18]=l("label",{class:"label"},[l("span",{class:"label-text-alt text-gray-500 dark:text-gray-400"},"KDV hariç atık su tutarı (%10 KDV)")],-1))])]),l("div",ja,[l("div",Ha,[i[19]||(i[19]=l("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Toplam (KDV Dahil)",-1)),l("p",Ea,o((u=h.value,isNaN(u)?"-":u.toLocaleString("tr-TR",{style:"currency",currency:"TRY"}))),1)])])]),i[23]||(i[23]=d('<div class="bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800"><div class="flex items-start gap-3"><div class="bg-yellow-100 dark:bg-yellow-900/50 text-yellow-600 dark:text-yellow-400 rounded-full p-1 mt-0.5"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div><div class="text-sm text-gray-700 dark:text-gray-300"><p class="font-medium mb-1">Dikkat</p><p>Bu değişiklik su kaydını kalıcı olarak güncelleyecektir. Tüketim ve toplam tutar otomatik olarak hesaplanacaktır.</p></div></div></div>',1)),l("div",Na,[l("button",{class:"btn btn-outline btn-sm",onClick:i[5]||(i[5]=a=>e.$emit("close"))},i[21]||(i[21]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),g(" İptal ")])),l("button",{class:"btn btn-primary btn-sm",onClick:V,disabled:k.value.previousValue<0||k.value.currentValue<0||k.value.kdvHaric<0||k.value.wasteAmount<0},i[22]||(i[22]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"})],-1),g(" Kaydet ")]),8,Ba)])])])]);var u}}},Aa={open:"",class:"modal"},La={class:"modal-box max-w-md bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700"},Ka={class:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200 dark:border-gray-700"},Oa={class:"space-y-6"},za={class:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 space-y-4"},$a={class:"form-control"},Wa=["value"],Ya={class:"form-control"},_a=["value"],Fa={class:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 space-y-4"},Pa={class:"form-control"},Ga={class:"form-control"},qa={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700"},Ja=["disabled"],Qa={__name:"EditAidatModal",props:{record:Object},emits:["close","updated"],setup(o,{emit:i}){const u=o,c=i,{handleValidationError:b,showSuccess:p}=f(),v=e({kdvHaric:0,toplamTutar:0});a(()=>{u.record&&(v.value.kdvHaric=u.record.kdvHaric??0,v.value.toplamTutar=u.record.toplamTutar??0)});const y=async()=>{try{await D.updateAidat(u.record.id,{kdvHaric:v.value.kdvHaric,kdvDahil:v.value.toplamTutar,remainingAmount:v.value.toplamTutar-(u.record.paidAmount||0),isPaid:v.value.toplamTutar-(u.record.paidAmount||0)<=0}),p("Aidat kaydı güncellendi."),c("updated"),c("close")}catch(e){b(e)}};return(e,a)=>(r(),t("dialog",Aa,[l("div",La,[l("div",Ka,[a[5]||(a[5]=d('<div class="flex items-center gap-3"><div class="bg-yellow-100 dark:bg-yellow-900/50 text-yellow-600 dark:text-yellow-400 rounded-full p-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></div><h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Aidat Kaydı Düzenle</h3></div>',1)),l("button",{onClick:a[0]||(a[0]=a=>e.$emit("close")),class:"btn btn-ghost btn-sm"},a[4]||(a[4]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),l("div",Oa,[l("div",za,[a[8]||(a[8]=l("h4",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-3"},"Kayıt Bilgileri",-1)),l("div",$a,[a[6]||(a[6]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Kat")],-1)),l("input",{type:"text",class:"input input-bordered w-full bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-600 text-gray-500 dark:text-gray-400",value:o.record.unit,disabled:""},null,8,Wa)]),l("div",Ya,[a[7]||(a[7]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Şirket")],-1)),l("input",{type:"text",class:"input input-bordered w-full bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-600 text-gray-500 dark:text-gray-400",value:o.record.tenantName||"-",disabled:""},null,8,_a)])]),l("div",Fa,[a[13]||(a[13]=l("h4",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-3"},"Tutar Bilgileri",-1)),l("div",Pa,[a[9]||(a[9]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"KDV Hariç Tutar (₺)"),l("span",{class:"label-text-alt text-red-500"},"*")],-1)),n(l("input",{type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>v.value.kdvHaric=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",step:"0.01",min:"0"},null,512),[[s,v.value.kdvHaric,void 0,{number:!0}]]),a[10]||(a[10]=l("label",{class:"label"},[l("span",{class:"label-text-alt text-gray-500 dark:text-gray-400"},"KDV hariç aidat tutarı")],-1))]),l("div",Ga,[a[11]||(a[11]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Toplam Tutar (₺)"),l("span",{class:"label-text-alt text-red-500"},"*")],-1)),n(l("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=e=>v.value.toplamTutar=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",step:"0.01",min:"0"},null,512),[[s,v.value.toplamTutar,void 0,{number:!0}]]),a[12]||(a[12]=l("label",{class:"label"},[l("span",{class:"label-text-alt text-gray-500 dark:text-gray-400"},"KDV dahil toplam tutar")],-1))])]),a[16]||(a[16]=d('<div class="bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800"><div class="flex items-start gap-3"><div class="bg-yellow-100 dark:bg-yellow-900/50 text-yellow-600 dark:text-yellow-400 rounded-full p-1 mt-0.5"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div><div class="text-sm text-gray-700 dark:text-gray-300"><p class="font-medium mb-1">Dikkat</p><p>Bu değişiklik aidat kaydını kalıcı olarak güncelleyecektir.</p></div></div></div>',1)),l("div",qa,[l("button",{class:"btn btn-outline btn-sm",onClick:a[3]||(a[3]=a=>e.$emit("close"))},a[14]||(a[14]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),g(" İptal ")])),l("button",{class:"btn btn-primary btn-sm",onClick:y,disabled:v.value.kdvHaric<0||v.value.toplamTutar<0},a[15]||(a[15]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"})],-1),g(" Kaydet ")]),8,Ja)])])])]))}},Xa={id:"meterReadingModal",class:"modal",open:""},Za={class:"modal-box max-w-7xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700"},et={class:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200 dark:border-gray-700"},at={class:"flex items-center gap-3"},tt={class:"text-xl font-bold text-gray-800 dark:text-gray-100"},rt={class:"space-y-6"},lt={class:"form-control w-full max-w-xs"},dt=["disabled"],nt={class:"form-control w-full max-w-xs"},st=["disabled"],ot=["value"],it={class:"form-control w-full max-w-xs"},ut={class:"form-control w-full max-w-xs"},ct={class:"form-control w-full max-w-xs"},gt={class:"label"},bt={class:"label-text font-semibold text-gray-700 dark:text-gray-300"},pt={key:0,class:"form-control w-full max-w-xs"},vt=["value"],yt={key:1,class:"form-control w-full max-w-xs"},mt={class:"label"},kt={class:"label-text font-semibold text-gray-700 dark:text-gray-300"},xt=["value"],wt={class:"form-control w-full"},ht={class:"modal-action flex justify-between items-center pt-6 border-t border-gray-200 dark:border-gray-700"},ft={class:"flex gap-2"},Vt=["disabled"],Ct={key:0,class:"loading loading-spinner loading-sm"},Dt={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},Mt={__name:"MeterReadingModal",props:{reading:{type:Object,default:null}},emits:["close"],setup(d,{emit:p}){const y=d,k=p,x=e(!1),w=e([]),C=e(null),D=e({type:"Electricity",flatId:"",period:(new Date).toISOString().slice(0,7),readingDate:(new Date).toISOString().slice(0,10),readingValue:null,note:""}),M=c(()=>!!y.reading),S=c(()=>D.value.type&&D.value.flatId&&D.value.period&&D.value.readingDate&&null!==D.value.readingValue&&D.value.readingValue>=0),R=c(()=>C.value&&D.value.readingValue?Math.max(0,D.value.readingValue-C.value.readingValue):0),T=async()=>{if(D.value.flatId&&D.value.type)try{const e=await U.getMeterReadings({flatId:D.value.flatId,type:D.value.type});if(e&&e.length>0){const a=e.sort((e,a)=>new Date(a.readingDate)-new Date(e.readingDate));C.value=a[0]}}catch(e){}},j=async()=>{if(S.value){x.value=!0;try{const e={type:D.value.type,flatId:D.value.flatId,periodYear:parseInt(D.value.period.split("-")[0]),periodMonth:parseInt(D.value.period.split("-")[1]),readingDate:D.value.readingDate,readingValue:D.value.readingValue,note:D.value.note};M.value?(await U.updateMeterReading(y.reading.id,e),V().showSuccess("Sayaç okuması başarıyla güncellendi")):(await U.createMeterReading(e),V().showSuccess("Sayaç okuması başarıyla kaydedildi")),k("close",!0)}catch(e){f().handleNetworkError(e,{component:"MeterReadingModal",action:M.value?"updateMeterReading":"createMeterReading"})}finally{x.value=!1}}};return v(()=>D.value.flatId,()=>{D.value.flatId&&D.value.type&&T()}),v(()=>D.value.type,()=>{D.value.flatId&&D.value.type&&T()}),a(async()=>{await(async()=>{try{const e=await h.get("/flats");w.value=e||[]}catch(e){}})(),y.reading&&(D.value={type:y.reading.type,flatId:y.reading.flatId,period:`${y.reading.periodYear}-${y.reading.periodMonth.toString().padStart(2,"0")}`,readingDate:y.reading.readingDate,readingValue:y.reading.readingValue,note:y.reading.note||""}),D.value.flatId&&D.value.type&&await T()}),(e,a)=>(r(),t("dialog",Xa,[l("div",Za,[l("div",et,[l("div",at,[a[8]||(a[8]=l("div",{class:"bg-cyan-100 dark:bg-cyan-900/50 text-cyan-600 dark:text-cyan-400 rounded-full p-2"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),l("h3",tt,o(M.value?"Sayaç Okuması Düzenle":"Yeni Sayaç Okuması"),1)]),l("button",{onClick:a[0]||(a[0]=a=>e.$emit("close")),class:"btn btn-ghost btn-sm"},a[9]||(a[9]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),l("div",rt,[l("div",lt,[a[11]||(a[11]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Sayaç Tipi")],-1)),n(l("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>D.value.type=e),class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",disabled:M.value},a[10]||(a[10]=[l("option",{value:"Electricity"},"⚡ Elektrik",-1),l("option",{value:"Water"},"💧 Su",-1)]),8,dt),[[m,D.value.type]])]),l("div",nt,[a[13]||(a[13]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Daire")],-1)),n(l("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>D.value.flatId=e),class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",disabled:M.value},[a[12]||(a[12]=l("option",{value:""},"Daire seçin...",-1)),(r(!0),t(i,null,u(w.value,e=>(r(),t("option",{key:e.id,value:e.id},o(e.unitNumber)+" - "+o(e.floor)+". Kat ("+o(e.unitArea)+"m²) ",9,ot))),128))],8,st),[[m,D.value.flatId]])]),l("div",it,[a[14]||(a[14]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Dönem")],-1)),n(l("input",{type:"month","onUpdate:modelValue":a[3]||(a[3]=e=>D.value.period=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300"},null,512),[[s,D.value.period]])]),l("div",ut,[a[15]||(a[15]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Okuma Tarihi")],-1)),n(l("input",{type:"date","onUpdate:modelValue":a[4]||(a[4]=e=>D.value.readingDate=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300"},null,512),[[s,D.value.readingDate]])]),l("div",ct,[l("label",gt,[l("span",bt," Sayaç Değeri ("+o("Electricity"===D.value.type?"kWh":"m³")+") ",1)]),n(l("input",{type:"number","onUpdate:modelValue":a[5]||(a[5]=e=>D.value.readingValue=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",step:"0.01",min:"0"},null,512),[[s,D.value.readingValue,void 0,{number:!0}]])]),M.value&&C.value?(r(),t("div",pt,[a[16]||(a[16]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Önceki Okuma")],-1)),l("input",{type:"number",value:C.value.readingValue,class:"input input-bordered w-full bg-gray-100 dark:bg-gray-600 border-gray-300 dark:border-gray-600 text-gray-500 dark:text-gray-400",disabled:""},null,8,vt)])):b("",!0),M.value&&C.value?(r(),t("div",yt,[l("label",mt,[l("span",kt," Tüketim ("+o("Electricity"===D.value.type?"kWh":"m³")+") ",1)]),l("input",{type:"number",value:R.value,class:"input input-bordered w-full bg-blue-50 dark:bg-blue-900/20 border-blue-300 dark:border-blue-600 text-blue-700 dark:text-blue-300",disabled:""},null,8,xt)])):b("",!0),l("div",wt,[a[17]||(a[17]=l("label",{class:"label"},[l("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Not")],-1)),n(l("textarea",{"onUpdate:modelValue":a[6]||(a[6]=e=>D.value.note=e),class:"textarea textarea-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300",placeholder:"Sayaç okuması hakkında not...",rows:"3"},null,512),[[s,D.value.note]])])]),l("div",ht,[l("div",ft,[l("button",{class:"btn btn-primary btn-sm",onClick:j,disabled:!S.value||x.value},[x.value?(r(),t("div",Ct)):(r(),t("svg",Dt,a[18]||(a[18]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1)]))),g(" "+o(M.value?"Güncelle":"Kaydet"),1)],8,Vt)]),l("button",{class:"btn btn-outline btn-sm",onClick:a[7]||(a[7]=a=>e.$emit("close"))},a[19]||(a[19]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),g(" Kapat ")]))])])]))}},St={class:"p-4 sm:p-6 bg-gray-50 min-h-screen font-sans dark:bg-gray-900"},Rt={class:"max-w-7xl mx-auto"},Tt={key:0,class:"mb-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},Ut={key:1,class:"mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4"},jt={class:"flex items-center gap-3"},Ht={class:"text-red-700 dark:text-red-300"},Et={key:2,class:"mb-6 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4"},Nt={class:"flex items-center justify-between"},Bt={class:"flex items-center gap-3"},It={class:"text-green-700 dark:text-green-300"},At={class:"text-sm text-green-600 dark:text-green-400"},Lt={class:"mb-6"},Kt={class:"border-b border-gray-200 dark:border-gray-700"},Ot={class:"-mb-px flex space-x-8"},zt={key:3},$t={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Wt={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},Yt={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},_t={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},Ft={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},Pt={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},Gt={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},qt={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center justify-center border-2 border-dashed border-gray-300 dark:border-gray-600"},Jt={class:"flex flex-col gap-2 w-full"},Qt={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200 dark:border-gray-700"},Xt={class:"mt-6 space-y-2"},Zt={key:0,class:"text-center py-12 text-gray-500 dark:text-gray-400"},er={key:1},ar={class:"md:col-span-3 flex items-center gap-4"},tr={class:"flex-shrink-0 h-12 w-12 flex items-center justify-center bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full text-2xl"},rr={class:"font-bold text-gray-800 dark:text-gray-100"},lr={class:"text-sm text-gray-500 dark:text-gray-400"},dr={class:"text-xs text-gray-400 dark:text-gray-500"},nr={class:"md:col-span-2 text-center"},sr={class:"font-semibold"},or={class:"md:col-span-2 text-center"},ir={class:"font-semibold text-lg"},ur={class:"md:col-span-2 text-center"},cr={class:"font-semibold text-lg text-sky-600 dark:text-sky-400"},gr={class:"md:col-span-2 text-center"},br=["title"],pr={key:1,class:"text-sm text-gray-400"},vr={class:"md:col-span-1 text-right"},yr={class:"dropdown dropdown-end"},mr={tabindex:"0",class:"dropdown-content menu p-2 shadow bg-base-200 rounded-box w-32 z-10"},kr=["onClick"],xr=["onClick"],wr={key:4},hr={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},fr={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},Vr={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},Cr={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},Dr={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},Mr={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},Sr={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},Rr={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center justify-center border-2 border-dashed border-gray-300 dark:border-gray-600"},Tr={class:"flex flex-col gap-2 w-full"},Ur={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200 dark:border-gray-700"},jr={class:"mt-4 flex flex-wrap gap-2 items-center border-t dark:border-gray-700 pt-4"},Hr=["disabled"],Er=["disabled"],Nr={class:"mt-6 space-y-2"},Br={key:0,class:"text-center py-12 text-gray-500 dark:text-gray-400"},Ir={key:1},Ar={class:"md:col-span-4 flex items-center gap-4"},Lr={class:"flex-shrink-0 h-12 w-12 flex items-center justify-center bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full text-2xl"},Kr={class:"font-bold text-gray-800 dark:text-gray-100"},Or={class:"text-sm text-gray-500 dark:text-gray-400"},zr={key:0,class:"text-xs text-gray-400 dark:text-gray-500"},$r={class:"md:col-span-3 text-left md:text-center text-lg font-semibold text-gray-700 dark:text-gray-200"},Wr={class:"md:col-span-3 text-left md:text-center text-xl font-bold text-sky-600 dark:text-sky-400"},Yr={class:"md:col-span-2 text-center"},_r={key:0,class:"badge badge-success badge-sm"},Fr={key:1,class:"badge badge-warning badge-sm"},Pr={key:2,class:"badge badge-error badge-sm"},Gr={class:"md:col-span-2 text-right"},qr={class:"dropdown dropdown-end"},Jr={tabindex:"0",class:"dropdown-content menu p-2 shadow bg-base-200 rounded-box w-32 z-10"},Qr=["onClick"],Xr=["onClick"],Zr=["open"],el={class:"modal-box"},al={class:"form-control mb-2"},tl={class:"form-control mb-4"},rl={class:"modal-action"},ll={__name:"Utilities",setup(d){const{handleNetworkError:p,showSuccess:v}=f(),y=e("meter-readings"),h=e([]),V=e(""),C=e(""),D=e("all"),T=e(!1),j=e(null),H=e([]),E=e("all"),N=e(!1),B=e(!1),I=e(!1),A=e(!1),L=e(!1),K=e(!1),O=e(!1),z=e(null),$=e(null),W=e(null),Y=[{value:"all",label:"Tümü"},{value:"Electricity",label:"Elektrik"},{value:"Water",label:"Su"}],_=[{value:"all",label:"Tümü"},{value:"Electricity",label:"Elektrik"},{value:"Water",label:"Su"},{value:"Aidat",label:"Aidat"},{value:"OwnerAidat",label:"Mal Sahibi Aidatı"}],F=c(()=>h.value.filter(e=>{const a=e.flatNumber||"",t=""===V.value||a.toLowerCase().includes(V.value.toLowerCase()),r=!C.value||`${e.periodYear}-${e.periodMonth.toString().padStart(2,"0")}`===C.value,l="all"===D.value||e.type===D.value;return t&&r&&l}).sort((e,a)=>new Date(a.readingDate)-new Date(e.readingDate))),P=c(()=>H.value.filter(e=>{const a=e.tenantName||e.ownerName||"",t=""===V.value||a.toLowerCase().includes(V.value.toLowerCase()),r=!C.value||e.period===C.value,l="all"===E.value||e.utilityType===E.value;return t&&r&&l}).sort((e,a)=>(a.period+(e.tenantName||e.ownerName)).localeCompare(e.period+(a.tenantName||a.ownerName)))),G=c(()=>{const e=new Date,a=e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0");return P.value.filter(e=>e.period===a).reduce((e,a)=>e+Number(a.amount||0),0)}),q=c(()=>{const e=new Date,a=e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0");return P.value.filter(e=>e.period===a&&"Electricity"===e.utilityType).reduce((e,a)=>e+Number(a.consumption||0),0)}),J=c(()=>{const e=new Date,a=e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0");return P.value.filter(e=>e.period===a&&"Water"===e.utilityType).reduce((e,a)=>e+Number(a.consumption||0),0)}),Q=(e,a)=>null==e||isNaN(e)?"-":`${Number(e).toFixed(0)} ${a}`,Z=e=>null==e||isNaN(e)?"₺0.00":Number(e).toLocaleString("tr-TR",{style:"currency",currency:"TRY"}),ee=e({loading:!1,error:null,lastUpdated:null}),ae=e([]),te=async()=>{ee.value.loading=!0;try{const e=await U.getMeterReadings();h.value=e||[],ee.value.error=null,ee.value.lastUpdated=(new Date).toLocaleString("tr-TR")}catch(e){p(e,{component:"Utilities",action:"fetchMeterReadings"}),ee.value.error=e.message,h.value=[]}finally{ee.value.loading=!1}},re=async()=>{ee.value.loading=!0;try{const e=await S.getUtilityDebts();H.value=e||[],ee.value.error=null,ee.value.lastUpdated=(new Date).toLocaleString("tr-TR")}catch(e){p(e,{component:"Utilities",action:"fetchUtilityDebts"}),ee.value.error=e.message,H.value=[]}finally{ee.value.loading=!1}},le=e=>{N.value=!1,B.value=!1,T.value=!1,j.value=null,e&&(te(),re())},de=async()=>{if(C.value){if(confirm(`${C.value} dönemindeki tüm kayıtları silmek istediğinizden emin misiniz? Bu işlem geri alınamaz.`))try{await S.deleteUtilityDebtsByPeriod(C.value),v(`${C.value} dönemi kayıtları`),await re()}catch(e){alert("Kayıtlar silinirken bir hata oluştu.")}}else alert("Lütfen silinecek dönemi seçin.")},ne=async()=>{if(!C.value)return void alert("Lütfen bir dönem seçin.");const e=H.value.filter(e=>e.period===C.value&&"Electricity"===e.utilityType);e.length>0?(z.value=e,A.value=!0):alert("Bu dönem için düzenlenecek elektrik kaydı bulunamadı.")},se=async()=>{if(!C.value||"all"===E.value||"Electricity"!==E.value&&"Water"!==E.value)alert("Lütfen dönem ve gider tipi olarak Elektrik veya Su seçiniz.");else try{await S.distributeSharedExpense(C.value,E.value),v("Ortak gider başarıyla paylaştırıldı."),O.value=!1,await re()}catch(e){alert("Ortak gider paylaştırılırken bir hata oluştu.")}},oe=()=>{V.value="",C.value="",D.value="all",E.value="all"};return a(()=>{(async()=>{try{const e=await R.getTenants();ae.value=e||[]}catch(e){p(e,{component:"Utilities",action:"fetchTenants"}),ae.value=[]}})(),te(),re()}),(e,a)=>(r(),t("div",St,[l("div",Rt,[a[42]||(a[42]=l("h1",{class:"text-3xl font-bold text-gray-800 mb-6 dark:text-gray-100"},"Sayaç Okumaları ve Faturalar",-1)),ee.value.loading?(r(),t("div",Tt,a[19]||(a[19]=[l("div",{class:"flex items-center gap-3"},[l("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),l("span",{class:"text-blue-700 dark:text-blue-300"},"Veriler yükleniyor...")],-1)]))):b("",!0),ee.value.error?(r(),t("div",Ut,[l("div",jt,[a[20]||(a[20]=l("div",{class:"bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-400 rounded-full p-1"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),l("span",Ht,o(ee.value.error),1)])])):b("",!0),ee.value.lastUpdated?(r(),t("div",Et,[l("div",Nt,[l("div",Bt,[a[21]||(a[21]=l("div",{class:"bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 rounded-full p-1"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"})])],-1)),l("span",It," Son güncelleme: "+o(ee.value.lastUpdated),1)]),l("div",At,o(h.value.length)+" sayaç okuması, "+o(H.value.length)+" fatura ",1)])])):b("",!0),l("div",Lt,[l("div",Kt,[l("nav",Ot,[l("button",{onClick:a[0]||(a[0]=e=>y.value="meter-readings"),class:x(["meter-readings"===y.value?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300","whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"])}," 📊 Sayaç Okumaları ",2),l("button",{onClick:a[1]||(a[1]=e=>y.value="utility-debts"),class:x(["utility-debts"===y.value?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300","whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"])}," 💰 Faturalar ",2)])])]),"meter-readings"===y.value?(r(),t("div",zt,[l("section",$t,[l("div",Wt,[a[23]||(a[23]=l("div",{class:"bg-cyan-100 dark:bg-cyan-900/50 text-cyan-600 dark:text-cyan-400 rounded-full p-3"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),l("div",null,[a[22]||(a[22]=l("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Toplam Sayaç Okuması",-1)),l("p",Yt,o(h.value.length),1)])]),l("div",_t,[a[25]||(a[25]=l("div",{class:"bg-amber-100 dark:bg-amber-900/50 text-amber-600 dark:text-amber-400 rounded-full p-3"},[l("span",{class:"text-2xl"},"⚡️")],-1)),l("div",null,[a[24]||(a[24]=l("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Elektrik Tüketimi",-1)),l("p",Ft,o(Q(q.value,"kWh")),1)])]),l("div",Pt,[a[27]||(a[27]=l("div",{class:"bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 rounded-full p-3"},[l("span",{class:"text-2xl"},"💧")],-1)),l("div",null,[a[26]||(a[26]=l("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Su Tüketimi",-1)),l("p",Gt,o(Q(J.value,"m³")),1)])]),l("div",qt,[l("div",Jt,[l("button",{class:"btn btn-primary btn-sm w-full",onClick:a[2]||(a[2]=e=>N.value=!0)},"⚡ Elektrik Okuması"),l("button",{class:"btn btn-secondary btn-sm w-full",onClick:a[3]||(a[3]=e=>B.value=!0)},"💧 Su Okuması")])])]),l("div",Qt,[w(M,{search:V.value,"onUpdate:search":a[4]||(a[4]=e=>V.value=e),"search-placeholder":"Daire ara...",period:C.value,"onUpdate:period":a[5]||(a[5]=e=>C.value=e),"select-type":D.value,"onUpdate:selectType":a[6]||(a[6]=e=>D.value=e),"select-type-options":Y,onClearFilters:oe},null,8,["search","period","select-type"]),l("div",Xt,[0===F.value.length?(r(),t("div",Zt,a[28]||(a[28]=[l("p",null,"Aramanızla eşleşen sayaç okuması bulunamadı.",-1)]))):(r(),t("div",er,[(r(!0),t(i,null,u(F.value,e=>{return r(),t("div",{key:e.id,class:"grid grid-cols-1 md:grid-cols-12 gap-4 items-center p-4 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-200 border-b dark:border-gray-700/50"},[l("div",ar,[l("div",tr,o((s=e.type,{Electricity:"⚡️",Water:"💧"}[s]||"❓")),1),l("div",null,[l("p",rr,o(e.flatNumber),1),l("p",lr,o("Electricity"===e.type?"Elektrik":"Su"),1),l("p",dr,o((n=e.readingDate,n?new Date(n).toLocaleDateString("tr-TR"):"-")),1)])]),l("div",nr,[a[29]||(a[29]=l("span",{class:"text-sm text-gray-500"},"Dönem:",-1)),l("p",sr,o(e.periodYear)+"/"+o(e.periodMonth.toString().padStart(2,"0")),1)]),l("div",or,[a[30]||(a[30]=l("span",{class:"text-sm text-gray-500"},"Sayaç Değeri:",-1)),l("p",ir,o((d=e.readingValue,null==d||isNaN(d)?"-":Number(d).toLocaleString("tr-TR"))),1)]),l("div",ur,[a[31]||(a[31]=l("span",{class:"text-sm text-gray-500"},"Tüketim:",-1)),l("p",cr,o(Q(e.consumption,"Electricity"===e.type?"kWh":"m³")),1)]),l("div",gr,[e.note?(r(),t("p",{key:0,class:"text-sm text-gray-600 dark:text-gray-400 truncate",title:e.note},o(e.note),9,br)):(r(),t("p",pr,"Not yok"))]),l("div",vr,[l("div",yr,[a[32]||(a[32]=l("label",{tabindex:"0",class:"btn btn-ghost btn-sm"},"İşlemler",-1)),l("ul",mr,[l("li",null,[l("a",{onClick:a=>(e=>{D.value=e.type,j.value=e,T.value=!0})(e)},"Düzenle",8,kr)]),l("li",null,[l("a",{onClick:a=>(async e=>{if(confirm("Bu sayaç okumasını silmek istediğinizden emin misiniz?"))try{await U.deleteMeterReading(e),v("Sayaç okuması"),await te()}catch(a){alert("Sayaç okuması silinirken bir hata oluştu.")}})(e.id),class:"text-red-500"},"Sil",8,xr)])])])])]);var d,n,s}),128))]))])])])):b("",!0),"utility-debts"===y.value?(r(),t("div",wr,[l("section",hr,[l("div",fr,[a[34]||(a[34]=l("div",{class:"bg-cyan-100 dark:bg-cyan-900/50 text-cyan-600 dark:text-cyan-400 rounded-full p-3"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),l("div",null,[a[33]||(a[33]=l("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Bu Ayki Fatura Toplamı",-1)),l("p",Vr,o(Z(G.value)),1)])]),l("div",Cr,[a[36]||(a[36]=l("div",{class:"bg-amber-100 dark:bg-amber-900/50 text-amber-600 dark:text-amber-400 rounded-full p-3"},[l("span",{class:"text-2xl"},"⚡️")],-1)),l("div",null,[a[35]||(a[35]=l("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Aylık Elektrik Tüketimi",-1)),l("p",Dr,o(Q(q.value,"kWh")),1)])]),l("div",Mr,[a[38]||(a[38]=l("div",{class:"bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 rounded-full p-3"},[l("span",{class:"text-2xl"},"💧")],-1)),l("div",null,[a[37]||(a[37]=l("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Aylık Su Tüketimi",-1)),l("p",Sr,o(Q(J.value,"m³")),1)])]),l("div",Rr,[l("div",Tr,[l("button",{class:"btn btn-accent btn-sm w-full",onClick:a[7]||(a[7]=e=>I.value=!0)},"💰 Aidat Girişi"),l("button",{onClick:a[8]||(a[8]=e=>O.value=!0),class:"btn btn-warning btn-sm w-full"},"Ortak Gider Paylaştır")])])]),l("div",Ur,[w(M,{search:V.value,"onUpdate:search":a[9]||(a[9]=e=>V.value=e),"search-placeholder":"Şirket Ara...",period:C.value,"onUpdate:period":a[10]||(a[10]=e=>C.value=e),"select-type":E.value,"onUpdate:selectType":a[11]||(a[11]=e=>E.value=e),"select-type-options":_,onClearFilters:oe},null,8,["search","period","select-type"]),l("div",jr,[l("button",{class:"btn btn-error btn-sm",onClick:de,disabled:!C.value},"Dönemi Sil",8,Hr),l("button",{class:"btn btn-outline btn-sm",onClick:ne,disabled:!C.value},"Toplu Elektrik Düzenle",8,Er)]),l("div",Nr,[0===P.value.length?(r(),t("div",Br,a[39]||(a[39]=[l("p",null,"Aramanızla eşleşen fatura bulunamadı.",-1)]))):(r(),t("div",Ir,[(r(!0),t(i,null,u(P.value,e=>{return r(),t("div",{key:e.id,class:"grid grid-cols-1 md:grid-cols-12 gap-4 items-center p-4 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-200 border-b dark:border-gray-700/50"},[l("div",Ar,[l("div",Lr,o((d=e.utilityType,{Electricity:"⚡️",Water:"💧",Aidat:"💰",OwnerAidat:"🏠"}[d]||"❓")),1),l("div",null,[l("p",Kr,o(e.tenantName||e.ownerName||"-"),1),l("p",Or,"Dönem: "+o(e.period),1),e.flatNumber?(r(),t("p",zr,"Daire: "+o(e.flatNumber),1)):b("",!0)])]),l("div",$r,[a[40]||(a[40]=l("span",{class:"font-normal text-sm text-gray-500"},"Tüketim:",-1)),g(" "+o(Q(e.consumption,"Electricity"===e.utilityType?"kWh":"Water"===e.utilityType?"m³":"")),1)]),l("div",Wr,o(Z(e.amount)),1),l("div",Yr,[e.isPaid?(r(),t("div",_r,"Ödendi")):e.paidAmount&&e.paidAmount>0?(r(),t("div",Fr,"Kısmi Ödeme")):(r(),t("div",Pr,"Ödenmedi"))]),l("div",Gr,[l("div",qr,[a[41]||(a[41]=l("label",{tabindex:"0",class:"btn btn-ghost btn-sm"},"İşlemler",-1)),l("ul",Jr,[l("li",null,[l("a",{onClick:a=>(e=>{"Electricity"===e.utilityType?(z.value=e,A.value=!0):"Water"===e.utilityType?($.value=e,L.value=!0):"Aidat"===e.utilityType?(W.value=e,K.value=!0):"OwnerAidat"===e.utilityType&&alert(`Mal Sahibi Aidatı - ${e.flatNumber}\nDönem: ${e.period}\nTutar: ${Z(e.amount)}`)})(e)},"Düzenle",8,Qr)]),l("li",null,[l("a",{onClick:a=>(async e=>{if(confirm("Bu kaydı silmek istediğinizden emin misiniz?"))try{await S.deleteUtilityDebt(e),v("Utility Debt"),await re()}catch(a){alert("Kayıt silinirken bir hata oluştu.")}})(e.id),class:"text-red-500"},"Sil",8,Xr)])])])])]);var d}),128))]))])])])):b("",!0)]),T.value?(r(),k(Mt,{key:0,reading:j.value,onClose:le},null,8,["reading"])):b("",!0),N.value?(r(),k(X,{key:1,onClose:le})):b("",!0),B.value?(r(),k(he,{key:2,onClose:le})):b("",!0),I.value?(r(),k(Te,{key:3,onClose:a[12]||(a[12]=()=>I.value=!1),onRefresh:re})):b("",!0),A.value?(r(),k(ia,{key:4,record:z.value,onClose:a[13]||(a[13]=()=>{A.value=!1,z.value=null}),onUpdated:re},null,8,["record"])):b("",!0),L.value?(r(),k(Ia,{key:5,record:$.value,onClose:a[14]||(a[14]=()=>{L.value=!1,$.value=null}),onUpdated:re},null,8,["record"])):b("",!0),K.value?(r(),k(Qa,{key:6,record:W.value,onClose:a[15]||(a[15]=()=>{K.value=!1,W.value=null}),onUpdated:re},null,8,["record"])):b("",!0),l("dialog",{id:"distributeModal",class:"modal",open:O.value},[l("div",el,[a[46]||(a[46]=l("h3",{class:"font-bold text-lg mb-4"},"Ortak Gider Paylaştır",-1)),l("div",al,[a[43]||(a[43]=l("label",{class:"label"},"Dönem",-1)),n(l("input",{type:"month","onUpdate:modelValue":a[16]||(a[16]=e=>C.value=e),class:"input input-bordered"},null,512),[[s,C.value]])]),l("div",tl,[a[45]||(a[45]=l("label",{class:"label"},"Gider Tipi",-1)),n(l("select",{"onUpdate:modelValue":a[17]||(a[17]=e=>E.value=e),class:"select select-bordered"},a[44]||(a[44]=[l("option",{value:"Electricity"},"Elektrik",-1),l("option",{value:"Water"},"Su",-1)]),512),[[m,E.value]])]),l("div",rl,[l("button",{onClick:se,class:"btn btn-success"},"Paylaştır"),l("button",{onClick:a[18]||(a[18]=e=>O.value=!1),class:"btn"},"Kapat")])])],8,Zr)]))}};export{ll as default};
