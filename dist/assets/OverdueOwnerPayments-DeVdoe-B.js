import{r as e,c as a,o as t,b as l,e as r,t as s,G as o,H as d,I as n,E as u,j as i,F as c,i as p,m as g,q as v}from"./vue-vendor-Ozfyq2CR.js";import{a as y,b}from"./index-CZWRhATJ.js";import"./utils-vendor-Cy2sLATb.js";const m={class:"p-4 sm:p-6 bg-gray-50 min-h-screen font-sans dark:bg-gray-900"},x={class:"max-w-7xl mx-auto"},k={class:"flex items-center justify-between mb-6"},w={class:"flex items-center gap-4"},f={class:"bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-400 px-3 py-1 rounded-full text-sm"},h={class:"bg-orange-100 dark:bg-orange-900/50 text-orange-600 dark:text-orange-400 px-3 py-1 rounded-full text-sm"},D={class:"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-600 dark:text-yellow-400 px-3 py-1 rounded-full text-sm"},S={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200 dark:border-gray-700 mb-6"},T={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},C={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md border border-gray-200 dark:border-gray-700 overflow-hidden"},N={class:"overflow-x-auto"},G={class:"table w-full"},j={class:"p-4"},z={class:"font-medium text-gray-800 dark:text-gray-100"},L={class:"text-sm text-gray-500 dark:text-gray-400"},E={class:"p-4 text-gray-800 dark:text-gray-100"},M={class:"p-4"},O={class:"p-4"},U={class:"font-semibold text-red-600 dark:text-red-400"},V={class:"p-4 text-gray-800 dark:text-gray-100"},A={class:"p-4"},B={class:"p-4"},I={class:"flex items-center gap-2"},R=["onClick"],H=["onClick"],$=["onClick"],_={key:0,class:"text-center py-12"},q={__name:"OverdueOwnerPayments",setup(q){const F=e([]),K=e([]),P=e(!1),Y=e(""),{notifySuccess:J}=b(),Q=e(""),W=e(""),X=e("dueDate"),Z=e=>null==e||isNaN(e)?"₺0.00":Number(e).toLocaleString("tr-TR",{style:"currency",currency:"TRY"}),ee=async()=>{P.value=!0;try{const e=await y.get("/owner-payments/overdue");F.value=(e||[]).map(e=>{const a=K.value.find(a=>a.id===e.ownerId);return{...e,ownerName:(null==a?void 0:a.name)||"Bilinmiyor"}})}catch(e){F.value=[]}finally{P.value=!1}},ae=a(()=>F.value.reduce((e,a)=>e+Number(a.amount||0),0)),te=a(()=>F.value.length),le=a(()=>0===te.value?0:ae.value/te.value),re=a(()=>{let e=F.value;if(Y.value){const a=Y.value.toLowerCase();e=e.filter(e=>e.ownerName.toLowerCase().includes(a)||e.unit.toLowerCase().includes(a))}if(Q.value){const a=parseInt(Q.value);e=e.filter(e=>e.overdueDays>=a)}return W.value&&(e=e.filter(e=>e.type===W.value)),e.sort((e,a)=>{switch(X.value){case"amount":return a.amount-e.amount;case"overdueDays":return a.overdueDays-e.overdueDays;default:return new Date(e.dueDate)-new Date(a.dueDate)}}),e});return t(()=>{(async()=>{try{const e=await y.get("/owners");K.value=e||[]}catch(e){K.value=[]}})().then(()=>ee())}),(e,a)=>(g(),l("div",m,[r("div",x,[r("div",k,[a[4]||(a[4]=r("h1",{class:"text-3xl font-bold text-gray-800 dark:text-gray-100"},"Geciken Mal Sahibi Ödemeleri",-1)),r("div",w,[r("div",f," Toplam: "+s(Z(e.totalOverdue)),1),r("div",h,s(te.value)+" geciken ödeme ",1),r("div",D," Ortalama: "+s(Z(le.value)),1)])]),r("div",S,[r("div",T,[r("div",null,[a[5]||(a[5]=r("label",{class:"label"},"Arama",-1)),o(r("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>Y.value=e),type:"text",placeholder:"Mal sahibi adı veya kat ara...",class:"input input-bordered w-full"},null,512),[[d,Y.value]])]),r("div",null,[a[7]||(a[7]=r("label",{class:"label"},"Gecikme Süresi",-1)),o(r("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>Q.value=e),class:"select select-bordered w-full"},a[6]||(a[6]=[u('<option value="">Tümü</option><option value="7">7 günden fazla</option><option value="15">15 günden fazla</option><option value="30">30 günden fazla</option><option value="60">60 günden fazla</option>',5)]),512),[[n,Q.value]])]),r("div",null,[a[9]||(a[9]=r("label",{class:"label"},"Ödeme Türü",-1)),o(r("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>W.value=e),class:"select select-bordered w-full"},a[8]||(a[8]=[u('<option value="">Tümü</option><option value="aidat">Aidat</option><option value="su">Su</option><option value="elektrik">Elektrik</option><option value="diger">Diğer</option>',5)]),512),[[n,W.value]])]),r("div",null,[a[11]||(a[11]=r("label",{class:"label"},"Sıralama",-1)),o(r("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>X.value=e),class:"select select-bordered w-full"},a[10]||(a[10]=[r("option",{value:"dueDate"},"Son Ödeme Tarihi",-1),r("option",{value:"amount"},"Tutar",-1),r("option",{value:"overdueDays"},"Gecikme Günü",-1)]),512),[[n,X.value]])])])]),r("div",C,[r("div",N,[r("table",G,[a[12]||(a[12]=r("thead",{class:"bg-gray-50 dark:bg-gray-700"},[r("tr",null,[r("th",{class:"text-left p-4"},"Mal Sahibi"),r("th",{class:"text-left p-4"},"Kat"),r("th",{class:"text-left p-4"},"Ödeme Türü"),r("th",{class:"text-left p-4"},"Tutar"),r("th",{class:"text-left p-4"},"Son Ödeme"),r("th",{class:"text-left p-4"},"Gecikme"),r("th",{class:"text-left p-4"},"İşlemler")])],-1)),r("tbody",null,[(g(!0),l(c,null,p(re.value,e=>{return g(),l("tr",{key:e.id,class:"border-b border-gray-200 dark:border-gray-700 hover:bg-red-50 dark:hover:bg-red-900/20"},[r("td",j,[r("div",null,[r("p",z,s(e.ownerName),1),r("p",L,s(e.ownerEmail),1)])]),r("td",E,s(e.unit),1),r("td",M,[r("span",{class:v([{"bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-400":"aidat"===e.type,"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-400":"su"===e.type,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-400":"elektrik"===e.type,"bg-gray-100 text-gray-800 dark:bg-gray-900/50 dark:text-gray-400":"diger"===e.type},"px-2 py-1 rounded-full text-xs font-medium"])},s((t=e.type,{aidat:"Aidat",su:"Su",elektrik:"Elektrik",diger:"Diğer"}[t]||"Bilinmiyor")),3)]),r("td",O,[r("span",U,s(Z(e.amount)),1)]),r("td",V,s((a=e.dueDate,a?new Date(a).toLocaleDateString("tr-TR",{year:"numeric",month:"short",day:"numeric"}):"-")),1),r("td",A,[r("span",{class:v([{"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-400":e.overdueDays>30,"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-400":e.overdueDays>15&&e.overdueDays<=30,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-400":e.overdueDays<=15},"px-2 py-1 rounded-full text-xs font-medium"])},s(e.overdueDays)+" gün ",3)]),r("td",B,[r("div",I,[r("button",{onClick:a=>(async e=>{try{await y.put(`/owner-payments/${e}`,{status:"paid"}),await ee()}catch(a){}})(e.id),class:"btn btn-sm btn-success"}," Ödendi ",8,R),r("button",{onClick:a=>(e=>{J(`${e.ownerName} için hatırlatma gönderildi.`)})(e),class:"btn btn-sm btn-warning"}," Hatırlat ",8,H),r("button",{onClick:e=>{},class:"btn btn-sm btn-outline"}," Detay ",8,$)])])]);var a,t}),128))])])]),0===re.value.length?(g(),l("div",_,a[13]||(a[13]=[r("div",{class:"bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 rounded-full p-3 w-fit mx-auto mb-3"},[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1),r("p",{class:"text-gray-500 dark:text-gray-400"},"Geciken ödeme bulunmuyor.",-1)]))):i("",!0)])])]))}};export{q as default};
