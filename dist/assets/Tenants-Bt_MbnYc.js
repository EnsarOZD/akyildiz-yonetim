import{r as e,w as a,b as t,m as l,j as r,e as o,p as s,s as n,G as i,H as c,I as d,E as u,J as b,c as m,o as g,F as v,i as y,t as p,f,n as x,u as k,l as h,q as w}from"./vue-vendor-Bart4FG5.js";import{u as N,R as A,e as T}from"./index-BbOmoSe-.js";import{t as P}from"./tenantsService-DJ11mlzP.js";import{u as C,a as E,g as j,b as I}from"./uiHelpers-DqgNUpgi.js";import{_ as D}from"./ConfirmDeleteModal-OapZcbNC.js";import"./utils-vendor-Cy2sLATb.js";const M=["open"],B={key:0,class:"modal-box max-w-4xl bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border border-gray-200 dark:border-gray-700 shadow-2xl"},S={class:"flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700 mb-6"},z={class:"overflow-y-auto max-h-[70vh] pr-2"},V={class:"card bg-base-200 p-4"},K={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},U={class:"form-control"},X={class:"form-control"},$={class:"form-control"},F={class:"card bg-base-200 p-4"},H={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},q={class:"form-control"},L={class:"form-control"},O={class:"form-control md:col-span-2"},G={class:"card bg-base-200 p-4"},Y={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},_={class:"form-control"},R={class:"form-control md:col-span-2"},J={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700 mt-6"},W={__name:"TenantEditModal",props:{tenant:Object,visible:Boolean},emits:["save","close"],setup(m,{emit:g}){const v=m,y=g,p=e(null);a(()=>v.tenant,e=>{p.value=e?{id:e.id,companyName:e.companyName||"",businessType:e.businessType||"",identityNumber:e.identityNumber||"",contactPersonName:e.contactPersonName||"",contactPersonPhone:e.contactPersonPhone||"",contactPersonEmail:e.contactPersonEmail||"",monthlyAidat:Number(e.monthlyAidat??0),isActive:Boolean(e.isActive)}:null},{immediate:!0});const f=()=>{const e=p.value;if(!e)return;const a={id:e.id,companyName:e.companyName.trim(),businessType:e.businessType,identityNumber:e.identityNumber.trim(),contactPersonName:e.contactPersonName.trim(),contactPersonPhone:e.contactPersonPhone.trim(),contactPersonEmail:e.contactPersonEmail.trim(),monthlyAidat:Number(e.monthlyAidat??0),isActive:Boolean(e.isActive)};y("save",a)};return(e,a)=>(l(),t("dialog",{id:"editTenantModal",class:"modal",open:m.visible},[p.value?(l(),t("div",B,[o("div",S,[a[11]||(a[11]=o("h3",{class:"text-xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2"},[o("span",{class:"text-2xl"},"âœï¸"),s(" Ä°ÅŸ Yeri KiracÄ±sÄ± Bilgilerini GÃ¼ncelle ")],-1)),o("button",{onClick:a[0]||(a[0]=a=>e.$emit("close")),class:"btn btn-sm btn-ghost text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},a[10]||(a[10]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),o("div",z,[o("form",{onSubmit:n(f,["prevent"]),class:"space-y-6"},[o("div",V,[a[16]||(a[16]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ¢ Ä°ÅŸ Yeri Bilgileri",-1)),o("div",K,[o("div",U,[a[12]||(a[12]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"Åžirket AdÄ± *")],-1)),i(o("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>p.value.companyName=e),class:"input input-bordered w-full bg-white dark:bg-gray-700",required:""},null,512),[[c,p.value.companyName,void 0,{trim:!0}]])]),o("div",X,[a[14]||(a[14]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"Ä°ÅŸ TÃ¼rÃ¼ *")],-1)),i(o("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>p.value.businessType=e),class:"select select-bordered w-full bg-white dark:bg-gray-700",required:""},a[13]||(a[13]=[u('<option value="">Ä°ÅŸ tÃ¼rÃ¼ seÃ§in</option><option value="Ticaret">Ticaret</option><option value="Hizmet">Hizmet</option><option value="Ãœretim">Ãœretim</option><option value="Ofis">Ofis</option><option value="Depo">Depo</option><option value="DiÄŸer">DiÄŸer</option>',7)]),512),[[d,p.value.businessType]])]),o("div",$,[a[15]||(a[15]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"Kimlik/Vergi NumarasÄ± *")],-1)),i(o("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>p.value.identityNumber=e),class:"input input-bordered w-full bg-white dark:bg-gray-700",placeholder:"TC veya Vergi No",inputmode:"numeric",required:""},null,512),[[c,p.value.identityNumber]])])])]),o("div",F,[a[20]||(a[20]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ‘¤ Ä°letiÅŸim KiÅŸisi",-1)),o("div",H,[o("div",q,[a[17]||(a[17]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"Ad Soyad *")],-1)),i(o("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>p.value.contactPersonName=e),class:"input input-bordered w-full bg-white dark:bg-gray-700",required:""},null,512),[[c,p.value.contactPersonName,void 0,{trim:!0}]])]),o("div",L,[a[18]||(a[18]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"Telefon *")],-1)),i(o("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>p.value.contactPersonPhone=e),class:"input input-bordered w-full bg-white dark:bg-gray-700",placeholder:"+90 (5XX) XXX XX XX",required:""},null,512),[[c,p.value.contactPersonPhone,void 0,{trim:!0}]])]),o("div",O,[a[19]||(a[19]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"E-posta")],-1)),i(o("input",{type:"email","onUpdate:modelValue":a[6]||(a[6]=e=>p.value.contactPersonEmail=e),class:"input input-bordered w-full bg-white dark:bg-gray-700",placeholder:"ornek@email.com"},null,512),[[c,p.value.contactPersonEmail,void 0,{trim:!0}]])])])]),o("div",G,[a[23]||(a[23]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ’° Aidat & Durum",-1)),o("div",Y,[o("div",_,[a[21]||(a[21]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"AylÄ±k Aidat (â‚º) *")],-1)),i(o("input",{type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>p.value.monthlyAidat=e),min:"0",step:"0.01",class:"input input-bordered w-full bg-white dark:bg-gray-700",required:""},null,512),[[c,p.value.monthlyAidat,void 0,{number:!0}]])]),o("div",R,[a[22]||(a[22]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"Aktif")],-1)),i(o("input",{type:"checkbox","onUpdate:modelValue":a[8]||(a[8]=e=>p.value.isActive=e),class:"toggle toggle-success"},null,512),[[b,p.value.isActive]])])])])],32)]),o("div",J,[o("button",{type:"button",onClick:a[9]||(a[9]=a=>e.$emit("close")),class:"btn btn-outline"},"Ä°ptal"),o("button",{onClick:f,class:"btn btn-primary"},"GÃ¼ncelle")])])):r("",!0)],8,M))}},Q=e(new Map);function Z(){const e=(e,a)=>{Q.value.has(e)||Q.value.set(e,[]),Q.value.get(e).push(a)},a=(e,a)=>{if(Q.value.has(e)){const t=Q.value.get(e),l=t.indexOf(a);l>-1&&t.splice(l,1)}};return{on:e,off:a,emit:(e,a)=>{Q.value.has(e)&&Q.value.get(e).forEach(e=>{try{e(a)}catch(t){}})},once:(t,l)=>{const r=e=>{l(e),a(t,r)};e(t,r)}}}const ee=["open"],ae={class:"modal-box max-w-4xl bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border border-gray-200 dark:border-gray-700 shadow-2xl"},te={class:"flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700 mb-6"},le={class:"overflow-y-auto max-h-[70vh] pr-2"},re={class:"card bg-base-200 p-4"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},se={class:"form-control"},ne={class:"form-control"},ie={class:"form-control"},ce={class:"card bg-base-200 p-4"},de={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ue={class:"form-control"},be={class:"form-control"},me={class:"form-control"},ge={class:"card bg-base-200 p-4"},ve={class:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end"},ye={class:"form-control"},pe={class:"flex gap-2"},fe=["value"],xe={class:"form-control md:col-span-2"},ke=["size"],he=["value"],we={class:"card bg-base-200 p-4"},Ne={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ae={class:"form-control"},Te={class:"form-control"},Pe={class:"label cursor-pointer"},Ce={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700 mt-6"},Ee={__name:"TenantCreateModal",props:{visible:Boolean},emits:["save","close"],setup(r,{expose:f,emit:x}){const k=r,h=x,{on:w}=Z(),{isDirty:N,setInitialState:A,resetDirty:T}=C();f({isDirty:N,resetDirty:T});const E={0:"Kat",1:"GiriÅŸ",2:"Otopark"},j=e=>{const a=`${e.code} â€” ${Number(e.unitArea||0)}mÂ²`;return null!==e.floorNumber&&void 0!==e.floorNumber?`${a} (${e.floorNumber}. Kat)`:`${a} (${t=e.type,E[t]??"Bilinmiyor"})`;var t},I=e([]),D=e({companyName:"",businessType:"",identityNumber:"",contactPersonName:"",contactPersonPhone:"",contactPersonEmail:"",flatId:"",selectedFlatIds:[],floorNumber:void 0,monthlyAidat:0,isActive:!0});const M=m(()=>{const e=new Set((I.value||[]).map(e=>e.floorNumber??e.floor).filter(e=>null!=e));return Array.from(e).sort((e,a)=>e-a)}),B=m(()=>{const e=D.value.floorNumber,a=I.value||[];return null==e?a:a.filter(a=>(a.floorNumber??a.floor)===e)}),S=m(()=>{var e;const a=(null==(e=B.value)?void 0:e.length)||0;return Math.min(8,a||4)});async function z(e){try{const a=await P.getAvailableFlats(null!=e?{floor:e}:{});I.value=Array.isArray(a)?a.map(e=>({id:e.id,code:e.code??e.unitNumber??"",unitArea:e.unitArea??0,floorNumber:e.floorNumber??e.floor??null,type:e.type,isOccupied:!!e.isOccupied})):[]}catch(a){I.value=[]}}function V(){D.value.flatId="",D.value.selectedFlatIds=[],null===D.value.floorNumber||void 0===D.value.floorNumber?z():z(D.value.floorNumber)}function K(){D.value.floorNumber=null,V()}function U(){var e;if(!D.value.companyName||!D.value.businessType||!D.value.identityNumber)return;const a=(D.value.selectedFlatIds||[]).filter(Boolean);if(0===a.length&&(void 0===D.value.floorNumber||null===D.value.floorNumber))return void notifyError("LÃ¼tfen en az bir Ã¼nite seÃ§in veya kat filtresi belirleyin.");const t={companyName:D.value.companyName.trim(),businessType:D.value.businessType,identityNumber:D.value.identityNumber.trim(),contactPersonName:D.value.contactPersonName.trim(),contactPersonPhone:D.value.contactPersonPhone.trim(),contactPersonEmail:(null==(e=D.value.contactPersonEmail)?void 0:e.trim())||null,flatIds:a.length>1?a:void 0,flatId:1===a.length?a[0]:D.value.flatId||null,floorNumber:D.value.floorNumber??null,monthlyAidat:Number(D.value.monthlyAidat||0),isActive:!!D.value.isActive};h("save",t),D.value={companyName:"",businessType:"",identityNumber:"",contactPersonName:"",contactPersonPhone:"",contactPersonEmail:"",flatId:"",selectedFlatIds:[],floorNumber:void 0,monthlyAidat:0,isActive:!0}}return a(()=>k.visible,e=>{e&&(D.value={companyName:"",businessType:"",identityNumber:"",contactPersonName:"",contactPersonPhone:"",contactPersonEmail:"",flatId:"",selectedFlatIds:[],floorNumber:void 0,monthlyAidat:0,isActive:!0},z(),A(D.value))}),g(()=>{k.visible&&z(),w("tenant:deleted",()=>z(D.value.floorNumber))}),(e,a)=>(l(),t("dialog",{id:"createTenantModal",class:"modal",open:r.visible},[o("div",ae,[o("div",te,[a[13]||(a[13]=o("h3",{class:"text-xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2"},[o("span",{class:"text-2xl"},"ðŸ¢"),s(" Yeni Ä°ÅŸ Yeri KiracÄ±sÄ± Ekle ")],-1)),o("button",{onClick:a[0]||(a[0]=a=>e.$emit("close")),class:"btn btn-sm btn-ghost text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},a[12]||(a[12]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),o("div",le,[o("form",{onSubmit:n(U,["prevent"]),id:"tenantForm",class:"space-y-6"},[o("div",re,[a[18]||(a[18]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ¢ Ä°ÅŸ Yeri Bilgileri",-1)),o("div",oe,[o("div",se,[a[14]||(a[14]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Åžirket AdÄ± *")],-1)),i(o("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>D.value.companyName=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"ABC Ticaret Ltd. Åžti.",required:""},null,512),[[c,D.value.companyName]])]),o("div",ne,[a[16]||(a[16]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Ä°ÅŸ TÃ¼rÃ¼ *")],-1)),i(o("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>D.value.businessType=e),class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},a[15]||(a[15]=[u('<option value="">Ä°ÅŸ tÃ¼rÃ¼ seÃ§in</option><option value="Ticaret">Ticaret</option><option value="Hizmet">Hizmet</option><option value="Ãœretim">Ãœretim</option><option value="Ofis">Ofis</option><option value="Depo">Depo</option><option value="DiÄŸer">DiÄŸer</option>',7)]),512),[[d,D.value.businessType]])]),o("div",ie,[a[17]||(a[17]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Kimlik/Vergi NumarasÄ± *")],-1)),i(o("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>D.value.identityNumber=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"TC veya Vergi No",required:"",type:"text",inputmode:"numeric"},null,512),[[c,D.value.identityNumber]])])])]),o("div",ce,[a[22]||(a[22]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ‘¤ Ä°letiÅŸim KiÅŸisi Bilgileri",-1)),o("div",de,[o("div",ue,[a[19]||(a[19]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Ä°letiÅŸim KiÅŸisi *")],-1)),i(o("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>D.value.contactPersonName=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"Ahmet YÄ±lmaz",required:""},null,512),[[c,D.value.contactPersonName]])]),o("div",be,[a[20]||(a[20]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Telefon *")],-1)),i(o("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>D.value.contactPersonPhone=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"+90 (5XX) XXX XX XX",required:""},null,512),[[c,D.value.contactPersonPhone]])]),o("div",me,[a[21]||(a[21]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"E-posta")],-1)),i(o("input",{type:"email","onUpdate:modelValue":a[6]||(a[6]=e=>D.value.contactPersonEmail=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"ornek@email.com"},null,512),[[c,D.value.contactPersonEmail]])])])]),o("div",ge,[a[27]||(a[27]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ“ Ãœnite SeÃ§imi",-1)),o("div",ve,[o("div",ye,[a[24]||(a[24]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Kat Filtresi")],-1)),o("div",pe,[i(o("select",{"onUpdate:modelValue":a[7]||(a[7]=e=>D.value.floorNumber=e),onChange:V,class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400"},[a[23]||(a[23]=o("option",{value:null},"TÃ¼m katlar",-1)),(l(!0),t(v,null,y(M.value,e=>(l(),t("option",{key:e,value:e},p(e)+". Kat ",9,fe))),128))],544),[[d,D.value.floorNumber]]),o("button",{type:"button",class:"btn btn-ghost btn-sm",onClick:K}," Temizle ")])]),o("div",xe,[a[25]||(a[25]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Ãœnite SeÃ§in (Ã§oklu)")],-1)),i(o("select",{multiple:"","onUpdate:modelValue":a[8]||(a[8]=e=>D.value.selectedFlatIds=e),size:S.value,class:"select select-bordered w-full h-56 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400"},[(l(!0),t(v,null,y(B.value,e=>(l(),t("option",{key:e.id,value:e.id},p(j(e)),9,he))),128))],8,ke),[[d,D.value.selectedFlatIds]]),a[26]||(a[26]=o("label",{class:"label"},[o("span",{class:"label-text-alt text-blue-600"}," ðŸ’¡ Ãœnite seÃ§mezseniz yalnÄ±zca kat seÃ§imiyle o kattaki ilk uygun Ã¼nite atanÄ±r. ")],-1))])])]),o("div",we,[a[29]||(a[29]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ’° Aidat Bilgisi",-1)),o("div",Ne,[o("div",Ae,[a[28]||(a[28]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"AylÄ±k Aidat (â‚º) *")],-1)),i(o("input",{type:"number","onUpdate:modelValue":a[9]||(a[9]=e=>D.value.monthlyAidat=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"500",min:"0",step:"0.01",required:""},null,512),[[c,D.value.monthlyAidat,void 0,{number:!0}]])])])]),o("div",Te,[o("label",Pe,[a[30]||(a[30]=o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Aktif KiracÄ±",-1)),i(o("input",{type:"checkbox","onUpdate:modelValue":a[10]||(a[10]=e=>D.value.isActive=e),class:"toggle toggle-success"},null,512),[[b,D.value.isActive]])])])],32)]),o("div",Ce,[o("button",{type:"button",onClick:a[11]||(a[11]=a=>e.$emit("close")),class:"btn btn-outline border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"},a[31]||(a[31]=[o("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),s(" Ä°ptal ")])),a[32]||(a[32]=o("button",{form:"tenantForm",type:"submit",class:"btn btn-success bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 border-0 text-white shadow-lg"},[o("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),s(" Kaydet ")],-1))])])],8,ee))}},je={class:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 p-6"},Ie={class:"mb-8"},De={class:"flex items-center justify-between"},Me={class:"flex gap-2"},Be=["disabled"],Se={key:0,class:"loading loading-spinner loading-xs"},ze={key:1,class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ve={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},Ke={class:"card bg-white dark:bg-gray-800 shadow-xl border-l-4 border-primary"},Ue={class:"card-body p-6 flex-row items-center gap-4"},Xe={class:"text-2xl font-bold"},$e={class:"card bg-white dark:bg-gray-800 shadow-xl border-l-4 border-success"},Fe={class:"card-body p-6 flex-row items-center gap-4"},He={class:"text-2xl font-bold"},qe={class:"card bg-white dark:bg-gray-800 shadow-xl border-l-4 border-error"},Le={class:"card-body p-6 flex-row items-center gap-4"},Oe={class:"text-2xl font-bold"},Ge={class:"card bg-white dark:bg-gray-800 shadow-lg mb-6"},Ye={class:"card-body"},_e={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Re={class:"form-control"},Je={class:"form-control"},We={class:"form-control"},Qe=["value"],Ze={class:"form-control"},ea={class:"flex justify-between items-center mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"},aa={class:"text-sm text-gray-500 dark:text-gray-400"},ta={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},la={key:0,class:"absolute top-4 right-4 z-10"},ra={class:"dropdown dropdown-end"},oa={tabindex:"0",class:"dropdown-content menu p-2 shadow bg-base-200 rounded-box w-40 z-10"},sa=["onClick"],na=["onClick"],ia={key:0},ca=["onClick"],da={class:"flex items-center gap-4 mb-4"},ua={class:"flex items-center gap-2 mb-1"},ba={class:"text-lg font-bold text-gray-800 dark:text-gray-100"},ma={key:0,class:"badge badge-info text-xs"},ga={class:"flex items-center gap-2"},va={class:"mt-2 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl border border-gray-100 dark:border-gray-700"},ya={class:"flex justify-between items-center"},pa={class:"mt-auto pt-4 flex gap-2"},fa=["onClick"],xa=["href"],ka=["onClick"],ha={class:"card-body border-t border-gray-200 dark:border-gray-700"},wa={class:"flex items-center justify-between"},Na={class:"text-sm text-gray-600 dark:text-gray-400"},Aa={class:"join"},Ta=["disabled"],Pa={class:"join-item btn btn-sm"},Ca=["disabled"],Ea={__name:"Tenants",setup(n){const b=h(),C=N(),{emit:M}=Z(),B=E(),S=e(!1),z=e(!1),V=e(null),K=m(()=>V.value?`${V.value.companyName} silinsin mi?`:"Silinsin mi?"),U=m(()=>V.value?`${V.value.companyName} kiracÄ±sÄ±nÄ± silerseniz ilgili Ã¼nite boÅŸaltÄ±lacaktÄ±r.`:""),X=()=>{S.value=!1,V.value=null};m(()=>B.loading);const $=m(()=>B.tenants),F=e(!1),H=e(!1),q=e(null),L=e(1),O=e(!1),G=e({searchTerm:"",isActive:"",floorNumber:"",businessType:""}),Y=m(()=>B.stats),_=m(()=>{let e=$.value;if(G.value.searchTerm){const a=String(G.value.searchTerm).toLowerCase();e=e.filter(e=>String(e.companyName||"").toLowerCase().includes(a)||String(e.contactPersonName||"").toLowerCase().includes(a)||String(e.identityNumber||"").includes(a)||String(e.contactPersonEmail||"").toLowerCase().includes(a)||String(e.contactPersonPhone||"").includes(a))}if(""!==G.value.isActive){const a="true"===G.value.isActive;e=e.filter(e=>e.isActive===a)}if(""!==G.value.floorNumber){const a=parseInt(G.value.floorNumber,10);e=e.filter(e=>{var t;return null==(t=e.flats)?void 0:t.some(e=>e.floorNumber===a)})}return G.value.businessType&&(e=e.filter(e=>e.businessType===G.value.businessType)),e}),R=m(()=>{const e=10*(L.value-1);return _.value.slice(e,e+10)}),J=m(()=>Math.ceil(_.value.length/10)),Q=m(()=>{const e=new Set;return $.value.forEach(a=>{var t;return null==(t=a.flats)?void 0:t.forEach(a=>{null!==a.floorNumber&&void 0!==a.floorNumber&&e.add(a.floorNumber)})}),Array.from(e).sort((e,a)=>e-a)}),ee=e=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(Number(e||0)),ae=async()=>{try{await B.fetchTenants()}catch(e){}},te=async()=>{if(confirm("TÃ¼m kiracÄ±larÄ±n avans bakiyeleri geÃ§miÅŸ iÅŸlem verilerine gÃ¶re yeniden hesaplanacak ve eÅŸitlenecektir. Devam etmek istiyor musunuz?")){O.value=!0;try{const e=await P.syncAdvanceBalances();T.logSuccess("success",`Senkronizasyon tamamlandÄ±. ${e.updatedAccountsCount} hesap gÃ¼ncellendi.`,{component:"Tenants",action:"sync-balances"}),await ae()}catch(e){T.logError(e,{component:"Tenants",action:"sync-balances"})}finally{O.value=!1}}},le=()=>{L.value=1},re=()=>{G.value={searchTerm:"",isActive:"",floorNumber:"",businessType:""},L.value=1},oe=async e=>{try{await B.createTenant(e),T.logSuccess("success","KiracÄ± baÅŸarÄ±yla eklendi",{component:"Tenants",action:"create"}),F.value=!1}catch(a){const l=(null==a?void 0:a.serverMessage)||(null==a?void 0:a.message)||"",r=/aktif.*kiracÄ±.*var/i.test(l),o=e.flatIds&&e.flatIds.length?e.flatIds:e.flatId?[e.flatId]:[];if(r&&o.length)try{const a=$.value.filter(a=>a.identityNumber===e.identityNumber&&a.isActive)[0];if(a){if(window.confirm(`Bu kimlik numarasÄ±yla zaten aktif bir kiracÄ± var: "${a.companyName}". SeÃ§ili ${o.length} Ã¼niteyi bu kiracÄ±ya baÄŸlayalÄ±m mÄ±?`))return await B.updateTenant(a.id,{...a,flatIds:[...a.flatIds||[],...o]}),T.logSuccess("success","Ãœniteler mevcut kiracÄ±ya atandÄ±.",{component:"Tenants",action:"assign-flats"}),void(F.value=!1)}}catch(t){}T.logError(a,{component:"Tenants",action:"create"})}},se=async e=>{try{await B.updateTenant(q.value.id,e),T.logSuccess("success","KiracÄ± baÅŸarÄ±yla gÃ¼ncellendi",{component:"Tenants",action:"update"}),ne()}catch(a){T.logError(a,{component:"Tenants",action:"update"})}},ne=()=>{q.value=null,H.value=!1},ie=e=>{b.push(`/tenants/${e.id}`)},ce=async()=>{if(V.value){z.value=!0;try{await B.deleteTenant(V.value.id),T.logSuccess("success","KiracÄ± silindi",{component:"Tenants",action:"delete"}),M("tenant:deleted")}catch(e){T.logError(e,{component:"Tenants",action:"delete"})}finally{z.value=!1,X()}}};return g(ae),a(G,le,{deep:!0}),(e,a)=>(l(),t("div",je,[o("div",Ie,[o("div",De,[a[11]||(a[11]=o("div",null,[o("h1",{class:"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-2 flex items-center gap-3"},[o("span",{class:"text-4xl"},"ðŸ¢"),s(" Ä°ÅŸ HanÄ± KiracÄ±larÄ± ")]),o("p",{class:"text-gray-600 dark:text-gray-400"},"Ä°ÅŸ hanÄ±ndaki tÃ¼m kiracÄ±larÄ± yÃ¶netin")],-1)),o("div",Me,[k(C).role===k(A).ADMIN?(l(),t("button",{key:0,onClick:te,disabled:O.value,class:"btn btn-outline btn-primary shadow-lg active:scale-[0.98] active:opacity-90 transition-all"},[O.value?(l(),t("span",Se)):(l(),t("svg",ze,a[8]||(a[8]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))),a[9]||(a[9]=s(" Bakiyeleri Senkronize Et "))],8,Be)):r("",!0),k(C).role===k(A).ADMIN||k(C).role===k(A).MANAGER?(l(),t("button",{key:1,onClick:a[0]||(a[0]=e=>F.value=!0),class:"btn btn-success bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 border-0 text-white shadow-lg active:scale-[0.98] active:opacity-90 transition-all"},a[10]||(a[10]=[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),s(" Yeni KiracÄ± Ekle ")]))):r("",!0)])])]),o("div",Ve,[o("div",Ke,[o("div",Ue,[a[13]||(a[13]=o("div",{class:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center text-primary text-2xl"},"ðŸ‘¤",-1)),o("div",null,[a[12]||(a[12]=o("div",{class:"text-sm font-semibold text-gray-500"},"Aktif KiracÄ±lar",-1)),o("div",Xe,p(Y.value.activeCount),1)])])]),o("div",$e,[o("div",Fe,[a[15]||(a[15]=o("div",{class:"w-12 h-12 rounded-full bg-success/10 flex items-center justify-center text-success text-2xl"},"ðŸ“Š",-1)),o("div",null,[a[14]||(a[14]=o("div",{class:"text-sm font-semibold text-gray-500"},"Doluluk OranÄ±",-1)),o("div",He,"%"+p(Y.value.occupancyRate),1)])])]),o("div",qe,[o("div",Le,[a[17]||(a[17]=o("div",{class:"w-12 h-12 rounded-full bg-error/10 flex items-center justify-center text-error text-2xl"},"ðŸ’°",-1)),o("div",null,[a[16]||(a[16]=o("div",{class:"text-sm font-semibold text-gray-500"},"Toplam Bakiye",-1)),o("div",Oe,p(ee(Y.value.totalDebt)),1)])])])]),o("div",Ge,[o("div",Ye,[o("div",_e,[o("div",Re,[a[18]||(a[18]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Arama")],-1)),i(o("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>G.value.searchTerm=e),onInput:le,class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"Åžirket, kiÅŸi, kimlik no..."},null,544),[[c,G.value.searchTerm]])]),o("div",Je,[a[20]||(a[20]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Durum")],-1)),i(o("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>G.value.isActive=e),onChange:le,class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200"},a[19]||(a[19]=[o("option",{value:""},"TÃ¼mÃ¼",-1),o("option",{value:"true"},"Aktif",-1),o("option",{value:"false"},"Pasif",-1)]),544),[[d,G.value.isActive]])]),o("div",We,[a[22]||(a[22]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Kat")],-1)),i(o("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>G.value.floorNumber=e),onChange:le,class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200"},[a[21]||(a[21]=o("option",{value:""},"TÃ¼m Katlar",-1)),(l(!0),t(v,null,y(Q.value,e=>(l(),t("option",{key:e,value:e},p(e)+". Kat",9,Qe))),128))],544),[[d,G.value.floorNumber]])]),o("div",Ze,[a[24]||(a[24]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Ä°ÅŸ TÃ¼rÃ¼")],-1)),i(o("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>G.value.businessType=e),onChange:le,class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200"},a[23]||(a[23]=[u('<option value="">TÃ¼mÃ¼</option><option value="Ticaret">Ticaret</option><option value="Hizmet">Hizmet</option><option value="Ãœretim">Ãœretim</option><option value="Ofis">Ofis</option><option value="Depo">Depo</option><option value="DiÄŸer">DiÄŸer</option>',7)]),544),[[d,G.value.businessType]])])]),o("div",ea,[o("div",{class:"flex gap-2"},[o("button",{onClick:re,class:"btn btn-outline btn-sm border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300"},a[25]||(a[25]=[o("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),s(" Filtreleri Temizle ")]))]),o("div",aa,p(_.value.length)+" kiracÄ± bulundu ",1)])])]),_.value.length>0?(l(),t("div",ta,[(l(!0),t(v,null,y(R.value,e=>{var s,n;return l(),t("div",{key:e.id,class:"relative group bg-white dark:bg-gray-800 rounded-2xl shadow-lg transition-transform duration-200 hover:scale-105 hover:shadow-2xl p-6 flex flex-col"},[k(C).role===k(A).ADMIN||k(C).role===k(A).MANAGER?(l(),t("div",la,[o("div",ra,[a[26]||(a[26]=u('<button tabindex="0" class="btn btn-ghost btn-circle btn-sm"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><circle cx="12" cy="12" r="1.5"></circle><circle cx="19" cy="12" r="1.5"></circle><circle cx="5" cy="12" r="1.5"></circle></svg></button>',1)),o("ul",oa,[o("li",null,[o("a",{onClick:a=>ie(e)},"DetaylarÄ± GÃ¶r",8,sa)]),o("li",null,[o("a",{onClick:a=>{return t=e,q.value=t,void(H.value=!0);var t}},"DÃ¼zenle",8,na)]),k(C).role===k(A).ADMIN?(l(),t("li",ia,[o("a",{onClick:a=>(e=>{V.value=e,S.value=!0})(e),class:"text-error"},"Sil",8,ca)])):r("",!0)])])])):r("",!0),o("div",da,[o("div",{class:w(k(j)(e.contactPersonName)+" flex items-center justify-center rounded-full w-16 h-16 text-2xl font-bold text-white shadow-lg")},p(k(I)(e.companyName)),3),o("div",null,[o("div",ua,[o("span",ba,p(e.companyName),1),(null==(s=e.flats)?void 0:s.length)?(l(),t("span",ma," Ãœnite "+p(e.flats[0].code),1)):r("",!0)]),o("div",ga,[o("span",{class:w(["badge font-semibold",e.isActive?"badge-success":"badge-ghost"])},p(e.isActive?"Aktif":"Pasif"),3)])])]),o("div",va,[o("div",ya,[a[27]||(a[27]=o("span",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"GÃ¼ncel Bakiye",-1)),o("span",{class:w(["text-sm font-bold",e.totalBalance>0?"text-error":"text-success"])},p(ee(e.totalBalance)),3)])]),o("div",pa,[o("button",{onClick:a=>ie(e),class:"btn btn-sm btn-outline flex-1 normal-case"},"Detay",8,fa),o("a",{href:`https://wa.me/${null==(n=e.contactPersonPhone)?void 0:n.replace(/\D/g,"")}`,target:"_blank",class:"btn btn-sm btn-ghost btn-circle text-success",title:"WhatsApp"},a[28]||(a[28]=[o("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},[o("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L0 24l6.335-1.662c1.72.937 3.659 1.432 5.628 1.433h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})],-1)]),8,xa),k(C).role===k(A).ADMIN||k(C).role===k(A).MANAGER?(l(),t("button",{key:0,onClick:a=>k(b).push(`/payments?tenantId=${e.id}`),class:"btn btn-sm btn-ghost btn-circle text-primary",title:"Ã–deme Al"},a[29]||(a[29]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})],-1)]),8,ka)):r("",!0)])])}),128))])):r("",!0),o("div",ha,[o("div",wa,[o("div",Na,p(10*(L.value-1)+1)+"-"+p(Math.min(10*L.value,_.value.length))+" / "+p(_.value.length)+" kiracÄ± ",1),o("div",Aa,[o("button",{onClick:a[5]||(a[5]=e=>L.value--),disabled:1===L.value,class:"join-item btn btn-sm"},"Â«",8,Ta),o("button",Pa,p(L.value),1),o("button",{onClick:a[6]||(a[6]=e=>L.value++),disabled:L.value>=J.value,class:"join-item btn btn-sm"},"Â»",8,Ca)])])]),f(Ee,{visible:F.value,onSave:oe,onClose:a[7]||(a[7]=e=>F.value=!1)},null,8,["visible"]),f(D,{visible:S.value,tenant:V.value,title:K.value,message:U.value,"confirm-label":"Evet, Sil","cancel-label":"Ä°ptal",loading:z.value,onConfirm:ce,onCancel:X},null,8,["visible","tenant","title","message","loading"]),q.value?(l(),x(W,{key:1,visible:H.value,tenant:q.value,onSave:se,onClose:ne},null,8,["visible","tenant"])):r("",!0)]))}};export{Ea as default};
