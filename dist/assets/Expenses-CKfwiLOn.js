import{e}from"./expensesService-B7LaUaPi.js";import{t}from"./tenantsService-DcFCN9jj.js";import{C as r,c as a,l,b as s,n as o,t as n,q as d,D as i,E as u,F as c,i as b,H as g,r as p,o as x,f as v}from"./vue-vendor-BE3w9SvD.js";import{_ as y}from"./FilterBar-wXoQM61V.js";import{u as m}from"./useErrorHandler-CQcR_3b6.js";import"./index-CAkTsZV-.js";import"./useNotification-Dv4wKXE4.js";const k=["open"],h={class:"modal-box max-w-3xl bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border border-gray-200 dark:border-gray-700 shadow-2xl"},f={class:"flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700 mb-6"},w={class:"text-xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2"},D={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},C={class:"form-control"},G=["value"],S={class:"form-control"},M={class:"form-control"},T={class:"form-control"},j={class:"form-control"},E={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700"},B={class:"btn btn-primary bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 border-0 text-white shadow-lg",type:"submit"},z={__name:"ExpenseModal",props:["visible","expense","types","editMode"],emits:["save","close"],setup(e,{emit:t}){const p=e,x=t,v=r(()=>[{value:"Electricity",label:"Elektrik (Genel)"},{value:"Water",label:"Su (Genel)"},{value:"Gas",label:"Gaz"},{value:"Maintenance",label:"Bakım"},{value:"Cleaning",label:"Temizlik"},{value:"Security",label:"Güvenlik"},{value:"Other",label:"Diğer"}]);function y(){x("save",p.expense)}return(t,r)=>(l(),a("dialog",{class:"modal",open:e.visible},[s("div",h,[s("div",f,[s("h3",w,[r[7]||(r[7]=s("span",{class:"text-2xl"},"💰",-1)),o(" "+n(e.editMode?"Gider Düzenle":"Yeni Gider Ekle"),1)]),s("button",{onClick:r[0]||(r[0]=e=>t.$emit("close")),class:"btn btn-sm btn-ghost text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},r[8]||(r[8]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),s("form",{onSubmit:d(y,["prevent"]),class:"space-y-6"},[s("div",D,[s("div",C,[r[10]||(r[10]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Gider Tipi")],-1)),i(s("select",{"onUpdate:modelValue":r[1]||(r[1]=t=>e.expense.type=t),class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},[r[9]||(r[9]=s("option",{disabled:"",value:""},"Seçiniz",-1)),(l(!0),a(c,null,b(v.value,e=>(l(),a("option",{key:e.value,value:e.value},n(e.label),9,G))),128))],512),[[u,e.expense.type]])]),s("div",S,[r[11]||(r[11]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Tarih")],-1)),i(s("input",{"onUpdate:modelValue":r[2]||(r[2]=t=>e.expense.expenseDate=t),type:"date",class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},null,512),[[g,e.expense.expenseDate]])]),s("div",M,[r[12]||(r[12]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Tutar (₺)")],-1)),i(s("input",{"onUpdate:modelValue":r[3]||(r[3]=t=>e.expense.amount=t),type:"number",min:"0",step:"0.01",class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},null,512),[[g,e.expense.amount]])])]),s("div",T,[r[13]||(r[13]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Başlık")],-1)),i(s("input",{"onUpdate:modelValue":r[4]||(r[4]=t=>e.expense.title=t),type:"text",class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"Gider başlığı giriniz",required:""},null,512),[[g,e.expense.title]])]),s("div",j,[r[14]||(r[14]=s("label",{class:"label"},[s("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Açıklama")],-1)),i(s("textarea",{"onUpdate:modelValue":r[5]||(r[5]=t=>e.expense.description=t),class:"textarea textarea-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"Gider açıklaması giriniz",rows:"3"},null,512),[[g,e.expense.description]])]),s("div",E,[s("button",{class:"btn btn-outline border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",type:"button",onClick:r[6]||(r[6]=e=>t.$emit("close"))},r[15]||(r[15]=[s("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),o(" İptal ")])),s("button",B,[r[16]||(r[16]=s("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),o(" "+n(e.editMode?"Güncelle":"Kaydet"),1)])])],32)])],8,k))}},L={class:"p-4 sm:p-6 bg-gray-50 min-h-screen font-sans dark:bg-gray-900"},A={class:"max-w-7xl mx-auto"},O={class:"flex items-center justify-between mb-6"},U={class:"flex items-center gap-4"},Y={class:"bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-400 px-3 py-1 rounded-full text-sm"},V={class:"bg-orange-100 dark:bg-orange-900/50 text-orange-600 dark:text-orange-400 px-3 py-1 rounded-full text-sm"},F={class:"bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 px-3 py-1 rounded-full text-sm"},q={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},H={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},N={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},_={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},I={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},R={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center gap-4 border border-gray-200 dark:border-gray-700"},W={class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},K={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200 dark:border-gray-700"},$={class:"mt-6 space-y-2"},J={key:0,class:"text-center py-12 text-gray-500 dark:text-gray-400"},P={key:1},Q={class:"md:col-span-5 flex items-center gap-4"},X={class:"flex-shrink-0 h-12 w-12 flex items-center justify-center bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full text-2xl"},Z={class:"font-bold text-gray-800 dark:text-gray-100"},ee={class:"text-sm text-gray-500 dark:text-gray-400"},te={class:"md:col-span-3 text-left md:text-center text-xl font-semibold text-red-600 dark:text-red-400"},re={class:"md:col-span-2 text-left md:text-center"},ae={class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-blue-100 text-blue-800 dark:bg-blue-900/60 dark:text-blue-200"},le={class:"md:col-span-2 text-right"},se={class:"dropdown dropdown-end"},oe={tabindex:"0",class:"dropdown-content menu p-2 shadow bg-base-200 rounded-box w-32 z-10"},ne=["onClick"],de=["onClick"],ie={__name:"Expenses",setup(o){const{handleNetworkError:d,showSuccess:i}=m(),u=p([]),g=p([]),k=p(!1),h=p(null),f=p({}),w=p(!1),D=p(!1),C=p(null),G=p({searchTerm:"",period:"",type:""}),S=[{value:"Electricity",label:"Elektrik (Genel)"},{value:"Water",label:"Su (Genel)"},{value:"Gas",label:"Gaz"},{value:"Maintenance",label:"Bakım"},{value:"Cleaning",label:"Temizlik"},{value:"Security",label:"Güvenlik"},{value:"Other",label:"Diğer"}],M=r(()=>{const e=S.map(e=>({value:e.value,label:e.label}));return e.unshift({value:"",label:"Tüm Tipler"}),e}),T=e=>null==e||isNaN(e)?"₺0.00":Number(e).toLocaleString("tr-TR",{style:"currency",currency:"TRY"}),j=e=>{if(!e)return"";return new Date(e).toLocaleDateString("tr-TR")},E=r(()=>{var e;return(null==(e=f.value)?void 0:e.totalAmount)||0}),B=r(()=>{var e;return(null==(e=f.value)?void 0:e.thisMonthAmount)||0}),ie=r(()=>{var e;return(null==(e=f.value)?void 0:e.thisMonthCount)||0}),ue=r(()=>{var e;return(null==(e=f.value)?void 0:e.totalCount)||0}),ce=e=>{if(!e)return"❓";return{Electricity:"⚡️",Water:"💧",Gas:"🔥",Maintenance:"🛠️",Cleaning:"🧹",Security:"🔒",Other:"📦"}[e]||"❓"},be=e=>{const t=S.find(t=>t.value===e);return t?t.label:e},ge=r(()=>{let e=u.value;const t=G.value.searchTerm.toLowerCase();return G.value.period&&(e=e.filter(e=>{const t=new Date(e.expenseDate),r=new Date(G.value.period);return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()})),G.value.type&&(e=e.filter(e=>e.type===G.value.type)),t&&(e=e.filter(e=>e.title&&e.title.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)||e.type&&be(e.type).toLowerCase().includes(t)||e.amount&&e.amount.toString().includes(t))),e.sort((e,t)=>new Date(t.expenseDate)-new Date(e.expenseDate))}),pe=(new Date).toISOString().substr(0,10),xe=p({expenseDate:pe,title:"",amount:"",type:"Other",description:""}),ve=async()=>{k.value=!0;try{const t=await e.getExpenses();u.value=t||[];const r=await e.getExpenseStats();f.value=r||{},h.value=null}catch(t){d(t,{component:"Expenses",action:"fetchExpenses"}),h.value=t.message,u.value=[],f.value={}}finally{k.value=!1}},ye=()=>{xe.value={expenseDate:pe,title:"",amount:"",type:"Other",description:""},D.value=!1,C.value=null,w.value=!0},me=()=>{xe.value={expenseDate:pe,title:"",amount:"",type:"Other",description:""},D.value=!1,C.value=null,w.value=!1},ke=async t=>{try{const r={title:t.title,amount:parseFloat(t.amount),type:t.type,expenseDate:new Date(t.expenseDate).toISOString(),description:t.description};D.value&&C.value?(await e.updateExpense(C.value,r),i("Gider")):(await e.createExpense(r),i("Gider")),await ve(),me()}catch(r){alert("Gider kaydedilirken bir hata oluştu")}},he=()=>{G.value={searchTerm:"",period:"",type:""},ve()};return x(()=>{(async()=>{try{const e=await t.getTenants();g.value=e||[]}catch(e){d(e,{component:"Expenses",action:"fetchTenants"}),g.value=[]}})(),ve()}),(t,r)=>(l(),a("div",L,[s("div",A,[s("div",O,[r[3]||(r[3]=s("h1",{class:"text-3xl font-bold text-gray-800 dark:text-gray-100"},"Kiracı Giderleri",-1)),s("div",U,[s("div",Y," Toplam: "+n(T(E.value)),1),s("div",V," Bu Ay: "+n(T(B.value)),1),s("div",F,n(ue.value)+" gider ",1)])]),s("section",q,[s("div",H,[r[5]||(r[5]=s("div",{class:"bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-400 rounded-full p-3"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13 17h8m0 0v8m0-8l-8 8-4-4-6 6"})])],-1)),s("div",null,[r[4]||(r[4]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Bu Ayki Gider",-1)),s("p",N,n(T(B.value)),1)])]),s("div",_,[r[7]||(r[7]=s("div",{class:"bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 rounded-full p-3"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 7h6m0 0v6m0-6L9 13"})])],-1)),s("div",null,[r[6]||(r[6]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Toplam Gider",-1)),s("p",I,n(T(E.value)),1)])]),s("div",R,[r[9]||(r[9]=s("div",{class:"bg-amber-100 dark:bg-amber-900/50 text-amber-600 dark:text-amber-400 rounded-full p-3"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z"})])],-1)),s("div",null,[r[8]||(r[8]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"İşlem Sayısı (Bu Ay)",-1)),s("p",W,n(ie.value),1)])]),s("div",{class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center justify-center border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-red-500 dark:hover:border-red-400 transition-colors duration-300",onClick:ye},r[10]||(r[10]=[s("button",{class:"w-full h-full text-red-500 dark:text-red-400 flex items-center justify-center gap-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})]),s("span",{class:"font-semibold"},"Yeni Gider Ekle")],-1)]))]),s("div",K,[v(y,{search:G.value.searchTerm,"onUpdate:search":r[0]||(r[0]=e=>G.value.searchTerm=e),"search-placeholder":"Açıklama, tip veya tutar ara...",period:G.value.period,"onUpdate:period":r[1]||(r[1]=e=>G.value.period=e),"select-type":G.value.type,"onUpdate:selectType":r[2]||(r[2]=e=>G.value.type=e),"select-type-options":M.value,onClearFilters:he},null,8,["search","period","select-type","select-type-options"]),s("div",$,[0===ge.value.length?(l(),a("div",J,r[11]||(r[11]=[s("p",null,"Aramanızla eşleşen gider bulunamadı.",-1)]))):(l(),a("div",P,[(l(!0),a(c,null,b(ge.value,t=>(l(),a("div",{key:t.id,class:"grid grid-cols-1 md:grid-cols-12 gap-4 items-center p-4 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-200 border-b dark:border-gray-700/50"},[s("div",Q,[s("div",X,n(ce(t.type)),1),s("div",null,[s("p",Z,n(t.title||"Açıklama Yok"),1),s("p",ee,n(j(t.expenseDate)||"Tarih Yok"),1)])]),s("div",te,n(T(t.amount)),1),s("div",re,[s("span",ae,n(be(t.type)||"Tip Yok"),1)]),s("div",le,[s("div",se,[r[12]||(r[12]=s("label",{tabindex:"0",class:"btn btn-ghost btn-sm"},"İşlemler",-1)),s("ul",oe,[s("li",null,[s("a",{onClick:e=>{return r=t,xe.value={...r,expenseDate:new Date(r.expenseDate).toISOString().substr(0,10)},C.value=r.id,D.value=!0,void(w.value=!0);var r}},"Düzenle",8,ne)]),s("li",null,[s("a",{onClick:r=>(async t=>{if(confirm("Bu gideri silmek istediğinizden emin misiniz?"))try{await e.deleteExpense(t),i("Gider"),await ve()}catch(r){alert("Gider silinirken bir hata oluştu")}})(t.id),class:"text-red-500"},"Sil",8,de)])])])])]))),128))]))])])]),v(z,{visible:w.value,expense:xe.value,types:S,editMode:D.value,onSave:ke,onClose:me},null,8,["visible","expense","editMode"])]))}};export{ie as default};
