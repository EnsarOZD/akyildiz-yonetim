import{r as e,w as a,c as t,l,e as r,b as o,n as s,q as n,D as i,H as d,E as c,G as u,I as b,C as m,o as g,F as v,i as y,t as p,f,m as x,u as k,k as h,p as w}from"./vue-vendor-C74T0G6D.js";import{u as N,R as A,e as T}from"./index-C-WeNbY_.js";import{t as P}from"./tenantsService-fWeC8dko.js";import{u as C,g as E,a as I}from"./uiHelpers-CScyf4mM.js";import{_ as j}from"./ConfirmDeleteModal-Den0orsn.js";const M=["open"],V={key:0,class:"modal-box max-w-4xl bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border border-gray-200 dark:border-gray-700 shadow-2xl"},B={class:"flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700 mb-6"},D={class:"overflow-y-auto max-h-[70vh] pr-2"},S={class:"card bg-base-200 p-4"},z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},K={class:"form-control"},U={class:"form-control"},X={class:"form-control"},$={class:"card bg-base-200 p-4"},F={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},q={class:"form-control"},H={class:"form-control"},L={class:"form-control md:col-span-2"},O={class:"card bg-base-200 p-4"},G={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Y={class:"form-control"},_={class:"form-control md:col-span-2"},R={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700 mt-6"},W={__name:"TenantEditModal",props:{tenant:Object,visible:Boolean},emits:["save","close"],setup(m,{emit:g}){const v=m,y=g,p=e(null);a(()=>v.tenant,e=>{p.value=e?{id:e.id,companyName:e.companyName||"",businessType:e.businessType||"",identityNumber:e.identityNumber||"",contactPersonName:e.contactPersonName||"",contactPersonPhone:e.contactPersonPhone||"",contactPersonEmail:e.contactPersonEmail||"",monthlyAidat:Number(e.monthlyAidat??0),isActive:Boolean(e.isActive)}:null},{immediate:!0});const f=()=>{const e=p.value;if(!e)return;const a={id:e.id,companyName:e.companyName.trim(),businessType:e.businessType,identityNumber:e.identityNumber.trim(),contactPersonName:e.contactPersonName.trim(),contactPersonPhone:e.contactPersonPhone.trim(),contactPersonEmail:e.contactPersonEmail.trim(),monthlyAidat:Number(e.monthlyAidat??0),isActive:Boolean(e.isActive)};y("save",a)};return(e,a)=>(l(),t("dialog",{id:"editTenantModal",class:"modal",open:m.visible},[p.value?(l(),t("div",V,[o("div",B,[a[11]||(a[11]=o("h3",{class:"text-xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2"},[o("span",{class:"text-2xl"},"âœï¸"),s(" Ä°ÅŸ Yeri KiracÄ±sÄ± Bilgilerini GÃ¼ncelle ")],-1)),o("button",{onClick:a[0]||(a[0]=a=>e.$emit("close")),class:"btn btn-sm btn-ghost text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},a[10]||(a[10]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),o("div",D,[o("form",{onSubmit:n(f,["prevent"]),class:"space-y-6"},[o("div",S,[a[16]||(a[16]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ¢ Ä°ÅŸ Yeri Bilgileri",-1)),o("div",z,[o("div",K,[a[12]||(a[12]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"Åžirket AdÄ± *")],-1)),i(o("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>p.value.companyName=e),class:"input input-bordered w-full bg-white dark:bg-gray-700",required:""},null,512),[[d,p.value.companyName,void 0,{trim:!0}]])]),o("div",U,[a[14]||(a[14]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"Ä°ÅŸ TÃ¼rÃ¼ *")],-1)),i(o("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>p.value.businessType=e),class:"select select-bordered w-full bg-white dark:bg-gray-700",required:""},a[13]||(a[13]=[u('<option value="">Ä°ÅŸ tÃ¼rÃ¼ seÃ§in</option><option value="Ticaret">Ticaret</option><option value="Hizmet">Hizmet</option><option value="Ãœretim">Ãœretim</option><option value="Ofis">Ofis</option><option value="Depo">Depo</option><option value="DiÄŸer">DiÄŸer</option>',7)]),512),[[c,p.value.businessType]])]),o("div",X,[a[15]||(a[15]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"Kimlik/Vergi NumarasÄ± *")],-1)),i(o("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>p.value.identityNumber=e),class:"input input-bordered w-full bg-white dark:bg-gray-700",placeholder:"TC veya Vergi No",inputmode:"numeric",required:""},null,512),[[d,p.value.identityNumber]])])])]),o("div",$,[a[20]||(a[20]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ‘¤ Ä°letiÅŸim KiÅŸisi",-1)),o("div",F,[o("div",q,[a[17]||(a[17]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"Ad Soyad *")],-1)),i(o("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>p.value.contactPersonName=e),class:"input input-bordered w-full bg-white dark:bg-gray-700",required:""},null,512),[[d,p.value.contactPersonName,void 0,{trim:!0}]])]),o("div",H,[a[18]||(a[18]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"Telefon *")],-1)),i(o("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>p.value.contactPersonPhone=e),class:"input input-bordered w-full bg-white dark:bg-gray-700",placeholder:"+90 (5XX) XXX XX XX",required:""},null,512),[[d,p.value.contactPersonPhone,void 0,{trim:!0}]])]),o("div",L,[a[19]||(a[19]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"E-posta")],-1)),i(o("input",{type:"email","onUpdate:modelValue":a[6]||(a[6]=e=>p.value.contactPersonEmail=e),class:"input input-bordered w-full bg-white dark:bg-gray-700",placeholder:"ornek@email.com"},null,512),[[d,p.value.contactPersonEmail,void 0,{trim:!0}]])])])]),o("div",O,[a[23]||(a[23]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ’° Aidat & Durum",-1)),o("div",G,[o("div",Y,[a[21]||(a[21]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"AylÄ±k Aidat (â‚º) *")],-1)),i(o("input",{type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>p.value.monthlyAidat=e),min:"0",step:"0.01",class:"input input-bordered w-full bg-white dark:bg-gray-700",required:""},null,512),[[d,p.value.monthlyAidat,void 0,{number:!0}]])]),o("div",_,[a[22]||(a[22]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold"},"Aktif")],-1)),i(o("input",{type:"checkbox","onUpdate:modelValue":a[8]||(a[8]=e=>p.value.isActive=e),class:"toggle toggle-success"},null,512),[[b,p.value.isActive]])])])])],32)]),o("div",R,[o("button",{type:"button",onClick:a[9]||(a[9]=a=>e.$emit("close")),class:"btn btn-outline"},"Ä°ptal"),o("button",{onClick:f,class:"btn btn-primary"},"GÃ¼ncelle")])])):r("",!0)],8,M))}},J=e(new Map);function Q(){const e=(e,a)=>{J.value.has(e)||J.value.set(e,[]),J.value.get(e).push(a)},a=(e,a)=>{if(J.value.has(e)){const t=J.value.get(e),l=t.indexOf(a);l>-1&&t.splice(l,1)}};return{on:e,off:a,emit:(e,a)=>{J.value.has(e)&&J.value.get(e).forEach(e=>{try{e(a)}catch(t){}})},once:(t,l)=>{const r=e=>{l(e),a(t,r)};e(t,r)}}}const Z=["open"],ee={class:"modal-box max-w-4xl bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border border-gray-200 dark:border-gray-700 shadow-2xl"},ae={class:"flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700 mb-6"},te={class:"overflow-y-auto max-h-[70vh] pr-2"},le={class:"card bg-base-200 p-4"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},oe={class:"form-control"},se={class:"form-control"},ne={class:"form-control"},ie={class:"card bg-base-200 p-4"},de={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ce={class:"form-control"},ue={class:"form-control"},be={class:"form-control"},me={class:"card bg-base-200 p-4"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end"},ve={class:"form-control"},ye={class:"flex gap-2"},pe=["value"],fe={class:"form-control md:col-span-2"},xe=["size"],ke=["value"],he={class:"card bg-base-200 p-4"},we={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ne={class:"form-control"},Ae={class:"form-control"},Te={class:"label cursor-pointer"},Pe={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700 mt-6"},Ce={__name:"TenantCreateModal",props:{visible:Boolean},emits:["save","close"],setup(r,{emit:f}){const x=r,k=f,{on:h}=Q(),w={0:"Kat",1:"GiriÅŸ",2:"Otopark"},N=e=>{const a=`${e.code} â€” ${Number(e.unitArea||0)}mÂ²`;return null!==e.floorNumber&&void 0!==e.floorNumber?`${a} (${e.floorNumber}. Kat)`:`${a} (${t=e.type,w[t]??"Bilinmiyor"})`;var t},A=e([]),T=e({companyName:"",businessType:"",identityNumber:"",contactPersonName:"",contactPersonPhone:"",contactPersonEmail:"",flatId:"",selectedFlatIds:[],floorNumber:void 0,monthlyAidat:0,isActive:!0});const C=m(()=>{const e=new Set((A.value||[]).map(e=>e.floorNumber??e.floor).filter(e=>null!=e));return Array.from(e).sort((e,a)=>e-a)}),E=m(()=>{const e=T.value.floorNumber,a=A.value||[];return null==e?a:a.filter(a=>(a.floorNumber??a.floor)===e)}),I=m(()=>{var e;const a=(null==(e=E.value)?void 0:e.length)||0;return Math.min(8,a||4)});async function j(e){try{const a=await P.getAvailableFlats(null!=e?{floor:e}:{});A.value=Array.isArray(a)?a.map(e=>({id:e.id,code:e.code??e.unitNumber??"",unitArea:e.unitArea??0,floorNumber:e.floorNumber??e.floor??null,type:e.type,isOccupied:!!e.isOccupied})):[]}catch(a){A.value=[]}}function M(){T.value.flatId="",T.value.selectedFlatIds=[],null===T.value.floorNumber||void 0===T.value.floorNumber?j():j(T.value.floorNumber)}function V(){T.value.floorNumber=null,M()}function B(){var e;if(!T.value.companyName||!T.value.businessType||!T.value.identityNumber)return;const a=(T.value.selectedFlatIds||[]).filter(Boolean);if(0===a.length&&(void 0===T.value.floorNumber||null===T.value.floorNumber))return void alert("LÃ¼tfen en az bir Ã¼nite seÃ§in veya kat filtresi belirleyin.");const t={companyName:T.value.companyName.trim(),businessType:T.value.businessType,identityNumber:T.value.identityNumber.trim(),contactPersonName:T.value.contactPersonName.trim(),contactPersonPhone:T.value.contactPersonPhone.trim(),contactPersonEmail:(null==(e=T.value.contactPersonEmail)?void 0:e.trim())||null,flatIds:a.length>1?a:void 0,flatId:1===a.length?a[0]:T.value.flatId||null,floorNumber:T.value.floorNumber??null,monthlyAidat:Number(T.value.monthlyAidat||0),isActive:!!T.value.isActive};k("save",t),T.value={companyName:"",businessType:"",identityNumber:"",contactPersonName:"",contactPersonPhone:"",contactPersonEmail:"",flatId:"",selectedFlatIds:[],floorNumber:void 0,monthlyAidat:0,isActive:!0}}return a(()=>x.visible,e=>{e&&(T.value={companyName:"",businessType:"",identityNumber:"",contactPersonName:"",contactPersonPhone:"",contactPersonEmail:"",flatId:"",selectedFlatIds:[],floorNumber:void 0,monthlyAidat:0,isActive:!0},j())}),g(()=>{x.visible&&j(),h("tenant:deleted",()=>j(T.value.floorNumber))}),(e,a)=>(l(),t("dialog",{id:"createTenantModal",class:"modal",open:r.visible},[o("div",ee,[o("div",ae,[a[13]||(a[13]=o("h3",{class:"text-xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2"},[o("span",{class:"text-2xl"},"ðŸ¢"),s(" Yeni Ä°ÅŸ Yeri KiracÄ±sÄ± Ekle ")],-1)),o("button",{onClick:a[0]||(a[0]=a=>e.$emit("close")),class:"btn btn-sm btn-ghost text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},a[12]||(a[12]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),o("div",te,[o("form",{onSubmit:n(B,["prevent"]),id:"tenantForm",class:"space-y-6"},[o("div",le,[a[18]||(a[18]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ¢ Ä°ÅŸ Yeri Bilgileri",-1)),o("div",re,[o("div",oe,[a[14]||(a[14]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Åžirket AdÄ± *")],-1)),i(o("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>T.value.companyName=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"ABC Ticaret Ltd. Åžti.",required:""},null,512),[[d,T.value.companyName]])]),o("div",se,[a[16]||(a[16]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Ä°ÅŸ TÃ¼rÃ¼ *")],-1)),i(o("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>T.value.businessType=e),class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",required:""},a[15]||(a[15]=[u('<option value="">Ä°ÅŸ tÃ¼rÃ¼ seÃ§in</option><option value="Ticaret">Ticaret</option><option value="Hizmet">Hizmet</option><option value="Ãœretim">Ãœretim</option><option value="Ofis">Ofis</option><option value="Depo">Depo</option><option value="DiÄŸer">DiÄŸer</option>',7)]),512),[[c,T.value.businessType]])]),o("div",ne,[a[17]||(a[17]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Kimlik/Vergi NumarasÄ± *")],-1)),i(o("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>T.value.identityNumber=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"TC veya Vergi No",required:"",type:"text",inputmode:"numeric"},null,512),[[d,T.value.identityNumber]])])])]),o("div",ie,[a[22]||(a[22]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ‘¤ Ä°letiÅŸim KiÅŸisi Bilgileri",-1)),o("div",de,[o("div",ce,[a[19]||(a[19]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Ä°letiÅŸim KiÅŸisi *")],-1)),i(o("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>T.value.contactPersonName=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"Ahmet YÄ±lmaz",required:""},null,512),[[d,T.value.contactPersonName]])]),o("div",ue,[a[20]||(a[20]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Telefon *")],-1)),i(o("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>T.value.contactPersonPhone=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"+90 (5XX) XXX XX XX",required:""},null,512),[[d,T.value.contactPersonPhone]])]),o("div",be,[a[21]||(a[21]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"E-posta")],-1)),i(o("input",{type:"email","onUpdate:modelValue":a[6]||(a[6]=e=>T.value.contactPersonEmail=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"ornek@email.com"},null,512),[[d,T.value.contactPersonEmail]])])])]),o("div",me,[a[27]||(a[27]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ“ Ãœnite SeÃ§imi",-1)),o("div",ge,[o("div",ve,[a[24]||(a[24]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Kat Filtresi")],-1)),o("div",ye,[i(o("select",{"onUpdate:modelValue":a[7]||(a[7]=e=>T.value.floorNumber=e),onChange:M,class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400"},[a[23]||(a[23]=o("option",{value:null},"TÃ¼m katlar",-1)),(l(!0),t(v,null,y(C.value,e=>(l(),t("option",{key:e,value:e},p(e)+". Kat ",9,pe))),128))],544),[[c,T.value.floorNumber]]),o("button",{type:"button",class:"btn btn-ghost btn-sm",onClick:V}," Temizle ")])]),o("div",fe,[a[25]||(a[25]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Ãœnite SeÃ§in (Ã§oklu)")],-1)),i(o("select",{multiple:"","onUpdate:modelValue":a[8]||(a[8]=e=>T.value.selectedFlatIds=e),size:I.value,class:"select select-bordered w-full h-56 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400"},[(l(!0),t(v,null,y(E.value,e=>(l(),t("option",{key:e.id,value:e.id},p(N(e)),9,ke))),128))],8,xe),[[c,T.value.selectedFlatIds]]),a[26]||(a[26]=o("label",{class:"label"},[o("span",{class:"label-text-alt text-blue-600"}," ðŸ’¡ Ãœnite seÃ§mezseniz yalnÄ±zca kat seÃ§imiyle o kattaki ilk uygun Ã¼nite atanÄ±r. ")],-1))])])]),o("div",he,[a[29]||(a[29]=o("h4",{class:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300"},"ðŸ’° Aidat Bilgisi",-1)),o("div",we,[o("div",Ne,[a[28]||(a[28]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"AylÄ±k Aidat (â‚º) *")],-1)),i(o("input",{type:"number","onUpdate:modelValue":a[9]||(a[9]=e=>T.value.monthlyAidat=e),class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"500",min:"0",step:"0.01",required:""},null,512),[[d,T.value.monthlyAidat,void 0,{number:!0}]])])])]),o("div",Ae,[o("label",Te,[a[30]||(a[30]=o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Aktif KiracÄ±",-1)),i(o("input",{type:"checkbox","onUpdate:modelValue":a[10]||(a[10]=e=>T.value.isActive=e),class:"toggle toggle-success"},null,512),[[b,T.value.isActive]])])])],32)]),o("div",Pe,[o("button",{type:"button",onClick:a[11]||(a[11]=a=>e.$emit("close")),class:"btn btn-outline border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"},a[31]||(a[31]=[o("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),s(" Ä°ptal ")])),a[32]||(a[32]=o("button",{form:"tenantForm",type:"submit",class:"btn btn-success bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 border-0 text-white shadow-lg"},[o("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),s(" Kaydet ")],-1))])])],8,Z))}},Ee={class:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 p-6"},Ie={class:"mb-8"},je={class:"flex items-center justify-between"},Me={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},Ve={class:"card bg-white dark:bg-gray-800 shadow-xl border-l-4 border-primary"},Be={class:"card-body p-6 flex-row items-center gap-4"},De={class:"text-2xl font-bold"},Se={class:"card bg-white dark:bg-gray-800 shadow-xl border-l-4 border-success"},ze={class:"card-body p-6 flex-row items-center gap-4"},Ke={class:"text-2xl font-bold"},Ue={class:"card bg-white dark:bg-gray-800 shadow-xl border-l-4 border-error"},Xe={class:"card-body p-6 flex-row items-center gap-4"},$e={class:"text-2xl font-bold"},Fe={class:"card bg-white dark:bg-gray-800 shadow-lg mb-6"},qe={class:"card-body"},He={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Le={class:"form-control"},Oe={class:"form-control"},Ge={class:"form-control"},Ye=["value"],_e={class:"form-control"},Re={class:"flex justify-between items-center mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"},We={class:"text-sm text-gray-500 dark:text-gray-400"},Je={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},Qe={key:0,class:"absolute top-4 right-4 z-10"},Ze={class:"dropdown dropdown-end"},ea={tabindex:"0",class:"dropdown-content menu p-2 shadow bg-base-200 rounded-box w-40 z-10"},aa=["onClick"],ta=["onClick"],la={key:0},ra=["onClick"],oa={class:"flex items-center gap-4 mb-4"},sa={class:"flex items-center gap-2 mb-1"},na={class:"text-lg font-bold text-gray-800 dark:text-gray-100"},ia={key:0,class:"badge badge-info text-xs"},da={class:"flex items-center gap-2"},ca={class:"mt-2 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl border border-gray-100 dark:border-gray-700"},ua={class:"flex justify-between items-center"},ba={class:"mt-auto pt-4 flex gap-2"},ma=["onClick"],ga=["href"],va=["onClick"],ya={class:"card-body border-t border-gray-200 dark:border-gray-700"},pa={class:"flex items-center justify-between"},fa={class:"text-sm text-gray-600 dark:text-gray-400"},xa={class:"join"},ka=["disabled"],ha={class:"join-item btn btn-sm"},wa=["disabled"],Na={__name:"Tenants",setup(n){const b=h(),P=N(),{emit:M}=Q(),V=C(),B=e(!1),D=e(!1),S=e(null),z=m(()=>S.value?`${S.value.companyName} silinsin mi?`:"Silinsin mi?"),K=m(()=>S.value?`${S.value.companyName} kiracÄ±sÄ±nÄ± silerseniz ilgili Ã¼nite boÅŸaltÄ±lacaktÄ±r.`:""),U=()=>{B.value=!1,S.value=null};m(()=>V.loading);const X=m(()=>V.tenants),$=e(!1),F=e(!1),q=e(null),H=e(1),L=e({searchTerm:"",isActive:"",floorNumber:"",businessType:""}),O=m(()=>V.stats),G=m(()=>{let e=X.value;if(L.value.searchTerm){const a=String(L.value.searchTerm).toLowerCase();e=e.filter(e=>String(e.companyName||"").toLowerCase().includes(a)||String(e.contactPersonName||"").toLowerCase().includes(a)||String(e.identityNumber||"").includes(a)||String(e.contactPersonEmail||"").toLowerCase().includes(a)||String(e.contactPersonPhone||"").includes(a))}if(""!==L.value.isActive){const a="true"===L.value.isActive;e=e.filter(e=>e.isActive===a)}if(""!==L.value.floorNumber){const a=parseInt(L.value.floorNumber,10);e=e.filter(e=>{var t;return null==(t=e.flats)?void 0:t.some(e=>e.floorNumber===a)})}return L.value.businessType&&(e=e.filter(e=>e.businessType===L.value.businessType)),e}),Y=m(()=>{const e=10*(H.value-1);return G.value.slice(e,e+10)}),_=m(()=>Math.ceil(G.value.length/10)),R=m(()=>{const e=new Set;return X.value.forEach(a=>{var t;return null==(t=a.flats)?void 0:t.forEach(a=>{null!==a.floorNumber&&void 0!==a.floorNumber&&e.add(a.floorNumber)})}),Array.from(e).sort((e,a)=>e-a)}),J=e=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(Number(e||0)),Z=()=>{H.value=1},ee=()=>{L.value={searchTerm:"",isActive:"",floorNumber:"",businessType:""},H.value=1},ae=async e=>{try{await V.createTenant(e),T.logSuccess("success","KiracÄ± baÅŸarÄ±yla eklendi",{component:"Tenants",action:"create"}),$.value=!1}catch(a){const l=(null==a?void 0:a.serverMessage)||(null==a?void 0:a.message)||"",r=/aktif.*kiracÄ±.*var/i.test(l),o=e.flatIds&&e.flatIds.length?e.flatIds:e.flatId?[e.flatId]:[];if(r&&o.length)try{const a=X.value.filter(a=>a.identityNumber===e.identityNumber&&a.isActive)[0];if(a){if(window.confirm(`Bu kimlik numarasÄ±yla zaten aktif bir kiracÄ± var: "${a.companyName}". SeÃ§ili ${o.length} Ã¼niteyi bu kiracÄ±ya baÄŸlayalÄ±m mÄ±?`))return await V.updateTenant(a.id,{...a,flatIds:[...a.flatIds||[],...o]}),T.logSuccess("success","Ãœniteler mevcut kiracÄ±ya atandÄ±.",{component:"Tenants",action:"assign-flats"}),void($.value=!1)}}catch(t){}T.logError(a,{component:"Tenants",action:"create"})}},te=async e=>{try{await V.updateTenant(q.value.id,e),T.logSuccess("success","KiracÄ± baÅŸarÄ±yla gÃ¼ncellendi",{component:"Tenants",action:"update"}),le()}catch(a){T.logError(a,{component:"Tenants",action:"update"})}},le=()=>{q.value=null,F.value=!1},re=e=>{b.push(`/tenants/${e.id}`)},oe=async()=>{if(S.value){D.value=!0;try{await V.deleteTenant(S.value.id),T.logSuccess("success","KiracÄ± silindi",{component:"Tenants",action:"delete"}),M("tenant:deleted")}catch(e){T.logError(e,{component:"Tenants",action:"delete"})}finally{D.value=!1,U()}}};return g(async()=>{try{await V.fetchTenants()}catch(e){}}),a(L,Z,{deep:!0}),(e,a)=>(l(),t("div",Ee,[o("div",Ie,[o("div",je,[a[9]||(a[9]=o("div",null,[o("h1",{class:"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-2 flex items-center gap-3"},[o("span",{class:"text-4xl"},"ðŸ¢"),s(" Ä°ÅŸ HanÄ± KiracÄ±larÄ± ")]),o("p",{class:"text-gray-600 dark:text-gray-400"},"Ä°ÅŸ hanÄ±ndaki tÃ¼m kiracÄ±larÄ± yÃ¶netin")],-1)),k(P).role===k(A).ADMIN||k(P).role===k(A).MANAGER?(l(),t("button",{key:0,onClick:a[0]||(a[0]=e=>$.value=!0),class:"btn btn-success bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 border-0 text-white shadow-lg"},a[8]||(a[8]=[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),s(" Yeni KiracÄ± Ekle ")]))):r("",!0)])]),o("div",Me,[o("div",Ve,[o("div",Be,[a[11]||(a[11]=o("div",{class:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center text-primary text-2xl"},"ðŸ‘¤",-1)),o("div",null,[a[10]||(a[10]=o("div",{class:"text-sm font-semibold text-gray-500"},"Aktif KiracÄ±lar",-1)),o("div",De,p(O.value.activeCount),1)])])]),o("div",Se,[o("div",ze,[a[13]||(a[13]=o("div",{class:"w-12 h-12 rounded-full bg-success/10 flex items-center justify-center text-success text-2xl"},"ðŸ“Š",-1)),o("div",null,[a[12]||(a[12]=o("div",{class:"text-sm font-semibold text-gray-500"},"Doluluk OranÄ±",-1)),o("div",Ke,"%"+p(O.value.occupancyRate),1)])])]),o("div",Ue,[o("div",Xe,[a[15]||(a[15]=o("div",{class:"w-12 h-12 rounded-full bg-error/10 flex items-center justify-center text-error text-2xl"},"ðŸ’°",-1)),o("div",null,[a[14]||(a[14]=o("div",{class:"text-sm font-semibold text-gray-500"},"Toplam Bakiye",-1)),o("div",$e,p(J(O.value.totalDebt)),1)])])])]),o("div",Fe,[o("div",qe,[o("div",He,[o("div",Le,[a[16]||(a[16]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Arama")],-1)),i(o("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>L.value.searchTerm=e),onInput:Z,class:"input input-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200 focus:border-blue-500 dark:focus:border-blue-400",placeholder:"Åžirket, kiÅŸi, kimlik no..."},null,544),[[d,L.value.searchTerm]])]),o("div",Oe,[a[18]||(a[18]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Durum")],-1)),i(o("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>L.value.isActive=e),onChange:Z,class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200"},a[17]||(a[17]=[o("option",{value:""},"TÃ¼mÃ¼",-1),o("option",{value:"true"},"Aktif",-1),o("option",{value:"false"},"Pasif",-1)]),544),[[c,L.value.isActive]])]),o("div",Ge,[a[20]||(a[20]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Kat")],-1)),i(o("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>L.value.floorNumber=e),onChange:Z,class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200"},[a[19]||(a[19]=o("option",{value:""},"TÃ¼m Katlar",-1)),(l(!0),t(v,null,y(R.value,e=>(l(),t("option",{key:e,value:e},p(e)+". Kat",9,Ye))),128))],544),[[c,L.value.floorNumber]])]),o("div",_e,[a[22]||(a[22]=o("label",{class:"label"},[o("span",{class:"label-text font-semibold text-gray-700 dark:text-gray-300"},"Ä°ÅŸ TÃ¼rÃ¼")],-1)),i(o("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>L.value.businessType=e),onChange:Z,class:"select select-bordered w-full bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200"},a[21]||(a[21]=[u('<option value="">TÃ¼mÃ¼</option><option value="Ticaret">Ticaret</option><option value="Hizmet">Hizmet</option><option value="Ãœretim">Ãœretim</option><option value="Ofis">Ofis</option><option value="Depo">Depo</option><option value="DiÄŸer">DiÄŸer</option>',7)]),544),[[c,L.value.businessType]])])]),o("div",Re,[o("div",{class:"flex gap-2"},[o("button",{onClick:ee,class:"btn btn-outline btn-sm border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300"},a[23]||(a[23]=[o("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),s(" Filtreleri Temizle ")]))]),o("div",We,p(G.value.length)+" kiracÄ± bulundu ",1)])])]),G.value.length>0?(l(),t("div",Je,[(l(!0),t(v,null,y(Y.value,e=>{var s,n;return l(),t("div",{key:e.id,class:"relative group bg-white dark:bg-gray-800 rounded-2xl shadow-lg transition-transform duration-200 hover:scale-105 hover:shadow-2xl p-6 flex flex-col"},[k(P).role===k(A).ADMIN||k(P).role===k(A).MANAGER?(l(),t("div",Qe,[o("div",Ze,[a[24]||(a[24]=u('<button tabindex="0" class="btn btn-ghost btn-circle btn-sm"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><circle cx="12" cy="12" r="1.5"></circle><circle cx="19" cy="12" r="1.5"></circle><circle cx="5" cy="12" r="1.5"></circle></svg></button>',1)),o("ul",ea,[o("li",null,[o("a",{onClick:a=>re(e)},"DetaylarÄ± GÃ¶r",8,aa)]),o("li",null,[o("a",{onClick:a=>{return t=e,q.value=t,void(F.value=!0);var t}},"DÃ¼zenle",8,ta)]),k(P).role===k(A).ADMIN?(l(),t("li",la,[o("a",{onClick:a=>(e=>{S.value=e,B.value=!0})(e),class:"text-error"},"Sil",8,ra)])):r("",!0)])])])):r("",!0),o("div",oa,[o("div",{class:w(k(E)(e.contactPersonName)+" flex items-center justify-center rounded-full w-16 h-16 text-2xl font-bold text-white shadow-lg")},p(k(I)(e.companyName)),3),o("div",null,[o("div",sa,[o("span",na,p(e.companyName),1),(null==(s=e.flats)?void 0:s.length)?(l(),t("span",ia," Ãœnite "+p(e.flats[0].code),1)):r("",!0)]),o("div",da,[o("span",{class:w(["badge font-semibold",e.isActive?"badge-success":"badge-ghost"])},p(e.isActive?"Aktif":"Pasif"),3)])])]),o("div",ca,[o("div",ua,[a[25]||(a[25]=o("span",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"GÃ¼ncel Bakiye",-1)),o("span",{class:w(["text-sm font-bold",e.totalBalance>0?"text-error":"text-success"])},p(J(e.totalBalance)),3)])]),o("div",ba,[o("button",{onClick:a=>re(e),class:"btn btn-sm btn-outline flex-1 normal-case"},"Detay",8,ma),o("a",{href:`https://wa.me/${null==(n=e.contactPersonPhone)?void 0:n.replace(/\D/g,"")}`,target:"_blank",class:"btn btn-sm btn-ghost btn-circle text-success",title:"WhatsApp"},a[26]||(a[26]=[o("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},[o("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L0 24l6.335-1.662c1.72.937 3.659 1.432 5.628 1.433h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})],-1)]),8,ga),k(P).role===k(A).ADMIN||k(P).role===k(A).MANAGER?(l(),t("button",{key:0,onClick:a=>k(b).push(`/payments?tenantId=${e.id}`),class:"btn btn-sm btn-ghost btn-circle text-primary",title:"Ã–deme Al"},a[27]||(a[27]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})],-1)]),8,va)):r("",!0)])])}),128))])):r("",!0),o("div",ya,[o("div",pa,[o("div",fa,p(10*(H.value-1)+1)+"-"+p(Math.min(10*H.value,G.value.length))+" / "+p(G.value.length)+" kiracÄ± ",1),o("div",xa,[o("button",{onClick:a[5]||(a[5]=e=>H.value--),disabled:1===H.value,class:"join-item btn btn-sm"},"Â«",8,ka),o("button",ha,p(H.value),1),o("button",{onClick:a[6]||(a[6]=e=>H.value++),disabled:H.value>=_.value,class:"join-item btn btn-sm"},"Â»",8,wa)])])]),f(Ce,{visible:$.value,onSave:ae,onClose:a[7]||(a[7]=e=>$.value=!1)},null,8,["visible"]),f(j,{visible:B.value,tenant:S.value,title:z.value,message:K.value,"confirm-label":"Evet, Sil","cancel-label":"Ä°ptal",loading:D.value,onConfirm:oe,onCancel:U},null,8,["visible","tenant","title","message","loading"]),q.value?(l(),x(W,{key:1,visible:F.value,tenant:q.value,onSave:te,onClose:le},null,8,["visible","tenant"])):r("",!0)]))}};export{Na as default};
